<?xml version="1.0"?>
<!-- CPSA 4.4.2 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>Basic password-based authentication over TLS 1.2</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;Basic password-based authentication over TLS 1.2&quot;)
(comment &quot;CPSA 4.4.2&quot;)
(comment &quot;All input read from baseline-nouaf-tls12.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t23">23</a>.</p>

<p id="t0">Tree <a href="#top">0</a>, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 529.920' font-size='12.000'>
  <text
   x='239.640' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='139.800' y1='489.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='89.880' y1='264.960' x2='139.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='239.640' y1='414.960' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  <line
   x1='189.720' y1='414.960' x2='239.640' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='139.800' y1='339.960' x2='189.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='289.560' y1='339.960' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='239.640' y1='339.960' x2='289.560' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='189.720' y1='302.460' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='239.640' y1='264.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='189.720' y1='302.460' x2='239.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='288.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='139.800' y1='339.960' x2='189.720' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='326.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='89.880' y1='264.960' x2='139.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='239.640' y1='189.960' x2='289.560' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='289.560' y1='114.960' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='189.720' y1='77.460' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='189.720' y1='77.460' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='264.960' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='264.960' x2='89.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='251.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol baseline-nouaf-tls12 basic
  (defrole client
    (vars (username server ca name) (cr sr random32) (pms random48)
      (pw password))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole server
    (vars (username server ca name) (cr sr random32) (pms random48)
      (pw password))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom) (password atom)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 0</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 0)
  (unrealized (0 1) (0 3) (0 5))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Children: <a href="#k2">2</a> <a href="#k3">3</a> <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 1</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server 2)
    (enc (hash server (pubk server)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 1)
  (parent 0)
  (unrealized (0 3) (0 5))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k5">5</a> <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 2</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 4 (cr cr) (sr sr) (pms pms) (server server) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 2)
  (parent 1)
  (unrealized (0 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k7">7</a> <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 3</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 4 (cr cr) (sr sr) (pms pms) (server server) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 3)
  (parent 1)
  (unrealized (0 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k1">1</a>, Child: <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 4</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 4)
  (parent 1)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k10">10</a> <a href="#k11">11</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw-0) (cr cr) (sr sr) (pms pms) (username username-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 5</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw pw-0 password) (cr sr random32) (pms random48)
    (username username-0 server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 6 (pw pw-0) (cr cr) (sr sr) (pms pms)
    (username username-0) (server server) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server 6)
    (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 5)
  (parent 2)
  (unrealized (1 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k2">2</a>, Child: <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 141.584 299.964 43.287 484.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 6</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 4 (cr cr) (sr sr) (pms pms) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 6)
  (parent 2)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k3">3</a>, Children: <a href="#k13">13</a> <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw-0) (cr cr) (sr sr) (pms pms) (username username-0) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 7</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw pw-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (username username-0 server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 6 (pw pw-0) (cr cr) (sr sr) (pms pms)
    (username username-0) (server server) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 2 3 server 6)
    (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 7)
  (parent 3)
  (unrealized (2 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k3">3</a>, Child: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.021 300.338 44.202 485.716'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 8</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 4 (cr cr) (sr sr) (pms pms) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)) (0 5))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 8)
  (parent 3)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k4">4</a>, Child: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 9</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 9)
  (parent 4)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 10</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr random32) (pms random48)
    (username server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 4) (1 4)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 2 0 client 5)
    (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 10)
  (parent 5)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (cr cr) (sr sr) (pms pms) (pw pw)
        (username username))))
  (origs (cr (0 0)) (pms (0 2)) (sr (1 1))))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k5">5</a>, Child: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 191.118 299.718 142.356 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw-0) (cr cr) (sr sr) (pms pms) (username username-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 11</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw pw-0 password) (cr sr random32) (pms random48)
    (username username-0 server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 6 (pw pw-0) (cr cr) (sr sr) (pms pms)
    (username username-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (1 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 11)
  (parent 5)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k6">6</a>, Child: <a href="#k18">18</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 141.913 337.717 43.945 485.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 12</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 4 (cr cr) (sr sr) (pms pms) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 5)) ((3 1) (2 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 12)
  (parent 6)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k7">7</a>, Seen Child: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 13</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (username server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 4) (2 4)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 3 0 client 5)
    (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 13)
  (parent 7)
  (seen 10)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k7">7</a>, Child: <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 291.078 299.718 242.316 409.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw-0) (cr cr) (sr sr) (pms pms) (username username-0) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 14</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw pw-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (username username-0 server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 6 (pw pw-0) (cr cr) (sr sr) (pms pms)
    (username username-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;client_write&quot;))
    (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)) (2 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;))))
  (label 14)
  (parent 7)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k15">Item <a href="#t0">15</a>, Parent: <a href="#k8">8</a>, Child: <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.300 338.160 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 15</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 4 (cr cr) (sr sr) (pms pms) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 15)
  (parent 8)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k16">Item <a href="#t0">16</a>, Parent: <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 16</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 16)
  (parent 9)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k17">Item <a href="#t0">17</a>, Parent: <a href="#k11">11</a>, Child: <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 191.564 337.464 143.247 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw-0) (cr cr) (sr sr) (pms pms) (username username-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 17</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw pw-0 password) (cr sr random32) (pms random48)
    (username username-0 server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 6 (pw pw-0) (cr cr) (sr sr) (pms pms)
    (username username-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 17)
  (parent 11)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k18">Item <a href="#t0">18</a>, Parent: <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 18</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 4 (cr cr) (sr sr) (pms pms) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 5)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 18)
  (parent 12)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k19">Item <a href="#t0">19</a>, Parent: <a href="#k14">14</a>, Child: <a href="#k22">22</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 291.524 337.464 243.207 409.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw-0) (cr cr) (sr sr) (pms pms) (username username-0) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 19</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw pw-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (username username-0 server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 6 (pw pw-0) (cr cr) (sr sr) (pms pms)
    (username username-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4)) ((4 1) (3 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;client_write&quot;))
    (hash (hash pms cr sr) &quot;client_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;))))
  (label 19)
  (parent 14)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t0">20</a>, Parent: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 20</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (cr sr cr-0 sr-0 random32) (pms random48)
    (server ca username name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 4 (cr cr) (sr sr) (pms pms) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 5)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 20)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k21">Item <a href="#t0">21</a>, Parent: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 87.540 300.660 135.121 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw-0) (cr cr) (sr sr) (pms pms) (username username-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 21</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw pw-0 password) (cr sr random32) (pms random48)
    (username username-0 server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 6 (pw pw-0) (cr cr) (sr sr) (pms pms)
    (username username-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((1 5) (0 5)) ((2 1) (1 4)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 21)
  (parent 17)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k22">Item <a href="#t0">22</a>, Parent: <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;client_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 137.111 263.906 234.262 337.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw-0) (cr cr) (sr sr) (pms pms) (username username-0) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>server</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 22</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw pw-0 password) (cr sr cr-0 sr-0 random32) (pms random48)
    (username username-0 server ca name))
  (defstrand client 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand server 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server 6 (pw pw-0) (cr cr) (sr sr) (pms pms)
    (username username-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;client_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((2 5) (0 5)) ((3 1) (2 4))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username-0 pw-0 (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;client_write&quot;))
      (send (hash (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;client_write&quot;))
      (send (cat (hash pms cr sr) &quot;client_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 22)
  (parent 19)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t23">Tree <a href="#top">23</a>, POV <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  </svg></div>

<pre>(defprotocol baseline-nouaf-tls12 basic
  (defrole client
    (vars (username server ca name) (cr sr random32) (pms random48)
      (pw password))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (recv
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defrole server
    (vars (username server ca name) (cr sr random32) (pms random48)
      (pw password))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom) (password atom)))</pre>

<p id="k23">Item <a href="#t23">23</a>, Child: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 23</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (sr cr random32) (pms random48)
    (server ca username name))
  (defstrand server 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig sr)
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 23)
  (unrealized (0 4))
  (origs (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k24">Item <a href="#t23">24</a>, Parent: <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username-0 pw (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username pw (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((pw pw) (cr cr-0) (sr sr-0) (pms pms-0) (username username-0) (server server-0) (ca ca-0))</title>
   <text
    x='139.920' y='77.460' style='text-anchor: middle;'>client</text>
   </g>
  <g>
   <title>((pw pw) (cr cr) (sr sr) (pms pms) (username username) (server server) (ca ca))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>baseline-nouaf-tls12 24</text></svg>
 </div>

<pre>(defskeleton baseline-nouaf-tls12
  (vars (pw password) (sr cr cr-0 sr-0 random32) (pms pms-0 random48)
    (server ca username username-0 server-0 ca-0 name))
  (defstrand server 6 (pw pw) (cr cr) (sr sr) (pms pms)
    (username username) (server server) (ca ca))
  (defstrand client 5 (pw pw) (cr cr-0) (sr sr-0) (pms pms-0)
    (username username-0) (server server-0) (ca ca-0))
  (precedes ((1 4) (0 4)))
  (non-orig (privk server) (privk ca))
  (pen-non-orig pw)
  (uniq-orig sr)
  (operation nonce-test (added-strand client 5) pw (0 4))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv (enc username pw (hash (hash pms cr sr) &quot;client_write&quot;)))
      (send
        (enc &quot;auth success&quot; (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc username-0 pw
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 24)
  (parent 23)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (pw pw) (username username)
        (cr cr) (pms pms))))
  (origs (sr (0 1))))</pre>

</body>
</html>
