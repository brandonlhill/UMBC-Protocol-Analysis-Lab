<?xml version="1.0"?>
<!-- CPSA 4.4.2 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>UAF using TLS1.2 without channel binding.</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;UAF using TLS1.2 without channel binding.&quot;)
(comment &quot;CPSA 4.4.2&quot;)
(comment &quot;All input read from uaf-endpoint-tls12.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t15">15</a> <a href="#t30">30</a> <a href="#t38">38</a> <a href="#t42">42</a> <a href="#t57">57</a> <a href="#t72">72</a> <a href="#t80">80</a>.</p>

<p id="t0">Tree <a href="#top">0</a>, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='329.520pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 329.520 379.920' font-size='12.000'>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='189.720' y1='339.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='139.800' y1='339.960' x2='189.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='239.640' y1='264.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='189.720' y1='264.960' x2='239.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='213.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='189.960' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls12 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 0</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 0)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Children: <a href="#k2">2</a> <a href="#k3">3</a> <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 1</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 1)
  (parent 0)
  (unrealized (0 3) (0 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k5">5</a> <a href="#k6">6</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 2</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 2)
  (parent 1)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k7">7</a> <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 3</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server-auth 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 3)
  (parent 1)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k1">1</a>, Child: <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 4</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 4)
  (parent 1)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k2">2</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (username username) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 5</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (username auth appid server ca name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-reg 5 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (username username) (server server) (ca ca)
    (appid appid))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 4) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server-reg 5)
    (enc username appid challenge
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 5)
  (parent 2)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (cr cr) (sr sr) (pms pms) (authk authk)
        (username username) (auth auth) (appid appid)
        (challenge challenge))))
  (origs (cr (0 0)) (pms (0 2)) (sr (1 1))))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k2">2</a>, Child: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 141.913 262.717 43.945 410.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 6</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc username appid challenge
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 6)
  (parent 2)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k3">3</a>, Seen Child: <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (username username) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 7</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (username auth appid server ca name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-reg 5 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (username username) (server server) (ca ca)
    (appid appid))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 4) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 2 3 server-reg 5)
    (enc username appid challenge
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 7)
  (parent 3)
  (seen 5)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k3">3</a>, Child: <a href="#k11">11</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 8</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc username appid challenge
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 8)
  (parent 3)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k4">4</a>, Child: <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 9</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 9)
  (parent 4)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k6">6</a>, Child: <a href="#k13">13</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 10</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 4)) ((3 1) (2 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 10)
  (parent 6)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k8">8</a>, Child: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.583 301.118 45.326 412.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 11</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 4)) ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 11)
  (parent 8)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 12</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 12)
  (parent 9)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 13</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 13)
  (parent 10)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k11">11</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 14</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca username auth appid name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 4)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 14)
  (parent 11)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t15">Tree <a href="#top">15</a>, POV <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='329.520pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 329.520 379.920' font-size='12.000'>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='189.720' y1='339.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='139.800' y1='339.960' x2='189.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='239.640' y1='264.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  <line
   x1='189.720' y1='264.960' x2='239.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='213.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='39.960' y1='189.960' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls12 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k15">Item <a href="#t15">15</a>, Child: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 15</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 15)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k16">Item <a href="#t15">16</a>, Parent: <a href="#k15">15</a>, Children: <a href="#k17">17</a> <a href="#k18">18</a> <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 16</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 16)
  (parent 15)
  (unrealized (0 3) (0 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k17">Item <a href="#t15">17</a>, Parent: <a href="#k16">16</a>, Children: <a href="#k20">20</a> <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 17</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 17)
  (parent 16)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k18">Item <a href="#t15">18</a>, Parent: <a href="#k16">16</a>, Children: <a href="#k22">22</a> <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 18</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server-auth 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 18)
  (parent 16)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k19">Item <a href="#t15">19</a>, Parent: <a href="#k16">16</a>, Child: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 19</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 19)
  (parent 16)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k20">Item <a href="#t15">20</a>, Parent: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 20</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (appid server ca name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 5 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (server server) (ca ca) (appid appid))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 4) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server-auth 5)
    (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 20)
  (parent 17)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (cr cr) (sr sr) (pms pms) (authk authk)
        (appid appid) (challenge challenge))))
  (origs (cr (0 0)) (pms (0 2)) (sr (1 1))))</pre>

<p id="k21">Item <a href="#t15">21</a>, Parent: <a href="#k17">17</a>, Child: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 141.913 262.717 43.945 410.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 21</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 21)
  (parent 17)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k22">Item <a href="#t15">22</a>, Parent: <a href="#k18">18</a>, Seen Child: <a href="#k20">20</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 22</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (appid server ca name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 5 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (server server) (ca ca) (appid appid))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 4) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 2 3 server-auth 5)
    (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 22)
  (parent 18)
  (seen 20)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k23">Item <a href="#t15">23</a>, Parent: <a href="#k18">18</a>, Child: <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 23</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 23)
  (parent 18)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k24">Item <a href="#t15">24</a>, Parent: <a href="#k19">19</a>, Child: <a href="#k27">27</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 24</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 24)
  (parent 19)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k25">Item <a href="#t15">25</a>, Parent: <a href="#k21">21</a>, Child: <a href="#k28">28</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 25</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 4)) ((3 1) (2 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 25)
  (parent 21)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k26">Item <a href="#t15">26</a>, Parent: <a href="#k23">23</a>, Child: <a href="#k29">29</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.583 301.118 45.326 412.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 26</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 4)) ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 26)
  (parent 23)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k27">Item <a href="#t15">27</a>, Parent: <a href="#k24">24</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 27</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 27)
  (parent 24)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k28">Item <a href="#t15">28</a>, Parent: <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 28</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 28)
  (parent 25)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k29">Item <a href="#t15">29</a>, Parent: <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 29</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 4)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 29)
  (parent 26)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t30">Tree <a href="#top">30</a>, POV <a href="#k30">30</a>.</p>

<div>
 <svg
  class='diagram' width='229.680pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 229.680 304.920' font-size='12.000'>
  <text
   x='189.720' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='213.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='89.880' y1='152.460' x2='139.800' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='89.880' y1='152.460' x2='139.800' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='138.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='39.960' y1='152.460' x2='89.880' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='138.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls12 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k30">Item <a href="#t30">30</a>, Child: <a href="#k31">31</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 30</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr random32) (pms random48) (challenge text) (authk akey)
    (server ca username auth appid name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 30)
  (unrealized (0 5))
  (origs (challenge (0 4)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k31">Item <a href="#t30">31</a>, Parent: <a href="#k30">30</a>, Children: <a href="#k32">32</a> <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))))) (enc auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge-0) (authk authk) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 31</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48)
    (challenge challenge-0 text) (authk akey)
    (server ca username auth appid auth-0 server-0 ca-0 appid-0 name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge-0) (authk authk) (username username)
    (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))
  (precedes ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand client-reg 6)
    (hash &quot;key handle&quot; (invk authk) username) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0))))))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 31)
  (parent 30)
  (unrealized (0 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k32">Item <a href="#t30">32</a>, Parent: <a href="#k31">31</a>, Children: <a href="#k34">34</a> <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 32</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48) (challenge text)
    (authk akey) (username auth server ca appid name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (precedes ((0 4) (1 4)) ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (displaced 2 1 client-reg 6)
    (enc auth-0 authk
      (hash appid-0 challenge-0
        (hash &quot;uaf_server_endpoint&quot; challenge-0
          (hash server-0 (pubk server-0)
            (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
      (invk authk)) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 32)
  (parent 31)
  (unrealized (1 1) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k33">Item <a href="#t30">33</a>, Parent: <a href="#k31">31</a>, Children: <a href="#k36">36</a> <a href="#k37">37</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username-0) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 appid challenge (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))))) (enc auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (pms pms-1) (challenge challenge) (authk authk) (username username-0) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge-0) (authk authk) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 33</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (challenge challenge-0 text) (authk akey)
    (server ca username auth appid auth-0 server-0 ca-0 appid-0
      username-0 name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge-0) (authk authk) (username username)
    (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))
  (defstrand client-reg 6 (cr cr-1) (sr sr-1) (pms pms-1)
    (challenge challenge) (authk authk) (username username-0)
    (auth auth) (server server) (ca ca) (appid appid))
  (precedes ((0 4) (2 4)) ((1 5) (0 5)) ((2 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand client-reg 6)
    (enc auth authk
      (hash appid challenge
        (hash &quot;uaf_server_endpoint&quot; challenge
          (hash server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))))
      (invk authk)) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0))))))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-1 (pubk server))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-1 (pubk server))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-1 (pubk server))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-1 (pubk server))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc username-0 appid challenge
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))))
  (label 33)
  (parent 31)
  (unrealized (2 1) (2 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k34">Item <a href="#t30">34</a>, Parent: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 34</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48) (challenge text)
    (authk akey) (username auth server ca appid name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (precedes ((0 1) (1 1)) ((0 4) (1 4)) ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (1 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 34)
  (parent 32)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (username username) (auth auth) (appid appid)
        (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="k35">Item <a href="#t30">35</a>, Parent: <a href="#k32">32</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-1) (sr sr-1) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 35</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (challenge text) (authk akey) (username auth server ca appid name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server) (ca ca))
  (precedes ((0 4) (1 4)) ((1 5) (0 5)) ((2 1) (1 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (1 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((recv cr-1)
      (send
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 35)
  (parent 32)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (username username) (auth auth) (appid appid)
        (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="k36">Item <a href="#t30">36</a>, Parent: <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username-0) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 appid challenge (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))))) (enc auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (pms pms-1) (challenge challenge) (authk authk) (username username-0) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge-0) (authk authk) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 36</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (challenge challenge-0 text) (authk akey)
    (server ca username auth appid auth-0 server-0 ca-0 appid-0
      username-0 name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge-0) (authk authk) (username username)
    (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))
  (defstrand client-reg 6 (cr cr-1) (sr sr-1) (pms pms-1)
    (challenge challenge) (authk authk) (username username-0)
    (auth auth) (server server) (ca ca) (appid appid))
  (precedes ((0 1) (2 1)) ((0 4) (2 4)) ((1 5) (0 5)) ((2 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (displaced 3 0 server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (2 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0))))))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-1 (pubk server))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-1 (pubk server))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-1 (pubk server))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-1 (pubk server))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc username-0 appid challenge
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))))
  (label 36)
  (parent 33)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (username username) (auth auth) (appid appid)
        (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="k37">Item <a href="#t30">37</a>, Parent: <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-2 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-2</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username-0) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 appid challenge (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))))) (enc auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-2) (sr sr-2) (server server) (ca ca))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (pms pms-1) (challenge challenge) (authk authk) (username username-0) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge-0) (authk authk) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 37</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32)
    (pms pms-0 pms-1 random48) (challenge challenge-0 text) (authk akey)
    (server ca username auth appid auth-0 server-0 ca-0 appid-0
      username-0 name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge-0) (authk authk) (username username)
    (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))
  (defstrand client-reg 6 (cr cr-1) (sr sr-1) (pms pms-1)
    (challenge challenge) (authk authk) (username username-0)
    (auth auth) (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-2) (sr sr-2) (server server) (ca ca))
  (precedes ((0 4) (2 4)) ((1 5) (0 5)) ((2 5) (0 5)) ((3 1) (2 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (2 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0))))))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-1 (pubk server))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-1 (pubk server))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-1 (pubk server))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-1 (pubk server))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc username-0 appid challenge
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
    ((recv cr-2)
      (send
        (cat sr-2 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 37)
  (parent 33)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (username username) (auth auth) (appid appid)
        (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="t38">Tree <a href="#top">38</a>, POV <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='179.760pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.760 154.920' font-size='12.000'>
  <text
   x='139.800' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls12 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k38">Item <a href="#t38">38</a>, Child: <a href="#k39">39</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 38</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand server-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 38)
  (unrealized (0 5))
  (origs (challenge (0 4)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k39">Item <a href="#t38">39</a>, Parent: <a href="#k38">38</a>, Children: <a href="#k40">40</a> <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 39</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand server-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand client-auth 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (precedes ((0 4) (1 4)) ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand client-auth 6)
    (enc
      (hash appid
        (hash &quot;uaf_server_endpoint&quot; challenge
          (hash server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))) challenge)
      (invk authk)) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 39)
  (parent 38)
  (unrealized (1 1) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k40">Item <a href="#t38">40</a>, Parent: <a href="#k39">39</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 40</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand server-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand client-auth 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (precedes ((0 1) (1 1)) ((0 4) (1 4)) ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (1 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 40)
  (parent 39)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (appid appid) (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="k41">Item <a href="#t38">41</a>, Parent: <a href="#k39">39</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-1) (sr sr-1) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 41</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (challenge text) (authk akey) (server ca appid name))
  (defstrand server-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand client-auth 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server) (ca ca))
  (precedes ((0 4) (1 4)) ((1 5) (0 5)) ((2 1) (1 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (1 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((recv cr-1)
      (send
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 41)
  (parent 39)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (appid appid) (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="t42">Tree <a href="#top">42</a>, POV <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='329.520pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 329.520 379.920' font-size='12.000'>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  <line
   x1='189.720' y1='339.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k51&quot;, &quot;_self&quot;)'>51</text>
  <line
   x1='139.800' y1='339.960' x2='189.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k56&quot;, &quot;_self&quot;)'>56</text>
  <line
   x1='239.640' y1='264.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k53&quot;, &quot;_self&quot;)'>53</text>
  <line
   x1='189.720' y1='264.960' x2='239.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k50&quot;, &quot;_self&quot;)'>50</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k49&quot;, &quot;_self&quot;)'>49</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='213.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k55&quot;, &quot;_self&quot;)'>55</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k48&quot;, &quot;_self&quot;)'>48</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='39.960' y1='189.960' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls12 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k42">Item <a href="#t42">42</a>, Child: <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 42</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (goals
    (forall
      ((cr sr random32) (pms random48) (challenge text)
        (server ca appid name) (authk akey) (z strd))
      (implies
        (and (p &quot;client-reg&quot; z 6) (p &quot;client-reg&quot; &quot;cr&quot; z cr)
          (p &quot;client-reg&quot; &quot;sr&quot; z sr) (p &quot;client-reg&quot; &quot;pms&quot; z pms)
          (p &quot;client-reg&quot; &quot;challenge&quot; z challenge)
          (p &quot;client-reg&quot; &quot;authk&quot; z authk)
          (p &quot;client-reg&quot; &quot;server&quot; z server) (p &quot;client-reg&quot; &quot;ca&quot; z ca)
          (p &quot;client-reg&quot; &quot;appid&quot; z appid) (non (invk authk))
          (non (privk server)) (non (privk ca)) (uniq-at cr z 0)
          (uniq-at pms z 2) (uniq sr))
        (exists ((z-0 strd))
          (and (p &quot;server-reg&quot; z-0 5)
            (p &quot;server-reg&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;server-reg&quot; &quot;server&quot; z-0 server)
            (p &quot;server-reg&quot; &quot;appid&quot; z-0 appid))))))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 42)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k43">Item <a href="#t42">43</a>, Parent: <a href="#k42">42</a>, Children: <a href="#k44">44</a> <a href="#k45">45</a> <a href="#k46">46</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 43</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 43)
  (parent 42)
  (unrealized (0 3) (0 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k44">Item <a href="#t42">44</a>, Parent: <a href="#k43">43</a>, Children: <a href="#k47">47</a> <a href="#k48">48</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 44</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 44)
  (parent 43)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k45">Item <a href="#t42">45</a>, Parent: <a href="#k43">43</a>, Children: <a href="#k49">49</a> <a href="#k50">50</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 45</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server-auth 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 45)
  (parent 43)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k46">Item <a href="#t42">46</a>, Parent: <a href="#k43">43</a>, Child: <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 46</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 46)
  (parent 43)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k47">Item <a href="#t42">47</a>, Parent: <a href="#k44">44</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (username username) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 47</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (appid username auth server ca name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-reg 5 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (username username) (server server) (ca ca)
    (appid appid))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 4) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server-reg 5)
    (enc username appid challenge
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 47)
  (parent 44)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (pms pms) (challenge challenge) (server server)
        (ca ca) (appid appid) (authk authk) (username username)
        (auth auth))))
  (origs (sr (1 1)) (cr (0 0)) (pms (0 2))))</pre>

<p id="k48">Item <a href="#t42">48</a>, Parent: <a href="#k44">44</a>, Child: <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 141.913 262.717 43.945 410.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 48</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc username appid challenge
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 48)
  (parent 44)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k49">Item <a href="#t42">49</a>, Parent: <a href="#k45">45</a>, Seen Child: <a href="#k47">47</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (username username) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 49</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (appid username auth server ca name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-reg 5 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (username username) (server server) (ca ca)
    (appid appid))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 4) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 2 3 server-reg 5)
    (enc username appid challenge
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 49)
  (parent 45)
  (seen 47)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k50">Item <a href="#t42">50</a>, Parent: <a href="#k45">45</a>, Child: <a href="#k53">53</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 50</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc username appid challenge
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 50)
  (parent 45)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k51">Item <a href="#t42">51</a>, Parent: <a href="#k46">46</a>, Child: <a href="#k54">54</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 51</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 51)
  (parent 46)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k52">Item <a href="#t42">52</a>, Parent: <a href="#k48">48</a>, Child: <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 52</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 4)) ((3 1) (2 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 52)
  (parent 48)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k53">Item <a href="#t42">53</a>, Parent: <a href="#k50">50</a>, Child: <a href="#k56">56</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.583 301.118 45.326 412.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 53</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 4)) ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 53)
  (parent 50)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k54">Item <a href="#t42">54</a>, Parent: <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 54</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 54)
  (parent 51)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k55">Item <a href="#t42">55</a>, Parent: <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 55</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 55)
  (parent 52)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k56">Item <a href="#t42">56</a>, Parent: <a href="#k53">53</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 56</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid username auth name))
  (defstrand client-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 4)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 56)
  (parent 53)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t57">Tree <a href="#top">57</a>, POV <a href="#k57">57</a>.</p>

<div>
 <svg
  class='diagram' width='329.520pt' height='379.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 329.520 379.920' font-size='12.000'>
  <text
   x='239.640' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k69&quot;, &quot;_self&quot;)'>69</text>
  <line
   x1='189.720' y1='339.960' x2='239.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='139.800' y1='339.960' x2='189.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k61&quot;, &quot;_self&quot;)'>61</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k71&quot;, &quot;_self&quot;)'>71</text>
  <line
   x1='239.640' y1='264.960' x2='289.560' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k68&quot;, &quot;_self&quot;)'>68</text>
  <line
   x1='189.720' y1='264.960' x2='239.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k65&quot;, &quot;_self&quot;)'>65</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='176.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k62&quot;, &quot;_self&quot;)'>62</text>
  <line
   x1='189.720' y1='189.960' x2='239.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k64&quot;, &quot;_self&quot;)'>64</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='213.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k60&quot;, &quot;_self&quot;)'>60</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k70&quot;, &quot;_self&quot;)'>70</text>
  <line
   x1='239.640' y1='114.960' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k67&quot;, &quot;_self&quot;)'>67</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k63&quot;, &quot;_self&quot;)'>63</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k62&quot;, &quot;_self&quot;)'>62</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k59&quot;, &quot;_self&quot;)'>59</text>
  <line
   x1='89.880' y1='189.960' x2='139.800' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k58&quot;, &quot;_self&quot;)'>58</text>
  <line
   x1='39.960' y1='189.960' x2='89.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls12 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k57">Item <a href="#t57">57</a>, Child: <a href="#k58">58</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 57</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (goals
    (forall
      ((cr sr random32) (pms random48) (challenge text)
        (server ca appid name) (authk akey) (z strd))
      (implies
        (and (p &quot;client-auth&quot; z 6) (p &quot;client-auth&quot; &quot;cr&quot; z cr)
          (p &quot;client-auth&quot; &quot;sr&quot; z sr) (p &quot;client-auth&quot; &quot;pms&quot; z pms)
          (p &quot;client-auth&quot; &quot;challenge&quot; z challenge)
          (p &quot;client-auth&quot; &quot;authk&quot; z authk)
          (p &quot;client-auth&quot; &quot;server&quot; z server)
          (p &quot;client-auth&quot; &quot;ca&quot; z ca) (p &quot;client-auth&quot; &quot;appid&quot; z appid)
          (non (invk authk)) (non (privk server)) (non (privk ca))
          (uniq-at cr z 0) (uniq-at pms z 2) (uniq sr))
        (exists ((z-0 strd))
          (and (p &quot;client-auth&quot; z-0 5)
            (p &quot;client-auth&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;client-auth&quot; &quot;server&quot; z-0 server)
            (p &quot;client-auth&quot; &quot;appid&quot; z-0 appid))))))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 57)
  (unrealized (0 1) (0 3) (0 4))
  (origs (cr (0 0)) (pms (0 2)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k58">Item <a href="#t57">58</a>, Parent: <a href="#k57">57</a>, Children: <a href="#k59">59</a> <a href="#k60">60</a> <a href="#k61">61</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 58</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (precedes ((1 1) (0 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (0 1))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 58)
  (parent 57)
  (unrealized (0 3) (0 4))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k59">Item <a href="#t57">59</a>, Parent: <a href="#k58">58</a>, Children: <a href="#k62">62</a> <a href="#k63">63</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 59</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 59)
  (parent 58)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k60">Item <a href="#t57">60</a>, Parent: <a href="#k58">58</a>, Children: <a href="#k64">64</a> <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 60</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-strand server-auth 4)
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 60)
  (parent 58)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k61">Item <a href="#t57">61</a>, Parent: <a href="#k58">58</a>, Child: <a href="#k66">66</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 61</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc
      (hash pms &quot;server finished&quot;
        (hash cr sr
          (cat server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))
          (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (hash (hash pms cr sr) &quot;server_write&quot;)) (0 3))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 61)
  (parent 58)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k62">Item <a href="#t57">62</a>, Parent: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 62</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (appid server ca name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 5 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (server server) (ca ca) (appid appid))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((1 4) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 1 2 server-auth 5)
    (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 62)
  (parent 59)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (pms pms) (challenge challenge) (server server)
        (ca ca) (appid appid) (authk authk))))
  (origs (sr (1 1)) (cr (0 0)) (pms (0 2))))</pre>

<p id="k63">Item <a href="#t57">63</a>, Parent: <a href="#k59">59</a>, Child: <a href="#k67">67</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 141.913 262.717 43.945 410.475'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 63</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 63)
  (parent 59)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k64">Item <a href="#t57">64</a>, Parent: <a href="#k60">60</a>, Seen Child: <a href="#k62">62</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 64</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (appid server ca name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 5 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (server server) (ca ca) (appid appid))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((2 4) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (displaced 2 3 server-auth 5)
    (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))))
  (label 64)
  (parent 60)
  (seen 62)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k65">Item <a href="#t57">65</a>, Parent: <a href="#k60">60</a>, Child: <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 192.300 263.160 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 65</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 4)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (hash (hash pms cr sr) &quot;server_write&quot;))
    (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)) (0 4))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;))))
  (label 65)
  (parent 60)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k66">Item <a href="#t57">66</a>, Parent: <a href="#k61">61</a>, Child: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 66</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 66)
  (parent 61)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k67">Item <a href="#t57">67</a>, Parent: <a href="#k63">63</a>, Child: <a href="#k70">70</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.320 300.660 44.759 411.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 67</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3))
    ((2 1) (0 4)) ((3 1) (2 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (2 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 67)
  (parent 63)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k68">Item <a href="#t57">68</a>, Parent: <a href="#k65">65</a>, Child: <a href="#k71">71</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='114.960' x2='439.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 189.960 Q 392.820 189.960 345.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='189.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='114.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 192.583 301.118 45.326 412.276'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 68</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)) ((3 1) (0 4)) ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test
    (added-listener (cat (hash pms cr sr) &quot;server_write&quot;))
    (hash (hash pms cr sr) &quot;server_write&quot;) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;))))
  (label 68)
  (parent 65)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k69">Item <a href="#t57">69</a>, Parent: <a href="#k66">66</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 69</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 2) (4 0)) ((1 1) (0 1)) ((2 1) (0 3)) ((3 1) (2 0))
    ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 69)
  (parent 66)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k70">Item <a href="#t57">70</a>, Parent: <a href="#k67">67</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.340 375.660 44.759 411.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 70</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((0 2) (4 0)) ((1 1) (0 1))
    ((1 3) (0 3)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (3 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 70)
  (parent 67)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k71">Item <a href="#t57">71</a>, Parent: <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat pms cr sr)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat pms cr sr)</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g><title>(hash (hash pms cr sr) &quot;server_write&quot;)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.729 338.906 45.578 412.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>cr</title><circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr) (sr sr) (pms pms) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g><title>((cr cr-0) (sr sr-0) (server server) (ca ca))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 71</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (cr sr cr-0 sr-0 random32) (pms random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand client-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca))
  (defstrand server-auth 4 (cr cr) (sr sr) (pms pms) (server server)
    (ca ca))
  (deflistener (hash (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat (hash pms cr sr) &quot;server_write&quot;))
  (deflistener (cat pms cr sr))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((0 2) (5 0)) ((1 1) (0 1))
    ((2 1) (0 1)) ((2 3) (0 3)) ((3 1) (0 4)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig cr sr pms)
  (operation encryption-test (added-listener (cat pms cr sr))
    (hash pms cr sr) (4 0))
  (traces
    ((send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((recv cr-0)
      (send
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca)))))
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;))))
    ((recv (hash (hash pms cr sr) &quot;server_write&quot;))
      (send (hash (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat (hash pms cr sr) &quot;server_write&quot;))
      (send (cat (hash pms cr sr) &quot;server_write&quot;)))
    ((recv (cat pms cr sr)) (send (cat pms cr sr))))
  (label 71)
  (parent 68)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t72">Tree <a href="#top">72</a>, POV <a href="#k72">72</a>.</p>

<div>
 <svg
  class='diagram' width='229.680pt' height='304.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 229.680 304.920' font-size='12.000'>
  <text
   x='189.720' y='251.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k79&quot;, &quot;_self&quot;)'>79</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='176.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k78&quot;, &quot;_self&quot;)'>78</text>
  <line
   x1='139.800' y1='227.460' x2='189.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='213.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k75&quot;, &quot;_self&quot;)'>75</text>
  <line
   x1='89.880' y1='152.460' x2='139.800' y2='227.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k77&quot;, &quot;_self&quot;)'>77</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k76&quot;, &quot;_self&quot;)'>76</text>
  <line
   x1='139.800' y1='77.460' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k74&quot;, &quot;_self&quot;)'>74</text>
  <line
   x1='89.880' y1='152.460' x2='139.800' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='138.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k73&quot;, &quot;_self&quot;)'>73</text>
  <line
   x1='39.960' y1='152.460' x2='89.880' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='138.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k72&quot;, &quot;_self&quot;)'>72</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls12 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k72">Item <a href="#t72">72</a>, Child: <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 72</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid username auth name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (goals
    (forall
      ((sr random32) (challenge text) (server ca appid name)
        (authk akey) (z strd))
      (implies
        (and (p &quot;server-reg&quot; z 6) (p &quot;server-reg&quot; &quot;sr&quot; z sr)
          (p &quot;server-reg&quot; &quot;challenge&quot; z challenge)
          (p &quot;server-reg&quot; &quot;authk&quot; z authk)
          (p &quot;server-reg&quot; &quot;server&quot; z server) (p &quot;server-reg&quot; &quot;ca&quot; z ca)
          (p &quot;server-reg&quot; &quot;appid&quot; z appid) (non (invk authk))
          (non (privk server)) (non (privk ca)) (uniq-at challenge z 4)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p &quot;client-reg&quot; z-0 6)
            (p &quot;client-reg&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;client-reg&quot; &quot;server&quot; z-0 server)
            (p &quot;client-reg&quot; &quot;appid&quot; z-0 appid))))))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 72)
  (unrealized (0 5))
  (origs (challenge (0 4)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k73">Item <a href="#t72">73</a>, Parent: <a href="#k72">72</a>, Children: <a href="#k74">74</a> <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))))) (enc auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge-0) (authk authk) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 73</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48)
    (challenge challenge-0 text) (authk akey)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge-0) (authk authk) (username username)
    (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))
  (precedes ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand client-reg 6)
    (hash &quot;key handle&quot; (invk authk) username) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0))))))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 73)
  (parent 72)
  (unrealized (0 5))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k74">Item <a href="#t72">74</a>, Parent: <a href="#k73">73</a>, Children: <a href="#k76">76</a> <a href="#k77">77</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 74</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48) (challenge text)
    (authk akey) (username auth server ca appid name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (precedes ((0 4) (1 4)) ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (displaced 2 1 client-reg 6)
    (enc auth-0 authk
      (hash appid-0 challenge-0
        (hash &quot;uaf_server_endpoint&quot; challenge-0
          (hash server-0 (pubk server-0)
            (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
      (invk authk)) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 74)
  (parent 73)
  (unrealized (1 1) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k75">Item <a href="#t72">75</a>, Parent: <a href="#k73">73</a>, Children: <a href="#k78">78</a> <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username-0) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 appid challenge (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))))) (enc auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (pms pms-1) (challenge challenge) (authk authk) (username username-0) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge-0) (authk authk) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 75</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (challenge challenge-0 text) (authk akey)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge-0) (authk authk) (username username)
    (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))
  (defstrand client-reg 6 (cr cr-1) (sr sr-1) (pms pms-1)
    (challenge challenge) (authk authk) (username username-0)
    (auth auth) (server server) (ca ca) (appid appid))
  (precedes ((0 4) (2 4)) ((1 5) (0 5)) ((2 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand client-reg 6)
    (enc auth authk
      (hash appid challenge
        (hash &quot;uaf_server_endpoint&quot; challenge
          (hash server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))))
      (invk authk)) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0))))))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-1 (pubk server))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-1 (pubk server))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-1 (pubk server))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-1 (pubk server))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc username-0 appid challenge
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))))
  (label 75)
  (parent 73)
  (unrealized (2 1) (2 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k76">Item <a href="#t72">76</a>, Parent: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 76</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48) (challenge text)
    (authk akey) (username auth server ca appid name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (precedes ((0 1) (1 1)) ((0 4) (1 4)) ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (1 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 76)
  (parent 74)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (server server) (ca ca)
        (appid appid) (authk authk) (username username) (auth auth)
        (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="k77">Item <a href="#t72">77</a>, Parent: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-1) (sr sr-1) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 77</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (challenge text) (authk akey) (username auth server ca appid name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server) (ca ca))
  (precedes ((0 4) (1 4)) ((1 5) (0 5)) ((2 1) (1 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (1 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((recv cr-1)
      (send
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 77)
  (parent 74)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (server server) (ca ca)
        (appid appid) (authk authk) (username username) (auth auth)
        (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="k78">Item <a href="#t72">78</a>, Parent: <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username-0) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 appid challenge (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))))) (enc auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (pms pms-1) (challenge challenge) (authk authk) (username username-0) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge-0) (authk authk) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 78</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 pms-1 random48)
    (challenge challenge-0 text) (authk akey)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge-0) (authk authk) (username username)
    (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))
  (defstrand client-reg 6 (cr cr-1) (sr sr-1) (pms pms-1)
    (challenge challenge) (authk authk) (username username-0)
    (auth auth) (server server) (ca ca) (appid appid))
  (precedes ((0 1) (2 1)) ((0 4) (2 4)) ((1 5) (0 5)) ((2 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (displaced 3 0 server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (2 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0))))))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-1 (pubk server))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-1 (pubk server))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-1 (pubk server))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-1 (pubk server))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc username-0 appid challenge
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))))
  (label 78)
  (parent 75)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (server server) (ca ca)
        (appid appid) (authk authk) (username username) (auth auth)
        (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="k79">Item <a href="#t72">79</a>, Parent: <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='114.960' x2='339.840' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 189.960 Q 292.860 189.960 245.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-2 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='339.840' cy='189.960' r='6.000'/></g>
  <g><title>cr-2</title>
   <circle style='fill: blue;' cx='339.840' cy='114.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username-0) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 appid challenge (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-1 &quot;server finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))) (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-1 (pubk server)) (enc (hash pms-1 &quot;client finished&quot; (hash cr-1 sr-1 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-1 (pubk server)))) (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;)))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title><circle cx='239.880' cy='114.960' r='6.000'/>
   </g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))))) (enc auth-0 authk (hash appid-0 challenge-0 (hash &quot;uaf_server_endpoint&quot; challenge-0 (hash server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))))) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server-0)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0))) (enc pms-0 (pubk server-0)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server-0 (pubk server-0) (enc (hash server-0 (pubk server-0)) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))))) (enc auth authk (hash appid challenge (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca))))) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-2) (sr sr-2) (server server) (ca ca))</title>
   <text
    x='339.840' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (pms pms-1) (challenge challenge) (authk authk) (username username-0) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge-0) (authk authk) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (username username) (auth auth) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 79</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 cr-2 sr-2 random32)
    (pms pms-0 pms-1 random48) (challenge challenge-0 text) (authk akey)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name))
  (defstrand server-reg 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (username username) (auth auth)
    (server server) (ca ca) (appid appid))
  (defstrand client-reg 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge-0) (authk authk) (username username)
    (auth auth-0) (server server-0) (ca ca-0) (appid appid-0))
  (defstrand client-reg 6 (cr cr-1) (sr sr-1) (pms pms-1)
    (challenge challenge) (authk authk) (username username-0)
    (auth auth) (server server) (ca ca) (appid appid))
  (defstrand server-auth 2 (cr cr-2) (sr sr-2) (server server) (ca ca))
  (precedes ((0 4) (2 4)) ((1 5) (0 5)) ((2 5) (0 5)) ((3 1) (2 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (2 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server-0 (pubk server-0)
          (enc (hash server-0 (pubk server-0)) (privk ca-0))))
      (send
        (cat (enc pms-0 (pubk server-0))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))
                (enc pms-0 (pubk server-0))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server-0 (pubk server-0)
                (enc (hash server-0 (pubk server-0)) (privk ca-0)))
              (enc pms-0 (pubk server-0))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server-0 (pubk server-0)
                      (enc (hash server-0 (pubk server-0))
                        (privk ca-0))) (enc pms-0 (pubk server-0))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0))))))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash &quot;uaf_server_endpoint&quot; challenge-0
                (hash server-0 (pubk server-0)
                  (enc (hash server-0 (pubk server-0)) (privk ca-0)))))
            (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((send cr-1)
      (recv
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-1 (pubk server))
          (enc
            (hash pms-1 &quot;client finished&quot;
              (hash cr-1 sr-1
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-1 (pubk server))))
            (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-1 &quot;server finished&quot;
            (hash cr-1 sr-1
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-1 (pubk server))
              (enc
                (hash pms-1 &quot;client finished&quot;
                  (hash cr-1 sr-1
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-1 (pubk server))))
                (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (recv
        (enc username-0 appid challenge
          (hash (hash pms-1 cr-1 sr-1) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk))
          (hash (hash pms-1 cr-1 sr-1) &quot;client_write&quot;))))
    ((recv cr-2)
      (send
        (cat sr-2 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 79)
  (parent 75)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (server server) (ca ca)
        (appid appid) (authk authk) (username username) (auth auth)
        (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="t80">Tree <a href="#top">80</a>, POV <a href="#k80">80</a>.</p>

<div>
 <svg
  class='diagram' width='179.760pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.760 154.920' font-size='12.000'>
  <text
   x='139.800' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k83&quot;, &quot;_self&quot;)'>83</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k82&quot;, &quot;_self&quot;)'>82</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k81&quot;, &quot;_self&quot;)'>81</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k80&quot;, &quot;_self&quot;)'>80</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls12 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (send cr)
      (recv
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc username appid challenge
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))))
          (enc auth authk
            (hash appid challenge
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))))
            (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (pms random48) (authk akey))
    (trace (recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k80">Item <a href="#t80">80</a>, Child: <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 80</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr random32) (pms random48) (challenge text) (authk akey)
    (server ca appid name))
  (defstrand server-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (goals
    (forall
      ((sr random32) (challenge text) (server ca appid name)
        (authk akey) (z strd))
      (implies
        (and (p &quot;server-auth&quot; z 6) (p &quot;server-auth&quot; &quot;sr&quot; z sr)
          (p &quot;server-auth&quot; &quot;challenge&quot; z challenge)
          (p &quot;server-auth&quot; &quot;authk&quot; z authk)
          (p &quot;server-auth&quot; &quot;server&quot; z server)
          (p &quot;server-auth&quot; &quot;ca&quot; z ca) (p &quot;server-auth&quot; &quot;appid&quot; z appid)
          (non (invk authk)) (non (privk server)) (non (privk ca))
          (uniq-at challenge z 4) (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p &quot;client-auth&quot; z-0 6)
            (p &quot;client-auth&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;client-auth&quot; &quot;server&quot; z-0 server)
            (p &quot;client-auth&quot; &quot;appid&quot; z-0 appid))))))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;)))))
  (label 80)
  (unrealized (0 5))
  (origs (challenge (0 4)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k81">Item <a href="#t80">81</a>, Parent: <a href="#k80">80</a>, Children: <a href="#k82">82</a> <a href="#k83">83</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 81</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand server-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand client-auth 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (precedes ((0 4) (1 4)) ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand client-auth 6)
    (enc
      (hash appid
        (hash &quot;uaf_server_endpoint&quot; challenge
          (hash server (pubk server)
            (enc (hash server (pubk server)) (privk ca)))) challenge)
      (invk authk)) (0 5))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 81)
  (parent 80)
  (unrealized (1 1) (1 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k82">Item <a href="#t80">82</a>, Parent: <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 82</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 random32) (pms pms-0 random48) (challenge text)
    (authk akey) (server ca appid name))
  (defstrand server-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand client-auth 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (precedes ((0 1) (1 1)) ((0 4) (1 4)) ((1 5) (0 5)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (1 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))))
  (label 82)
  (parent 81)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (server server) (ca ca)
        (appid appid) (authk authk) (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

<p id="k83">Item <a href="#t80">83</a>, Parent: <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 192.900 189.960 145.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat sr-1 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>cr-1</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms-0 &quot;server finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))) (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms-0 (pubk server)) (enc (hash pms-0 &quot;client finished&quot; (hash cr-0 sr-0 (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms-0 (pubk server)))) (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;)))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr-0 server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>cr-0</title><circle cx='139.920' cy='114.960' r='6.000'/>
   </g>
  <g>
   <title>(enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (enc (hash appid (hash &quot;uaf_server_endpoint&quot; challenge (hash server (pubk server) (enc (hash server (pubk server)) (privk ca)))) challenge) (invk authk)) (hash (hash pms cr sr) &quot;client_write&quot;))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash pms &quot;server finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))) (hash (hash pms cr sr) &quot;server_write&quot;))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (enc pms (pubk server)) (enc (hash pms &quot;client finished&quot; (hash cr sr (cat server (pubk server) (enc (hash server (pubk server)) (privk ca))) (enc pms (pubk server)))) (hash (hash pms cr sr) &quot;client_write&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat sr server (pubk server) (enc (hash server (pubk server)) (privk ca)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>cr</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-1) (sr sr-1) (server server) (ca ca))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (pms pms-0) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (pms pms) (challenge challenge) (authk authk) (server server) (ca ca) (appid appid))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls12 83</text></svg></div>

<pre>(defskeleton uaf-unbound-tls12
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32) (pms pms-0 random48)
    (challenge text) (authk akey) (server ca appid name))
  (defstrand server-auth 6 (cr cr) (sr sr) (pms pms)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand client-auth 6 (cr cr-0) (sr sr-0) (pms pms-0)
    (challenge challenge) (authk authk) (server server) (ca ca)
    (appid appid))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server) (ca ca))
  (precedes ((0 4) (1 4)) ((1 5) (0 5)) ((2 1) (1 1)))
  (non-orig (invk authk) (privk server) (privk ca))
  (uniq-orig sr challenge)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server (pubk server)) (privk ca)) (1 1))
  (traces
    ((recv cr)
      (send
        (cat sr server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (recv
        (cat (enc pms (pubk server))
          (enc
            (hash pms &quot;client finished&quot;
              (hash cr sr
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms (pubk server))))
            (hash (hash pms cr sr) &quot;client_write&quot;))))
      (send
        (enc
          (hash pms &quot;server finished&quot;
            (hash cr sr
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms (pubk server))
              (enc
                (hash pms &quot;client finished&quot;
                  (hash cr sr
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms (pubk server))))
                (hash (hash pms cr sr) &quot;client_write&quot;))))
          (hash (hash pms cr sr) &quot;server_write&quot;)))
      (send
        (enc appid challenge (hash (hash pms cr sr) &quot;server_write&quot;)))
      (recv
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms cr sr) &quot;client_write&quot;))))
    ((send cr-0)
      (recv
        (cat sr-0 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))
      (send
        (cat (enc pms-0 (pubk server))
          (enc
            (hash pms-0 &quot;client finished&quot;
              (hash cr-0 sr-0
                (cat server (pubk server)
                  (enc (hash server (pubk server)) (privk ca)))
                (enc pms-0 (pubk server))))
            (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
      (recv
        (enc
          (hash pms-0 &quot;server finished&quot;
            (hash cr-0 sr-0
              (cat server (pubk server)
                (enc (hash server (pubk server)) (privk ca)))
              (enc pms-0 (pubk server))
              (enc
                (hash pms-0 &quot;client finished&quot;
                  (hash cr-0 sr-0
                    (cat server (pubk server)
                      (enc (hash server (pubk server)) (privk ca)))
                    (enc pms-0 (pubk server))))
                (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (recv
        (enc appid challenge
          (hash (hash pms-0 cr-0 sr-0) &quot;server_write&quot;)))
      (send
        (enc
          (hash appid
            (hash &quot;uaf_server_endpoint&quot; challenge
              (hash server (pubk server)
                (enc (hash server (pubk server)) (privk ca))))
            challenge)
          (enc
            (hash appid
              (hash &quot;uaf_server_endpoint&quot; challenge
                (hash server (pubk server)
                  (enc (hash server (pubk server)) (privk ca))))
              challenge) (invk authk))
          (hash (hash pms-0 cr-0 sr-0) &quot;client_write&quot;))))
    ((recv cr-1)
      (send
        (cat sr-1 server (pubk server)
          (enc (hash server (pubk server)) (privk ca))))))
  (label 83)
  (parent 81)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (server server) (ca ca)
        (appid appid) (authk authk) (cr cr) (pms pms))))
  (origs (challenge (0 4)) (sr (0 1))))</pre>

</body>
</html>
