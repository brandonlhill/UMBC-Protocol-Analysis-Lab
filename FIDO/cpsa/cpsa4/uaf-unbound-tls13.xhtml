<?xml version="1.0"?>
<!-- CPSA 4.4.2 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>UAF using TLS1.3 without channel binding.</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;UAF using TLS1.3 without channel binding.&quot;)
(comment &quot;CPSA 4.4.2&quot;)
(comment &quot;All input read from uaf-unbound-tls13.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t26">26</a> <a href="#t52">52</a> <a href="#t56">56</a> <a href="#t58">58</a> <a href="#t84">84</a> <a href="#t110">110</a> <a href="#t114">114</a>.</p>

<p id="t0">Tree <a href="#top">0</a>, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 754.920' font-size='12.000'>
  <text
   x='339.480' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='239.640' y1='677.460' x2='289.560' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='239.640' y1='414.960' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  <line
   x1='239.640' y1='302.460' x2='289.560' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='189.720' y1='302.460' x2='239.640' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls13 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 0</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x rndx) (y expt))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 0)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Children: <a href="#k2">2</a> <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 1</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x rndx) (y x-0 expt)
    (y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
              sr-0))))))
  (label 1)
  (parent 0)
  (unrealized (0 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k4">4</a> <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 2</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))))
  (label 2)
  (parent 1)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k6">6</a> <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 3</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))))
  (label 3)
  (parent 1)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k8">8</a> <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 4</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test (displaced 1 2 server-reg 4)
    (enc username appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y-0)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 4)
  (parent 2)
  (unrealized (1 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k2">2</a>, Child: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 5</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc username appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 5)
  (parent 2)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k3">3</a>, Children: <a href="#k11">11</a> <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 6</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (displaced 2 3 server-reg 4)
    (enc username appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 6)
  (parent 3)
  (unrealized (2 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k3">3</a>, Child: <a href="#k13">13</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 7</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc username appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 7)
  (parent 3)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 8</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (y x rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))))
  (label 8)
  (parent 4)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (cr cr) (sr sr) (authk authk) (spk spk)
        (username username) (auth auth) (appid appid)
        (challenge challenge) (x x) (y y))))
  (origs (cr (0 0)) (sr (1 1))))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k4">4</a>, Child: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 9</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 9)
  (parent 4)
  (unrealized (1 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k5">5</a>, Child: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 10</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 10)
  (parent 5)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k6">6</a>, Seen Child: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 11</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x expt) (y y-0 x-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))))
  (label 11)
  (parent 6)
  (seen 8)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k6">6</a>, Child: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 12</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 12)
  (parent 6)
  (unrealized (2 2) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k7">7</a>, Child: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 13</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 13)
  (parent 7)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k9">9</a>, Children: <a href="#k18">18</a> <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 14</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 14)
  (parent 9)
  (unrealized (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k15">Item <a href="#t0">15</a>, Parent: <a href="#k10">10</a>, Children: <a href="#k20">20</a> <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 15</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;))))
  (label 15)
  (parent 10)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k16">Item <a href="#t0">16</a>, Parent: <a href="#k12">12</a>, Children: <a href="#k22">22</a> <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 16</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 16)
  (parent 12)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k17">Item <a href="#t0">17</a>, Parent: <a href="#k13">13</a>, Children: <a href="#k24">24</a> <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 17</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 17)
  (parent 13)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k18">Item <a href="#t0">18</a>, Parent: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 18</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 18)
  (parent 14)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k19">Item <a href="#t0">19</a>, Parent: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 19</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 19)
  (parent 14)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k20">Item <a href="#t0">20</a>, Parent: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 20</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 20)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k21">Item <a href="#t0">21</a>, Parent: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 21</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 21)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k22">Item <a href="#t0">22</a>, Parent: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 22</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 22)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k23">Item <a href="#t0">23</a>, Parent: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 23</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (username auth appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 23)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k24">Item <a href="#t0">24</a>, Parent: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 24</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 24)
  (parent 17)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k25">Item <a href="#t0">25</a>, Parent: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 25</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca username auth appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 25)
  (parent 17)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t26">Tree <a href="#top">26</a>, POV <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 754.920' font-size='12.000'>
  <text
   x='339.480' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k51&quot;, &quot;_self&quot;)'>51</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k50&quot;, &quot;_self&quot;)'>50</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='239.640' y1='677.460' x2='289.560' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k49&quot;, &quot;_self&quot;)'>49</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k48&quot;, &quot;_self&quot;)'>48</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='239.640' y1='414.960' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='239.640' y1='302.460' x2='289.560' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='189.720' y1='302.460' x2='239.640' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls13 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k26">Item <a href="#t26">26</a>, Child: <a href="#k27">27</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 26</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x rndx) (y expt))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 26)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k27">Item <a href="#t26">27</a>, Parent: <a href="#k26">26</a>, Children: <a href="#k28">28</a> <a href="#k29">29</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 27</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x rndx) (y x-0 expt) (y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
              sr-0))))))
  (label 27)
  (parent 26)
  (unrealized (0 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k28">Item <a href="#t26">28</a>, Parent: <a href="#k27">27</a>, Children: <a href="#k30">30</a> <a href="#k31">31</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 28</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))))
  (label 28)
  (parent 27)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k29">Item <a href="#t26">29</a>, Parent: <a href="#k27">27</a>, Children: <a href="#k32">32</a> <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 29</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))))
  (label 29)
  (parent 27)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k30">Item <a href="#t26">30</a>, Parent: <a href="#k28">28</a>, Children: <a href="#k34">34</a> <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 30</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y-0)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 30)
  (parent 28)
  (unrealized (1 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k31">Item <a href="#t26">31</a>, Parent: <a href="#k28">28</a>, Child: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 31</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 31)
  (parent 28)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k32">Item <a href="#t26">32</a>, Parent: <a href="#k29">29</a>, Children: <a href="#k37">37</a> <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 32</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (displaced 2 3 server-auth 4)
    (enc appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 32)
  (parent 29)
  (unrealized (2 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k33">Item <a href="#t26">33</a>, Parent: <a href="#k29">29</a>, Child: <a href="#k39">39</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 33</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 33)
  (parent 29)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k34">Item <a href="#t26">34</a>, Parent: <a href="#k30">30</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 34</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (y x rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))))
  (label 34)
  (parent 30)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (cr cr) (sr sr) (authk authk) (spk spk)
        (appid appid) (challenge challenge) (x x) (y y))))
  (origs (cr (0 0)) (sr (1 1))))</pre>

<p id="k35">Item <a href="#t26">35</a>, Parent: <a href="#k30">30</a>, Child: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 35</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 35)
  (parent 30)
  (unrealized (1 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k36">Item <a href="#t26">36</a>, Parent: <a href="#k31">31</a>, Child: <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 36</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 36)
  (parent 31)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k37">Item <a href="#t26">37</a>, Parent: <a href="#k32">32</a>, Seen Child: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 37</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y y-0 x-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))))
  (label 37)
  (parent 32)
  (seen 34)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k38">Item <a href="#t26">38</a>, Parent: <a href="#k32">32</a>, Child: <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 38</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 38)
  (parent 32)
  (unrealized (2 2) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k39">Item <a href="#t26">39</a>, Parent: <a href="#k33">33</a>, Child: <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 39</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 39)
  (parent 33)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k40">Item <a href="#t26">40</a>, Parent: <a href="#k35">35</a>, Children: <a href="#k44">44</a> <a href="#k45">45</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 40</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 40)
  (parent 35)
  (unrealized (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k41">Item <a href="#t26">41</a>, Parent: <a href="#k36">36</a>, Children: <a href="#k46">46</a> <a href="#k47">47</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 41</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;))))
  (label 41)
  (parent 36)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k42">Item <a href="#t26">42</a>, Parent: <a href="#k38">38</a>, Children: <a href="#k48">48</a> <a href="#k49">49</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 42</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 42)
  (parent 38)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k43">Item <a href="#t26">43</a>, Parent: <a href="#k39">39</a>, Children: <a href="#k50">50</a> <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 43</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 43)
  (parent 39)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k44">Item <a href="#t26">44</a>, Parent: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 44</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 44)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k45">Item <a href="#t26">45</a>, Parent: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 45</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 45)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k46">Item <a href="#t26">46</a>, Parent: <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 46</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 46)
  (parent 41)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k47">Item <a href="#t26">47</a>, Parent: <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 47</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 47)
  (parent 41)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k48">Item <a href="#t26">48</a>, Parent: <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 48</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 48)
  (parent 42)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k49">Item <a href="#t26">49</a>, Parent: <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 49</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 49)
  (parent 42)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k50">Item <a href="#t26">50</a>, Parent: <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 50</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 50)
  (parent 43)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k51">Item <a href="#t26">51</a>, Parent: <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 51</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 51)
  (parent 43)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t52">Tree <a href="#top">52</a>, POV <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='179.760pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.760 154.920' font-size='12.000'>
  <text
   x='139.800' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k55&quot;, &quot;_self&quot;)'>55</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k53&quot;, &quot;_self&quot;)'>53</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls13 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k52">Item <a href="#t52">52</a>, Child: <a href="#k53">53</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 52</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr random32) (challenge text) (authk spk akey)
    (username server ca auth appid name) (x expt) (y rndx))
  (defstrand server-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge username)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 52)
  (unrealized (0 4))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k53">Item <a href="#t52">53</a>, Parent: <a href="#k52">52</a>, Children: <a href="#k54">54</a> <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;)) (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (challenge challenge-0) (authk authk) (spk spk-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 53</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr cr-0 sr-0 random32) (challenge challenge-0 text)
    (authk spk spk-0 akey)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (x expt) (y x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand client-reg 5 (cr cr-0) (sr sr-0) (challenge challenge-0)
    (authk authk) (spk spk-0) (username username) (auth auth-0)
    (server server-0) (ca ca-0) (appid appid-0) (x x-0) (y y-0))
  (precedes ((0 3) (1 3)) ((1 4) (0 4)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge username)
  (uniq-gen y x-0)
  (absent (y x))
  (operation encryption-test (added-strand client-reg 5)
    (hash &quot;key handle&quot; (invk authk) username) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;))
          (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;)
            (invk authk))
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 53)
  (parent 52)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k54">Item <a href="#t52">54</a>, Parent: <a href="#k53">53</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (challenge challenge) (authk authk) (spk spk-0) (username username) (auth auth) (server server-0) (ca ca-0) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 54</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr cr-0 sr-0 random32) (challenge text)
    (authk spk spk-0 akey)
    (username server ca auth server-0 ca-0 appid name) (x expt)
    (y x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand client-reg 5 (cr cr-0) (sr sr-0) (challenge challenge)
    (authk authk) (spk spk-0) (username username) (auth auth)
    (server server-0) (ca ca-0) (appid appid) (x x-0) (y y-0))
  (precedes ((0 3) (1 3)) ((1 4) (0 4)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge username)
  (uniq-gen y x-0)
  (absent (y x))
  (operation encryption-test (displaced 2 1 client-reg 5)
    (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;) (invk authk))
    (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 54)
  (parent 53)
  (realized)
  (shape)
  (maps
    ((0)
      ((username username) (server server) (ca ca) (sr sr)
        (challenge challenge) (authk authk) (spk spk) (auth auth)
        (appid appid) (cr cr) (x x) (y y))))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1))))</pre>

<p id="k55">Item <a href="#t52">55</a>, Parent: <a href="#k53">53</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username-0) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 appid challenge (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;)) (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (challenge challenge) (authk authk) (spk spk-1) (username username-0) (auth auth) (server server-1) (ca ca-1) (appid appid) (x x-1) (y y-1))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (challenge challenge-0) (authk authk) (spk spk-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 55</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32)
    (challenge challenge-0 text) (authk spk spk-0 spk-1 akey)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (x expt) (y x-0 rndx) (y-0 expt)
    (x-1 rndx) (y-1 expt))
  (defstrand server-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand client-reg 5 (cr cr-0) (sr sr-0) (challenge challenge-0)
    (authk authk) (spk spk-0) (username username) (auth auth-0)
    (server server-0) (ca ca-0) (appid appid-0) (x x-0) (y y-0))
  (defstrand client-reg 5 (cr cr-1) (sr sr-1) (challenge challenge)
    (authk authk) (spk spk-1) (username username-0) (auth auth)
    (server server-1) (ca ca-1) (appid appid) (x x-1) (y y-1))
  (precedes ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 4) (0 4)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge username)
  (uniq-gen y x-0 x-1)
  (absent (y x))
  (operation encryption-test (added-strand client-reg 5)
    (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
    (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;))
          (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;)
            (invk authk))
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc username-0 appid challenge
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username-0)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
  (label 55)
  (parent 53)
  (realized)
  (shape)
  (maps
    ((0)
      ((username username) (server server) (ca ca) (sr sr)
        (challenge challenge) (authk authk) (spk spk) (auth auth)
        (appid appid) (cr cr) (x x) (y y))))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1))))</pre>

<p id="t56">Tree <a href="#top">56</a>, POV <a href="#k56">56</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k56&quot;, &quot;_self&quot;)'>56</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls13 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k56">Item <a href="#t56">56</a>, Child: <a href="#k57">57</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 56</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y rndx))
  (defstrand server-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge)
  (uniq-gen y)
  (absent (y x))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 56)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k57">Item <a href="#t56">57</a>, Parent: <a href="#k56">56</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (challenge challenge) (authk authk) (spk spk-0) (server server-0) (ca ca-0) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 57</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr cr-0 sr-0 random32) (challenge text)
    (authk spk spk-0 akey) (server ca appid server-0 ca-0 name) (x expt)
    (y x-0 rndx) (y-0 expt))
  (defstrand server-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand client-auth 5 (cr cr-0) (sr sr-0) (challenge challenge)
    (authk authk) (spk spk-0) (server server-0) (ca ca-0) (appid appid)
    (x x-0) (y y-0))
  (precedes ((0 3) (1 3)) ((1 4) (0 4)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge)
  (uniq-gen y x-0)
  (absent (y x))
  (operation encryption-test (added-strand client-auth 5)
    (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 57)
  (parent 56)
  (realized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (spk spk) (appid appid) (cr cr) (x x) (y y))))
  (origs (challenge (0 3)) (sr (0 1))))</pre>

<p id="t58">Tree <a href="#top">58</a>, POV <a href="#k58">58</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 754.920' font-size='12.000'>
  <text
   x='339.480' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k83&quot;, &quot;_self&quot;)'>83</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k82&quot;, &quot;_self&quot;)'>82</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k75&quot;, &quot;_self&quot;)'>75</text>
  <line
   x1='239.640' y1='677.460' x2='289.560' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k71&quot;, &quot;_self&quot;)'>71</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k65&quot;, &quot;_self&quot;)'>65</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k81&quot;, &quot;_self&quot;)'>81</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k80&quot;, &quot;_self&quot;)'>80</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k74&quot;, &quot;_self&quot;)'>74</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k70&quot;, &quot;_self&quot;)'>70</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='239.640' y1='414.960' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k69&quot;, &quot;_self&quot;)'>69</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k64&quot;, &quot;_self&quot;)'>64</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k61&quot;, &quot;_self&quot;)'>61</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k79&quot;, &quot;_self&quot;)'>79</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k78&quot;, &quot;_self&quot;)'>78</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k73&quot;, &quot;_self&quot;)'>73</text>
  <line
   x1='239.640' y1='302.460' x2='289.560' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k68&quot;, &quot;_self&quot;)'>68</text>
  <line
   x1='189.720' y1='302.460' x2='239.640' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k63&quot;, &quot;_self&quot;)'>63</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k77&quot;, &quot;_self&quot;)'>77</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k76&quot;, &quot;_self&quot;)'>76</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k72&quot;, &quot;_self&quot;)'>72</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k67&quot;, &quot;_self&quot;)'>67</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k62&quot;, &quot;_self&quot;)'>62</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k60&quot;, &quot;_self&quot;)'>60</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k59&quot;, &quot;_self&quot;)'>59</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k58&quot;, &quot;_self&quot;)'>58</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls13 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k58">Item <a href="#t58">58</a>, Child: <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 58</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x rndx) (y expt))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((cr sr random32) (challenge text) (authk spk akey)
        (server ca appid name) (x rndx) (z strd))
      (implies
        (and (p &quot;client-reg&quot; z 5) (p &quot;client-reg&quot; &quot;cr&quot; z cr)
          (p &quot;client-reg&quot; &quot;sr&quot; z sr)
          (p &quot;client-reg&quot; &quot;challenge&quot; z challenge)
          (p &quot;client-reg&quot; &quot;authk&quot; z authk) (p &quot;client-reg&quot; &quot;spk&quot; z spk)
          (p &quot;client-reg&quot; &quot;appid&quot; z appid)
          (p &quot;client-reg&quot; &quot;server&quot; z server) (p &quot;client-reg&quot; &quot;ca&quot; z ca)
          (p &quot;client-reg&quot; &quot;x&quot; z x) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (uniq sr) (ugen x) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p &quot;server-reg&quot; z-0 4)
            (p &quot;server-reg&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;server-reg&quot; &quot;appid&quot; z-0 appid)
            (p &quot;server-reg&quot; &quot;server&quot; z-0 server))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 58)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k59">Item <a href="#t58">59</a>, Parent: <a href="#k58">58</a>, Children: <a href="#k60">60</a> <a href="#k61">61</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 59</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x rndx) (y x-0 expt)
    (y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
              sr-0))))))
  (label 59)
  (parent 58)
  (unrealized (0 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k60">Item <a href="#t58">60</a>, Parent: <a href="#k59">59</a>, Children: <a href="#k62">62</a> <a href="#k63">63</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 60</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))))
  (label 60)
  (parent 59)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k61">Item <a href="#t58">61</a>, Parent: <a href="#k59">59</a>, Children: <a href="#k64">64</a> <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 61</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))))
  (label 61)
  (parent 59)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k62">Item <a href="#t58">62</a>, Parent: <a href="#k60">60</a>, Children: <a href="#k66">66</a> <a href="#k67">67</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 62</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test (displaced 1 2 server-reg 4)
    (enc username appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y-0)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 62)
  (parent 60)
  (unrealized (1 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k63">Item <a href="#t58">63</a>, Parent: <a href="#k60">60</a>, Child: <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 63</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc username appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 63)
  (parent 60)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k64">Item <a href="#t58">64</a>, Parent: <a href="#k61">61</a>, Children: <a href="#k69">69</a> <a href="#k70">70</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 64</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (displaced 2 3 server-reg 4)
    (enc username appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 64)
  (parent 61)
  (unrealized (2 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k65">Item <a href="#t58">65</a>, Parent: <a href="#k61">61</a>, Child: <a href="#k71">71</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 65</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc username appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 65)
  (parent 61)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k66">Item <a href="#t58">66</a>, Parent: <a href="#k62">62</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 66</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (y x rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))))
  (label 66)
  (parent 62)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (x x) (username username)
        (auth auth) (y y))))
  (origs (sr (1 1)) (cr (0 0))))</pre>

<p id="k67">Item <a href="#t58">67</a>, Parent: <a href="#k62">62</a>, Child: <a href="#k72">72</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 67</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 67)
  (parent 62)
  (unrealized (1 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k68">Item <a href="#t58">68</a>, Parent: <a href="#k63">63</a>, Child: <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 68</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 68)
  (parent 63)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k69">Item <a href="#t58">69</a>, Parent: <a href="#k64">64</a>, Seen Child: <a href="#k66">66</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 69</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x expt) (y y-0 x-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))))
  (label 69)
  (parent 64)
  (seen 66)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k70">Item <a href="#t58">70</a>, Parent: <a href="#k64">64</a>, Child: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 70</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 70)
  (parent 64)
  (unrealized (2 2) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k71">Item <a href="#t58">71</a>, Parent: <a href="#k65">65</a>, Child: <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 71</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 71)
  (parent 65)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k72">Item <a href="#t58">72</a>, Parent: <a href="#k67">67</a>, Children: <a href="#k76">76</a> <a href="#k77">77</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 72</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 72)
  (parent 67)
  (unrealized (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k73">Item <a href="#t58">73</a>, Parent: <a href="#k68">68</a>, Children: <a href="#k78">78</a> <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 73</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;))))
  (label 73)
  (parent 68)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k74">Item <a href="#t58">74</a>, Parent: <a href="#k70">70</a>, Children: <a href="#k80">80</a> <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 74</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 74)
  (parent 70)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k75">Item <a href="#t58">75</a>, Parent: <a href="#k71">71</a>, Children: <a href="#k82">82</a> <a href="#k83">83</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 75</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 75)
  (parent 71)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k76">Item <a href="#t58">76</a>, Parent: <a href="#k72">72</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 76</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 76)
  (parent 72)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k77">Item <a href="#t58">77</a>, Parent: <a href="#k72">72</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 77</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 77)
  (parent 72)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k78">Item <a href="#t58">78</a>, Parent: <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 78</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 78)
  (parent 73)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k79">Item <a href="#t58">79</a>, Parent: <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 79</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x y rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 79)
  (parent 73)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k80">Item <a href="#t58">80</a>, Parent: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 80</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 80)
  (parent 74)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k81">Item <a href="#t58">81</a>, Parent: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (username username) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 81</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid username auth server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-reg 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (username username) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 81)
  (parent 74)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k82">Item <a href="#t58">82</a>, Parent: <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 82</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 82)
  (parent 75)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k83">Item <a href="#t58">83</a>, Parent: <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 83</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 83)
  (parent 75)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t84">Tree <a href="#top">84</a>, POV <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 754.920' font-size='12.000'>
  <text
   x='339.480' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k109&quot;, &quot;_self&quot;)'>109</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k108&quot;, &quot;_self&quot;)'>108</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k101&quot;, &quot;_self&quot;)'>101</text>
  <line
   x1='239.640' y1='677.460' x2='289.560' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k97&quot;, &quot;_self&quot;)'>97</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k91&quot;, &quot;_self&quot;)'>91</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k107&quot;, &quot;_self&quot;)'>107</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k106&quot;, &quot;_self&quot;)'>106</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k100&quot;, &quot;_self&quot;)'>100</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k96&quot;, &quot;_self&quot;)'>96</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k92&quot;, &quot;_self&quot;)'>92</text>
  <line
   x1='239.640' y1='414.960' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='401.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k95&quot;, &quot;_self&quot;)'>95</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k90&quot;, &quot;_self&quot;)'>90</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k87&quot;, &quot;_self&quot;)'>87</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k105&quot;, &quot;_self&quot;)'>105</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k104&quot;, &quot;_self&quot;)'>104</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k99&quot;, &quot;_self&quot;)'>99</text>
  <line
   x1='239.640' y1='302.460' x2='289.560' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k94&quot;, &quot;_self&quot;)'>94</text>
  <line
   x1='189.720' y1='302.460' x2='239.640' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k89&quot;, &quot;_self&quot;)'>89</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k103&quot;, &quot;_self&quot;)'>103</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k102&quot;, &quot;_self&quot;)'>102</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k98&quot;, &quot;_self&quot;)'>98</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k93&quot;, &quot;_self&quot;)'>93</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k92&quot;, &quot;_self&quot;)'>92</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k88&quot;, &quot;_self&quot;)'>88</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k86&quot;, &quot;_self&quot;)'>86</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k85&quot;, &quot;_self&quot;)'>85</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k84&quot;, &quot;_self&quot;)'>84</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls13 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k84">Item <a href="#t84">84</a>, Child: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 84</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x rndx) (y expt))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x)
  (goals
    (forall
      ((cr sr random32) (challenge text) (authk spk akey)
        (server ca appid name) (x rndx) (z strd))
      (implies
        (and (p &quot;client-auth&quot; z 5) (p &quot;client-auth&quot; &quot;cr&quot; z cr)
          (p &quot;client-auth&quot; &quot;sr&quot; z sr)
          (p &quot;client-auth&quot; &quot;challenge&quot; z challenge)
          (p &quot;client-auth&quot; &quot;authk&quot; z authk)
          (p &quot;client-auth&quot; &quot;spk&quot; z spk)
          (p &quot;client-auth&quot; &quot;appid&quot; z appid)
          (p &quot;client-auth&quot; &quot;server&quot; z server)
          (p &quot;client-auth&quot; &quot;ca&quot; z ca) (p &quot;client-auth&quot; &quot;x&quot; z x)
          (non (invk authk)) (non (invk spk)) (non (privk ca)) (uniq sr)
          (ugen x) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p &quot;server-auth&quot; z-0 4)
            (p &quot;server-auth&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;server-auth&quot; &quot;appid&quot; z-0 appid)
            (p &quot;server-auth&quot; &quot;server&quot; z-0 server))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 84)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k85">Item <a href="#t84">85</a>, Parent: <a href="#k84">84</a>, Children: <a href="#k86">86</a> <a href="#k87">87</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 85</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x rndx) (y x-0 expt) (y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y-0)
  (absent (y-0 x-0))
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
              sr-0))))))
  (label 85)
  (parent 84)
  (unrealized (0 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k86">Item <a href="#t84">86</a>, Parent: <a href="#k85">85</a>, Children: <a href="#k88">88</a> <a href="#k89">89</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 86</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))))
  (label 86)
  (parent 85)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k87">Item <a href="#t84">87</a>, Parent: <a href="#k85">85</a>, Children: <a href="#k90">90</a> <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 87</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))))
  (label 87)
  (parent 85)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k88">Item <a href="#t84">88</a>, Parent: <a href="#k86">86</a>, Children: <a href="#k92">92</a> <a href="#k93">93</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 88</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y-0)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))))
  (label 88)
  (parent 86)
  (unrealized (1 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k89">Item <a href="#t84">89</a>, Parent: <a href="#k86">86</a>, Child: <a href="#k94">94</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 89</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 89)
  (parent 86)
  (unrealized (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k90">Item <a href="#t84">90</a>, Parent: <a href="#k87">87</a>, Children: <a href="#k95">95</a> <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 90</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (displaced 2 3 server-auth 4)
    (enc appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 90)
  (parent 87)
  (unrealized (2 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k91">Item <a href="#t84">91</a>, Parent: <a href="#k87">87</a>, Child: <a href="#k97">97</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 91</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc appid challenge
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 91)
  (parent 87)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k92">Item <a href="#t84">92</a>, Parent: <a href="#k88">88</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 92</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (y x rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x)
  (absent (y x))
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))))
  (label 92)
  (parent 88)
  (realized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (x x) (y y))))
  (origs (sr (1 1)) (cr (0 0))))</pre>

<p id="k93">Item <a href="#t84">93</a>, Parent: <a href="#k88">88</a>, Child: <a href="#k98">98</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 93</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 93)
  (parent 88)
  (unrealized (1 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k94">Item <a href="#t84">94</a>, Parent: <a href="#k89">89</a>, Child: <a href="#k99">99</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 94</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
  (label 94)
  (parent 89)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k95">Item <a href="#t84">95</a>, Parent: <a href="#k90">90</a>, Seen Child: <a href="#k92">92</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 95</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y y-0 x-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y y-0 x-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;))))))
  (label 95)
  (parent 90)
  (seen 92)
  (realized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k96">Item <a href="#t84">96</a>, Parent: <a href="#k90">90</a>, Child: <a href="#k100">100</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 96</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 96)
  (parent 90)
  (unrealized (2 2) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k97">Item <a href="#t84">97</a>, Parent: <a href="#k91">91</a>, Child: <a href="#k101">101</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 97</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
  (label 97)
  (parent 91)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k98">Item <a href="#t84">98</a>, Parent: <a href="#k93">93</a>, Children: <a href="#k102">102</a> <a href="#k103">103</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 98</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))))
  (label 98)
  (parent 93)
  (unrealized (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k99">Item <a href="#t84">99</a>, Parent: <a href="#k94">94</a>, Children: <a href="#k104">104</a> <a href="#k105">105</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 99</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;))))
  (label 99)
  (parent 94)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k100">Item <a href="#t84">100</a>, Parent: <a href="#k96">96</a>, Children: <a href="#k106">106</a> <a href="#k107">107</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 100</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))))
  (label 100)
  (parent 96)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k101">Item <a href="#t84">101</a>, Parent: <a href="#k97">97</a>, Children: <a href="#k108">108</a> <a href="#k109">109</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 101</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
  (label 101)
  (parent 97)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k102">Item <a href="#t84">102</a>, Parent: <a href="#k98">98</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 102</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 102)
  (parent 98)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k103">Item <a href="#t84">103</a>, Parent: <a href="#k98">98</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 103</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (appid server ca name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 103)
  (parent 98)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k104">Item <a href="#t84">104</a>, Parent: <a href="#k99">99</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 104</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 104)
  (parent 99)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k105">Item <a href="#t84">105</a>, Parent: <a href="#k99">99</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 105</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr random32) (challenge text) (authk spk akey)
    (server ca appid name) (x y rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen x y)
  (absent (y x))
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x y)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x y)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 105)
  (parent 99)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k106">Item <a href="#t84">106</a>, Parent: <a href="#k100">100</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 106</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 106)
  (parent 100)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k107">Item <a href="#t84">107</a>, Parent: <a href="#k100">100</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 107</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (appid server ca name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 4 (cr cr) (sr sr) (challenge challenge)
    (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 107)
  (parent 100)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k108">Item <a href="#t84">108</a>, Parent: <a href="#k101">101</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 108</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 108)
  (parent 101)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k109">Item <a href="#t84">109</a>, Parent: <a href="#k101">101</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (spk spk) (server server) (ca ca) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (spk spk) (server server) (ca ca) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 109</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (cr sr cr-0 sr-0 random32) (challenge text) (authk spk akey)
    (server ca appid name) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (spk spk) (server server)
    (ca ca) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (spk spk) (server server)
    (ca ca) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig cr sr)
  (uniq-gen y x-0 y-0)
  (absent (y x) (y-0 x-0))
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))))
    ((recv
       (hash &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (hash &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv
       (cat &quot;s ap traffic&quot; cr sr
         (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
      (send
        (cat &quot;s ap traffic&quot; cr sr
          (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
      (send (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 109)
  (parent 101)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t110">Tree <a href="#top">110</a>, POV <a href="#k110">110</a>.</p>

<div>
 <svg
  class='diagram' width='179.760pt' height='154.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.760 154.920' font-size='12.000'>
  <text
   x='139.800' y='101.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k113&quot;, &quot;_self&quot;)'>113</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k112&quot;, &quot;_self&quot;)'>112</text>
  <line
   x1='89.880' y1='77.460' x2='139.800' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k111&quot;, &quot;_self&quot;)'>111</text>
  <line
   x1='39.960' y1='77.460' x2='89.880' y2='77.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='63.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k110&quot;, &quot;_self&quot;)'>110</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls13 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k110">Item <a href="#t110">110</a>, Child: <a href="#k111">111</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 110</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr random32) (challenge text) (authk spk akey)
    (server ca appid username auth name) (y rndx) (x expt))
  (defstrand server-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge)
  (uniq-gen y)
  (goals
    (forall
      ((sr random32) (challenge text) (authk spk akey)
        (server ca appid name) (y rndx) (z strd))
      (implies
        (and (p &quot;server-reg&quot; z 5) (p &quot;server-reg&quot; &quot;sr&quot; z sr)
          (p &quot;server-reg&quot; &quot;challenge&quot; z challenge)
          (p &quot;server-reg&quot; &quot;authk&quot; z authk) (p &quot;server-reg&quot; &quot;spk&quot; z spk)
          (p &quot;server-reg&quot; &quot;server&quot; z server)
          (p &quot;server-reg&quot; &quot;appid&quot; z appid) (p &quot;server-reg&quot; &quot;ca&quot; z ca)
          (p &quot;server-reg&quot; &quot;y&quot; z y) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen y) (uniq-at challenge z 3)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p &quot;client-reg&quot; z-0 5)
            (p &quot;client-reg&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;client-reg&quot; &quot;server&quot; z-0 server)
            (p &quot;client-reg&quot; &quot;appid&quot; z-0 appid))))))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))))
  (label 110)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k111">Item <a href="#t110">111</a>, Parent: <a href="#k110">110</a>, Children: <a href="#k112">112</a> <a href="#k113">113</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;)) (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (challenge challenge-0) (authk authk) (spk spk-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 111</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr cr-0 sr-0 random32) (challenge challenge-0 text)
    (authk spk spk-0 akey)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (y rndx) (x expt) (x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand client-reg 5 (cr cr-0) (sr sr-0) (challenge challenge-0)
    (authk authk) (spk spk-0) (username username) (auth auth-0)
    (server server-0) (ca ca-0) (appid appid-0) (x x-0) (y y-0))
  (precedes ((1 4) (0 4)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge)
  (uniq-gen y x-0)
  (operation encryption-test (added-strand client-reg 5)
    (hash &quot;key handle&quot; (invk authk) username) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;))
          (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;)
            (invk authk))
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 111)
  (parent 110)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k112">Item <a href="#t110">112</a>, Parent: <a href="#k111">111</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (challenge challenge) (authk authk) (spk spk-0) (username username) (auth auth) (server server-0) (ca ca-0) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 112</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr cr-0 sr-0 random32) (challenge text)
    (authk spk spk-0 akey)
    (server ca username auth server-0 ca-0 appid name) (y rndx) (x expt)
    (x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand client-reg 5 (cr cr-0) (sr sr-0) (challenge challenge)
    (authk authk) (spk spk-0) (username username) (auth auth)
    (server server-0) (ca ca-0) (appid appid) (x x-0) (y y-0))
  (precedes ((0 3) (1 3)) ((1 4) (0 4)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge)
  (uniq-gen y x-0)
  (operation encryption-test (displaced 2 1 client-reg 5)
    (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;) (invk authk))
    (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 112)
  (parent 111)
  (realized)
  (shape)
  (satisfies
    (no (p &quot;client-reg&quot; &quot;server&quot; z-0 server) (sr sr)
      (challenge challenge) (authk authk) (spk spk) (server server)
      (ca ca) (appid appid) (y y) (z 0)))
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (username username)
        (auth auth) (cr cr) (x x))))
  (origs (challenge (0 3)) (sr (0 1))))</pre>

<p id="k113">Item <a href="#t110">113</a>, Parent: <a href="#k111">111</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username-0) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username-0 appid challenge (hash &quot;s ap traffic&quot; cr-1 sr-1 (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-1)) (enc (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (enc (hash (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1)) server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;)) (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge &quot;unbound&quot;)) (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (challenge challenge) (authk authk) (spk spk-1) (username username-0) (auth auth) (server server-1) (ca ca-1) (appid appid) (x x-1) (y y-1))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (challenge challenge-0) (authk authk) (spk spk-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (username username) (auth auth) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 113</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr cr-0 sr-0 cr-1 sr-1 random32)
    (challenge challenge-0 text) (authk spk spk-0 spk-1 akey)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (y rndx) (x expt) (x-0 rndx)
    (y-0 expt) (x-1 rndx) (y-1 expt))
  (defstrand server-reg 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (username username) (auth auth)
    (server server) (ca ca) (appid appid) (x x) (y y))
  (defstrand client-reg 5 (cr cr-0) (sr sr-0) (challenge challenge-0)
    (authk authk) (spk spk-0) (username username) (auth auth-0)
    (server server-0) (ca ca-0) (appid appid-0) (x x-0) (y y-0))
  (defstrand client-reg 5 (cr cr-1) (sr sr-1) (challenge challenge)
    (authk authk) (spk spk-1) (username username-0) (auth auth)
    (server server-1) (ca ca-1) (appid appid) (x x-1) (y y-1))
  (precedes ((0 3) (2 3)) ((1 4) (0 4)) ((2 4) (0 4)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge)
  (uniq-gen y x-0 x-1)
  (operation encryption-test (added-strand client-reg 5)
    (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
    (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;))
          (enc auth-0 authk (hash appid-0 challenge-0 &quot;unbound&quot;)
            (invk authk))
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))))
    ((send (cat cr-1 (exp (gen) x-1)))
      (recv
        (cat (cat sr-1 (exp (gen) y-1))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1 sr-1))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1))
            (cat cr-1 (exp (gen) x-1)) (cat sr-1 (exp (gen) y-1))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-1 (exp (gen) x-1))
                (cat sr-1 (exp (gen) y-1)) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-1 y-1)) &quot;s hs traffic&quot; cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-1))
              (cat sr-1 (exp (gen) y-1))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-1 (exp (gen) x-1))
                  (cat sr-1 (exp (gen) y-1)) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-1 y-1)) &quot;c hs traffic&quot; cr-1 sr-1)))
      (recv
        (enc username-0 appid challenge
          (hash &quot;s ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username-0)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr-1 sr-1
            (hash (exp (gen) (mul x-1 y-1)) &quot;derived&quot;))))))
  (label 113)
  (parent 111)
  (realized)
  (shape)
  (satisfies
    (no (p &quot;client-reg&quot; &quot;challenge&quot; z-0 challenge) (sr sr)
      (challenge challenge) (authk authk) (spk spk) (server server)
      (ca ca) (appid appid) (y y) (z 0)))
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (username username)
        (auth auth) (cr cr) (x x))))
  (origs (challenge (0 3)) (sr (0 1))))</pre>

<p id="t114">Tree <a href="#top">114</a>, POV <a href="#k114">114</a>.</p>

<div>
 <svg
  class='diagram' width='129.840pt' height='79.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 129.840 79.920' font-size='12.000'>
  <text
   x='89.880' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k115&quot;, &quot;_self&quot;)'>115</text>
  <line
   x1='39.960' y1='39.960' x2='89.880' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='26.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k114&quot;, &quot;_self&quot;)'>114</text>
  </svg></div>

<pre>(defprotocol uaf-unbound-tls13 basic
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr random32) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk (hash appid challenge &quot;unbound&quot;))
          (enc auth authk (hash appid challenge &quot;unbound&quot;) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr random32)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y x)))
  (defgenrule neqRl_indx
    (forall ((x indx)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_strd
    (forall ((x strd)) (implies (fact neq x x) (false))))
  (defgenrule neqRl_mesg
    (forall ((x mesg)) (implies (fact neq x x) (false))))
  (lang (random32 atom) (random48 atom)))</pre>

<p id="k114">Item <a href="#t114">114</a>, Child: <a href="#k115">115</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 114</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr random32) (challenge text) (authk spk akey)
    (server ca appid name) (y rndx) (x expt))
  (defstrand server-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge)
  (uniq-gen y)
  (goals
    (forall
      ((sr random32) (challenge text) (authk spk akey)
        (server ca appid name) (y rndx) (z strd))
      (implies
        (and (p &quot;server-auth&quot; z 5) (p &quot;server-auth&quot; &quot;sr&quot; z sr)
          (p &quot;server-auth&quot; &quot;challenge&quot; z challenge)
          (p &quot;server-auth&quot; &quot;authk&quot; z authk)
          (p &quot;server-auth&quot; &quot;spk&quot; z spk)
          (p &quot;server-auth&quot; &quot;server&quot; z server)
          (p &quot;server-auth&quot; &quot;appid&quot; z appid) (p &quot;server-auth&quot; &quot;ca&quot; z ca)
          (p &quot;server-auth&quot; &quot;y&quot; z y) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen y) (uniq-at challenge z 3)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p &quot;client-auth&quot; z-0 5)
            (p &quot;client-auth&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;client-auth&quot; &quot;server&quot; z-0 server)
            (p &quot;client-auth&quot; &quot;appid&quot; z-0 appid))))))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))))
  (label 114)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k115">Item <a href="#t114">115</a>, Parent: <a href="#k114">114</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash appid &quot;unbound&quot; challenge) (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (challenge challenge) (authk authk) (spk spk-0) (server server-0) (ca ca-0) (appid appid) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-unbound-tls13 115</text></svg></div>

<pre>(defskeleton uaf-unbound-tls13
  (vars (sr cr cr-0 sr-0 random32) (challenge text)
    (authk spk spk-0 akey) (server ca appid server-0 ca-0 name) (y rndx)
    (x expt) (x-0 rndx) (y-0 expt))
  (defstrand server-auth 5 (cr cr) (sr sr) (challenge challenge)
    (authk authk) (spk spk) (server server) (ca ca) (appid appid) (x x)
    (y y))
  (defstrand client-auth 5 (cr cr-0) (sr sr-0) (challenge challenge)
    (authk authk) (spk spk-0) (server server-0) (ca ca-0) (appid appid)
    (x x-0) (y y-0))
  (precedes ((0 3) (1 3)) ((1 4) (0 4)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-orig sr challenge)
  (uniq-gen y x-0)
  (operation encryption-test (added-strand client-auth 5)
    (enc (hash appid &quot;unbound&quot; challenge) (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;))))
      (recv
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul y x)) &quot;derived&quot;)))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)))
      (recv
        (enc appid challenge
          (hash &quot;s ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))
      (send
        (enc (hash appid &quot;unbound&quot; challenge)
          (enc (hash appid &quot;unbound&quot; challenge) (invk authk))
          (hash &quot;c ap traffic&quot; cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))))))
  (label 115)
  (parent 114)
  (realized)
  (shape)
  (satisfies
    (no (p &quot;client-auth&quot; &quot;server&quot; z-0 server) (sr sr)
      (challenge challenge) (authk authk) (spk spk) (server server)
      (ca ca) (appid appid) (y y) (z 0)))
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (cr cr) (x x))))
  (origs (challenge (0 3)) (sr (0 1))))</pre>

</body>
</html>
