<?xml version="1.0"?>
<!-- CPSA 3.6.11 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>UAF using TLS1.3 with dual (server/client) exporter binding.</title>
 <meta http-equiv="content-type" content="application/xhtml+xml; charset=UTF-8" />
 <style>
  svg.diagram { border-width: 1px; border-style: solid }
 </style>
</head>
<body>

<pre>(herald &quot;UAF using TLS1.3 with dual (server/client) exporter binding.&quot;
  (algebra diffie-hellman))
(comment &quot;CPSA 3.6.11&quot;)
(comment &quot;All input read from uaf-dualbinding-tls13.scm&quot;)</pre>

<p id="top">Trees: <a href="#t0">0</a> <a href="#t26">26</a> <a href="#t52">52</a> <a href="#t140">140</a>.</p>

<p id="t0">Tree <a href="#top">0</a>, POV <a href="#k0">0</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 754.920' font-size='12.000'>
  <text
   x='339.480' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k25&quot;, &quot;_self&quot;)'>25</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k24&quot;, &quot;_self&quot;)'>24</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k17&quot;, &quot;_self&quot;)'>17</text>
  <line
   x1='239.640' y1='677.460' x2='289.560' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k13&quot;, &quot;_self&quot;)'>13</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k7&quot;, &quot;_self&quot;)'>7</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k23&quot;, &quot;_self&quot;)'>23</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k22&quot;, &quot;_self&quot;)'>22</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k16&quot;, &quot;_self&quot;)'>16</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k12&quot;, &quot;_self&quot;)'>12</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='239.640' y1='414.960' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='401.040' style='text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k11&quot;, &quot;_self&quot;)'>11</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k6&quot;, &quot;_self&quot;)'>6</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k3&quot;, &quot;_self&quot;)'>3</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k21&quot;, &quot;_self&quot;)'>21</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k20&quot;, &quot;_self&quot;)'>20</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k15&quot;, &quot;_self&quot;)'>15</text>
  <line
   x1='239.640' y1='302.460' x2='289.560' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k10&quot;, &quot;_self&quot;)'>10</text>
  <line
   x1='189.720' y1='302.460' x2='239.640' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k5&quot;, &quot;_self&quot;)'>5</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k19&quot;, &quot;_self&quot;)'>19</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k18&quot;, &quot;_self&quot;)'>18</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k14&quot;, &quot;_self&quot;)'>14</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k9&quot;, &quot;_self&quot;)'>9</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k8&quot;, &quot;_self&quot;)'>8</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k4&quot;, &quot;_self&quot;)'>4</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k2&quot;, &quot;_self&quot;)'>2</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k1&quot;, &quot;_self&quot;)'>1</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k0&quot;, &quot;_self&quot;)'>0</text>
  </svg></div>

<pre>(defprotocol uaf-dualbinding-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr username appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr username appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))</pre>

<p id="k0">Item <a href="#t0">0</a>, Child: <a href="#k1">1</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 0</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x rndx)
    (y expt))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x)
  (uniq-orig cr)
  (goals
    (forall
      ((cr sr data) (challenge text) (authk spk akey)
        (server ca appid name) (x rndx) (z strd))
      (implies
        (and (p &quot;client-reg&quot; z 5) (p &quot;client-reg&quot; &quot;cr&quot; z cr)
          (p &quot;client-reg&quot; &quot;sr&quot; z sr)
          (p &quot;client-reg&quot; &quot;challenge&quot; z challenge)
          (p &quot;client-reg&quot; &quot;authk&quot; z authk) (p &quot;client-reg&quot; &quot;spk&quot; z spk)
          (p &quot;client-reg&quot; &quot;appid&quot; z appid)
          (p &quot;client-reg&quot; &quot;server&quot; z server) (p &quot;client-reg&quot; &quot;ca&quot; z ca)
          (p &quot;client-reg&quot; &quot;x&quot; z x) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen x) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p &quot;server-reg&quot; z-0 4)
            (p &quot;server-reg&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;server-reg&quot; &quot;appid&quot; z-0 appid)
            (p &quot;server-reg&quot; &quot;server&quot; z-0 server))))))
  (label 0)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k1">Item <a href="#t0">1</a>, Parent: <a href="#k0">0</a>, Children: <a href="#k2">2</a> <a href="#k3">3</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 1</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x rndx)
    (y x-0 expt) (y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (label 1)
  (parent 0)
  (unrealized (0 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k2">Item <a href="#t0">2</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k4">4</a> <a href="#k5">5</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 2</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (label 2)
  (parent 1)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k3">Item <a href="#t0">3</a>, Parent: <a href="#k1">1</a>, Children: <a href="#k6">6</a> <a href="#k7">7</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 3</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (label 3)
  (parent 1)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k4">Item <a href="#t0">4</a>, Parent: <a href="#k2">2</a>, Children: <a href="#k8">8</a> <a href="#k9">9</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 4</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 1 2 server-reg 4)
    (enc username appid challenge
      (hash (hash (exp (gen) (mul x y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr
        sr username appid challenge server)
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y-0)) &quot;derived&quot;))) (0 3))
  (label 4)
  (parent 2)
  (unrealized (1 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k5">Item <a href="#t0">5</a>, Parent: <a href="#k2">2</a>, Child: <a href="#k10">10</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 5</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc username appid challenge
      (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr
        username appid challenge server)
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (0 3))
  (label 5)
  (parent 2)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k6">Item <a href="#t0">6</a>, Parent: <a href="#k3">3</a>, Children: <a href="#k11">11</a> <a href="#k12">12</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 6</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 3 server-reg 4)
    (enc username appid challenge
      (hash (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr
        sr username appid challenge server)
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;))) (0 3))
  (label 6)
  (parent 3)
  (unrealized (2 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k7">Item <a href="#t0">7</a>, Parent: <a href="#k3">3</a>, Child: <a href="#k13">13</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 7</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc username appid challenge
      (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr
        sr username appid challenge server)
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (0 3))
  (label 7)
  (parent 3)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k8">Item <a href="#t0">8</a>, Parent: <a href="#k4">4</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 8 (realized)</text>
  </svg></div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (y x rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (label 8)
  (parent 4)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (x x) (username username)
        (auth auth) (y y))))
  (origs (cr (0 0))))</pre>

<p id="k9">Item <a href="#t0">9</a>, Parent: <a href="#k4">4</a>, Child: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 9</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (label 9)
  (parent 4)
  (unrealized (1 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k10">Item <a href="#t0">10</a>, Parent: <a href="#k5">5</a>, Child: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 10</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (label 10)
  (parent 5)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k11">Item <a href="#t0">11</a>, Parent: <a href="#k6">6</a>, Seen Child: <a href="#k8">8</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 11 (realized)</text>
  </svg></div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y y-0 x-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y y-0 x-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (label 11)
  (parent 6)
  (seen 8)
  (unrealized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k12">Item <a href="#t0">12</a>, Parent: <a href="#k6">6</a>, Child: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 12</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (label 12)
  (parent 6)
  (unrealized (2 2) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k13">Item <a href="#t0">13</a>, Parent: <a href="#k7">7</a>, Child: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 13</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (label 13)
  (parent 7)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k14">Item <a href="#t0">14</a>, Parent: <a href="#k9">9</a>, Children: <a href="#k18">18</a> <a href="#k19">19</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 14</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (label 14)
  (parent 9)
  (unrealized (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k15">Item <a href="#t0">15</a>, Parent: <a href="#k10">10</a>, Children: <a href="#k20">20</a> <a href="#k21">21</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 15</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (label 15)
  (parent 10)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k16">Item <a href="#t0">16</a>, Parent: <a href="#k12">12</a>, Children: <a href="#k22">22</a> <a href="#k23">23</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 16</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr) (3 0))
  (label 16)
  (parent 12)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k17">Item <a href="#t0">17</a>, Parent: <a href="#k13">13</a>, Children: <a href="#k24">24</a> <a href="#k25">25</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 17</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (label 17)
  (parent 13)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k18">Item <a href="#t0">18</a>, Parent: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 18</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (label 18)
  (parent 14)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k19">Item <a href="#t0">19</a>, Parent: <a href="#k14">14</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 19</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (label 19)
  (parent 14)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k20">Item <a href="#t0">20</a>, Parent: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 20</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (label 20)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k21">Item <a href="#t0">21</a>, Parent: <a href="#k15">15</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 21</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (label 21)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k22">Item <a href="#t0">22</a>, Parent: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 22</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (label 22)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k23">Item <a href="#t0">23</a>, Parent: <a href="#k16">16</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-reg</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 23</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (label 23)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k24">Item <a href="#t0">24</a>, Parent: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 24</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (label 24)
  (parent 17)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k25">Item <a href="#t0">25</a>, Parent: <a href="#k17">17</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>client-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 25</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (label 25)
  (parent 17)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t26">Tree <a href="#top">26</a>, POV <a href="#k26">26</a>.</p>

<div>
 <svg
  class='diagram' width='379.440pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.440 754.920' font-size='12.000'>
  <text
   x='339.480' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k51&quot;, &quot;_self&quot;)'>51</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k50&quot;, &quot;_self&quot;)'>50</text>
  <line
   x1='289.560' y1='677.460' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k43&quot;, &quot;_self&quot;)'>43</text>
  <line
   x1='239.640' y1='677.460' x2='289.560' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k39&quot;, &quot;_self&quot;)'>39</text>
  <line
   x1='189.720' y1='677.460' x2='239.640' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='663.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k33&quot;, &quot;_self&quot;)'>33</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k49&quot;, &quot;_self&quot;)'>49</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k48&quot;, &quot;_self&quot;)'>48</text>
  <line
   x1='289.560' y1='527.460' x2='339.480' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k42&quot;, &quot;_self&quot;)'>42</text>
  <line
   x1='239.640' y1='527.460' x2='289.560' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='513.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k38&quot;, &quot;_self&quot;)'>38</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='527.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='239.640' y1='414.960' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='401.040' style='text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k37&quot;, &quot;_self&quot;)'>37</text>
  <line
   x1='189.720' y1='489.960' x2='239.640' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='476.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k32&quot;, &quot;_self&quot;)'>32</text>
  <line
   x1='139.800' y1='564.960' x2='189.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='551.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k29&quot;, &quot;_self&quot;)'>29</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k47&quot;, &quot;_self&quot;)'>47</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k46&quot;, &quot;_self&quot;)'>46</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k41&quot;, &quot;_self&quot;)'>41</text>
  <line
   x1='239.640' y1='302.460' x2='289.560' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k36&quot;, &quot;_self&quot;)'>36</text>
  <line
   x1='189.720' y1='302.460' x2='239.640' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k31&quot;, &quot;_self&quot;)'>31</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k45&quot;, &quot;_self&quot;)'>45</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k44&quot;, &quot;_self&quot;)'>44</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k40&quot;, &quot;_self&quot;)'>40</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k35&quot;, &quot;_self&quot;)'>35</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k34&quot;, &quot;_self&quot;)'>34</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k30&quot;, &quot;_self&quot;)'>30</text>
  <line
   x1='139.800' y1='189.960' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='176.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k28&quot;, &quot;_self&quot;)'>28</text>
  <line
   x1='89.880' y1='377.460' x2='139.800' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k27&quot;, &quot;_self&quot;)'>27</text>
  <line
   x1='39.960' y1='377.460' x2='89.880' y2='377.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='363.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k26&quot;, &quot;_self&quot;)'>26</text>
  </svg></div>

<pre>(defprotocol uaf-dualbinding-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr username appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr username appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))</pre>

<p id="k26">Item <a href="#t26">26</a>, Child: <a href="#k27">27</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 26</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x rndx) (y expt))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x)
  (uniq-orig cr)
  (goals
    (forall
      ((cr sr data) (challenge text) (authk spk akey)
        (server ca appid name) (x rndx) (z strd))
      (implies
        (and (p &quot;client-auth&quot; z 5) (p &quot;client-auth&quot; &quot;cr&quot; z cr)
          (p &quot;client-auth&quot; &quot;sr&quot; z sr)
          (p &quot;client-auth&quot; &quot;challenge&quot; z challenge)
          (p &quot;client-auth&quot; &quot;authk&quot; z authk)
          (p &quot;client-auth&quot; &quot;spk&quot; z spk)
          (p &quot;client-auth&quot; &quot;appid&quot; z appid)
          (p &quot;client-auth&quot; &quot;server&quot; z server)
          (p &quot;client-auth&quot; &quot;ca&quot; z ca) (p &quot;client-auth&quot; &quot;x&quot; z x)
          (non (invk authk)) (non (invk spk)) (non (privk ca)) (ugen x)
          (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p &quot;server-auth&quot; z-0 4)
            (p &quot;server-auth&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;server-auth&quot; &quot;appid&quot; z-0 appid)
            (p &quot;server-auth&quot; &quot;server&quot; z-0 server))))))
  (label 26)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k27">Item <a href="#t26">27</a>, Parent: <a href="#k26">26</a>, Children: <a href="#k28">28</a> <a href="#k29">29</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 27</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x rndx) (y x-0 expt)
    (y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (label 27)
  (parent 26)
  (unrealized (0 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k28">Item <a href="#t26">28</a>, Parent: <a href="#k27">27</a>, Children: <a href="#k30">30</a> <a href="#k31">31</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 28</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (label 28)
  (parent 27)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k29">Item <a href="#t26">29</a>, Parent: <a href="#k27">27</a>, Children: <a href="#k32">32</a> <a href="#k33">33</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 29</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (label 29)
  (parent 27)
  (unrealized (0 3))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k30">Item <a href="#t26">30</a>, Parent: <a href="#k28">28</a>, Children: <a href="#k34">34</a> <a href="#k35">35</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 30</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc appid challenge
      (hash (hash (exp (gen) (mul x y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr
        sr appid challenge server)
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y-0)) &quot;derived&quot;))) (0 3))
  (label 30)
  (parent 28)
  (unrealized (1 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k31">Item <a href="#t26">31</a>, Parent: <a href="#k28">28</a>, Child: <a href="#k36">36</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.729 263.906 45.578 337.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 31</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (enc appid challenge
      (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr
        appid challenge server)
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x y)) &quot;derived&quot;))) (0 3))
  (label 31)
  (parent 28)
  (unrealized (0 3) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k32">Item <a href="#t26">32</a>, Parent: <a href="#k29">29</a>, Children: <a href="#k37">37</a> <a href="#k38">38</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 32</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 3 server-auth 4)
    (enc appid challenge
      (hash (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr
        sr appid challenge server)
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;))) (0 3))
  (label 32)
  (parent 29)
  (unrealized (2 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k33">Item <a href="#t26">33</a>, Parent: <a href="#k29">29</a>, Child: <a href="#k39">39</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.810 264.232 45.781 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 33</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (enc appid challenge
      (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr
        sr appid challenge server)
      (hash &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))) (0 3))
  (label 33)
  (parent 29)
  (unrealized (0 3) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k34">Item <a href="#t26">34</a>, Parent: <a href="#k30">30</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 86.940 264.960 133.920 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 34 (realized)</text>
  </svg></div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (y x rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (label 34)
  (parent 30)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (x x) (auth auth) (y y))))
  (origs (cr (0 0))))</pre>

<p id="k35">Item <a href="#t26">35</a>, Parent: <a href="#k30">30</a>, Child: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 339.960 Q 92.940 339.960 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 186.900 189.960 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 35</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (1 2))
  (label 35)
  (parent 30)
  (unrealized (1 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k36">Item <a href="#t26">36</a>, Parent: <a href="#k31">31</a>, Child: <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 36</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))
    (2 0))
  (label 36)
  (parent 31)
  (unrealized (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k37">Item <a href="#t26">37</a>, Parent: <a href="#k32">32</a>, Seen Child: <a href="#k34">34</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 136.920 227.460 233.880 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 37 (realized)</text>
  </svg></div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y y-0 x-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y y-0 x-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (label 37)
  (parent 32)
  (seen 34)
  (unrealized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k38">Item <a href="#t26">38</a>, Parent: <a href="#k32">32</a>, Child: <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 286.860 189.960 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 38</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (2 2))
  (label 38)
  (parent 32)
  (unrealized (2 2) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k39">Item <a href="#t26">39</a>, Parent: <a href="#k33">33</a>, Child: <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 39</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat &quot;s ap traffic&quot; cr sr
        (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)) (3 0))
  (label 39)
  (parent 33)
  (unrealized (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k40">Item <a href="#t26">40</a>, Parent: <a href="#k35">35</a>, Children: <a href="#k44">44</a> <a href="#k45">45</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 236.880 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 40</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (label 40)
  (parent 35)
  (unrealized (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k41">Item <a href="#t26">41</a>, Parent: <a href="#k36">36</a>, Children: <a href="#k46">46</a> <a href="#k47">47</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 41</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
    (hash (exp (gen) (mul x y)) &quot;derived&quot;) (3 0))
  (label 41)
  (parent 36)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k42">Item <a href="#t26">42</a>, Parent: <a href="#k38">38</a>, Children: <a href="#k48">48</a> <a href="#k49">49</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 336.840 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 42</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr) (3 0))
  (label 42)
  (parent 38)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k43">Item <a href="#t26">43</a>, Parent: <a href="#k39">39</a>, Children: <a href="#k50">50</a> <a href="#k51">51</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.729 188.906 45.578 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.340 225.660 44.759 261.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 43</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
    (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) (4 0))
  (label 43)
  (parent 39)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k44">Item <a href="#t26">44</a>, Parent: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 44</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (label 44)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k45">Item <a href="#t26">45</a>, Parent: <a href="#k40">40</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 286.860 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 45</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (label 45)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k46">Item <a href="#t26">46</a>, Parent: <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 46</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (label 46)
  (parent 41)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k47">Item <a href="#t26">47</a>, Parent: <a href="#k41">41</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 189.960 Q 336.840 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 86.940 114.960 133.920 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 47</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x y)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (label 47)
  (parent 41)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k48">Item <a href="#t26">48</a>, Parent: <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 48</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (label 48)
  (parent 42)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k49">Item <a href="#t26">49</a>, Parent: <a href="#k42">42</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 386.820 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 49</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (label 49)
  (parent 42)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k50">Item <a href="#t26">50</a>, Parent: <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 50</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (label 50)
  (parent 43)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k51">Item <a href="#t26">51</a>, Parent: <a href="#k43">43</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 192.900 452.460 45.960 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.320 225.660 44.759 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 189.960 Q 436.800 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 91.604 262.464 43.287 334.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 114.960 Q 136.920 77.460 233.880 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((cr cr) (sr sr) (server server) (ca ca) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server) (ca ca) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 51</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener
    (cat &quot;s ap traffic&quot; cr sr
      (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;derived&quot;))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (label 51)
  (parent 43)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t52">Tree <a href="#top">52</a>, POV <a href="#k52">52</a>.</p>

<div>
 <svg
  class='diagram' width='629.040pt' height='2854.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 629.040 2854.920' font-size='12.000'>
  <text
   x='389.400' y='2801.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k105&quot;, &quot;_self&quot;)'>105</text>
  <line
   x1='339.480' y1='2814.960' x2='389.400' y2='2814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='2801.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k88&quot;, &quot;_self&quot;)'>88</text>
  <line
   x1='289.560' y1='2289.960' x2='339.480' y2='2814.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2726.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k135&quot;, &quot;_self&quot;)'>135</text>
  <line
   x1='489.240' y1='2739.960' x2='539.160' y2='2739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2726.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k120&quot;, &quot;_self&quot;)'>120</text>
  <line
   x1='439.320' y1='2477.460' x2='489.240' y2='2739.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2651.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k134&quot;, &quot;_self&quot;)'>134</text>
  <line
   x1='489.240' y1='2589.960' x2='539.160' y2='2664.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='2576.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k139&quot;, &quot;_self&quot;)'>139</text>
  <line
   x1='539.160' y1='2589.960' x2='589.080' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2576.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k133&quot;, &quot;_self&quot;)'>133</text>
  <line
   x1='489.240' y1='2589.960' x2='539.160' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='2501.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k138&quot;, &quot;_self&quot;)'>138</text>
  <line
   x1='539.160' y1='2514.960' x2='589.080' y2='2514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2501.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k132&quot;, &quot;_self&quot;)'>132</text>
  <line
   x1='489.240' y1='2589.960' x2='539.160' y2='2514.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2576.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k119&quot;, &quot;_self&quot;)'>119</text>
  <line
   x1='439.320' y1='2477.460' x2='489.240' y2='2589.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2426.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k131&quot;, &quot;_self&quot;)'>131</text>
  <line
   x1='489.240' y1='2439.960' x2='539.160' y2='2439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2426.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k118&quot;, &quot;_self&quot;)'>118</text>
  <line
   x1='439.320' y1='2477.460' x2='489.240' y2='2439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2351.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k130&quot;, &quot;_self&quot;)'>130</text>
  <line
   x1='489.240' y1='2364.960' x2='539.160' y2='2364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2351.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k117&quot;, &quot;_self&quot;)'>117</text>
  <line
   x1='439.320' y1='2477.460' x2='489.240' y2='2364.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2276.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k129&quot;, &quot;_self&quot;)'>129</text>
  <line
   x1='489.240' y1='2289.960' x2='539.160' y2='2289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2276.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k116&quot;, &quot;_self&quot;)'>116</text>
  <line
   x1='439.320' y1='2477.460' x2='489.240' y2='2289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='2201.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k128&quot;, &quot;_self&quot;)'>128</text>
  <line
   x1='489.240' y1='2214.960' x2='539.160' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='2201.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k115&quot;, &quot;_self&quot;)'>115</text>
  <line
   x1='439.320' y1='2477.460' x2='489.240' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='2463.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k109&quot;, &quot;_self&quot;)'>109</text>
  <line
   x1='389.400' y1='2439.960' x2='439.320' y2='2477.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='2126.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k108&quot;, &quot;_self&quot;)'>108</text>
  <line
   x1='389.400' y1='2439.960' x2='439.320' y2='2139.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='2426.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k104&quot;, &quot;_self&quot;)'>104</text>
  <line
   x1='339.480' y1='2402.460' x2='389.400' y2='2439.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='2051.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k103&quot;, &quot;_self&quot;)'>103</text>
  <line
   x1='339.480' y1='2402.460' x2='389.400' y2='2064.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='2388.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k87&quot;, &quot;_self&quot;)'>87</text>
  <line
   x1='289.560' y1='2289.960' x2='339.480' y2='2402.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1976.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k102&quot;, &quot;_self&quot;)'>102</text>
  <line
   x1='339.480' y1='1989.960' x2='389.400' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1976.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k86&quot;, &quot;_self&quot;)'>86</text>
  <line
   x1='289.560' y1='2289.960' x2='339.480' y2='1989.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1901.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k101&quot;, &quot;_self&quot;)'>101</text>
  <line
   x1='339.480' y1='1914.960' x2='389.400' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1901.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k85&quot;, &quot;_self&quot;)'>85</text>
  <line
   x1='289.560' y1='2289.960' x2='339.480' y2='1914.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1826.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k100&quot;, &quot;_self&quot;)'>100</text>
  <line
   x1='339.480' y1='1839.960' x2='389.400' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1826.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k84&quot;, &quot;_self&quot;)'>84</text>
  <line
   x1='289.560' y1='2289.960' x2='339.480' y2='1839.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1751.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k99&quot;, &quot;_self&quot;)'>99</text>
  <line
   x1='339.480' y1='1764.960' x2='389.400' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1751.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k83&quot;, &quot;_self&quot;)'>83</text>
  <line
   x1='289.560' y1='2289.960' x2='339.480' y2='1764.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='2276.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k71&quot;, &quot;_self&quot;)'>71</text>
  <line
   x1='239.640' y1='2214.960' x2='289.560' y2='2289.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1676.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k98&quot;, &quot;_self&quot;)'>98</text>
  <line
   x1='339.480' y1='1652.460' x2='389.400' y2='1689.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1601.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k97&quot;, &quot;_self&quot;)'>97</text>
  <line
   x1='339.480' y1='1652.460' x2='389.400' y2='1614.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1638.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k82&quot;, &quot;_self&quot;)'>82</text>
  <line
   x1='289.560' y1='1652.460' x2='339.480' y2='1652.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1638.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k70&quot;, &quot;_self&quot;)'>70</text>
  <line
   x1='239.640' y1='2214.960' x2='289.560' y2='1652.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='2201.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k65&quot;, &quot;_self&quot;)'>65</text>
  <line
   x1='189.720' y1='2214.960' x2='239.640' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='2201.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k59&quot;, &quot;_self&quot;)'>59</text>
  <line
   x1='139.800' y1='2102.460' x2='189.720' y2='2214.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1526.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k81&quot;, &quot;_self&quot;)'>81</text>
  <line
   x1='289.560' y1='1502.460' x2='339.480' y2='1539.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1451.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k80&quot;, &quot;_self&quot;)'>80</text>
  <line
   x1='289.560' y1='1502.460' x2='339.480' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1488.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k69&quot;, &quot;_self&quot;)'>69</text>
  <line
   x1='239.640' y1='1502.460' x2='289.560' y2='1502.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1488.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k64&quot;, &quot;_self&quot;)'>64</text>
  <line
   x1='189.720' y1='1464.960' x2='239.640' y2='1502.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1376.040'
   style='font-style: italic; text-anchor: middle; fill: green;'
   onclick='window.open(&quot;#k60&quot;, &quot;_self&quot;)'>60</text>
  <line
   x1='239.640' y1='1389.960' x2='289.560' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='1376.040' style='text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k63&quot;, &quot;_self&quot;)'>63</text>
  <line
   x1='189.720' y1='1464.960' x2='239.640' y2='1389.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='1451.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k58&quot;, &quot;_self&quot;)'>58</text>
  <line
   x1='139.800' y1='2102.460' x2='189.720' y2='1464.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='2088.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k55&quot;, &quot;_self&quot;)'>55</text>
  <line
   x1='89.880' y1='1427.460' x2='139.800' y2='2102.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k96&quot;, &quot;_self&quot;)'>96</text>
  <line
   x1='339.480' y1='1314.960' x2='389.400' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k79&quot;, &quot;_self&quot;)'>79</text>
  <line
   x1='289.560' y1='864.960' x2='339.480' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k127&quot;, &quot;_self&quot;)'>127</text>
  <line
   x1='489.240' y1='1239.960' x2='539.160' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k114&quot;, &quot;_self&quot;)'>114</text>
  <line
   x1='439.320' y1='1014.960' x2='489.240' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1151.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k126&quot;, &quot;_self&quot;)'>126</text>
  <line
   x1='489.240' y1='1089.960' x2='539.160' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k137&quot;, &quot;_self&quot;)'>137</text>
  <line
   x1='539.160' y1='1089.960' x2='589.080' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k125&quot;, &quot;_self&quot;)'>125</text>
  <line
   x1='489.240' y1='1089.960' x2='539.160' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='589.080' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k136&quot;, &quot;_self&quot;)'>136</text>
  <line
   x1='539.160' y1='1014.960' x2='589.080' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k124&quot;, &quot;_self&quot;)'>124</text>
  <line
   x1='489.240' y1='1089.960' x2='539.160' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k113&quot;, &quot;_self&quot;)'>113</text>
  <line
   x1='439.320' y1='1014.960' x2='489.240' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k123&quot;, &quot;_self&quot;)'>123</text>
  <line
   x1='489.240' y1='939.960' x2='539.160' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k112&quot;, &quot;_self&quot;)'>112</text>
  <line
   x1='439.320' y1='1014.960' x2='489.240' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k122&quot;, &quot;_self&quot;)'>122</text>
  <line
   x1='489.240' y1='864.960' x2='539.160' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k111&quot;, &quot;_self&quot;)'>111</text>
  <line
   x1='439.320' y1='1014.960' x2='489.240' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k121&quot;, &quot;_self&quot;)'>121</text>
  <line
   x1='489.240' y1='789.960' x2='539.160' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k110&quot;, &quot;_self&quot;)'>110</text>
  <line
   x1='439.320' y1='1014.960' x2='489.240' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k107&quot;, &quot;_self&quot;)'>107</text>
  <line
   x1='389.400' y1='977.460' x2='439.320' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k106&quot;, &quot;_self&quot;)'>106</text>
  <line
   x1='389.400' y1='977.460' x2='439.320' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k95&quot;, &quot;_self&quot;)'>95</text>
  <line
   x1='339.480' y1='939.960' x2='389.400' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k94&quot;, &quot;_self&quot;)'>94</text>
  <line
   x1='339.480' y1='939.960' x2='389.400' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k78&quot;, &quot;_self&quot;)'>78</text>
  <line
   x1='289.560' y1='864.960' x2='339.480' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k93&quot;, &quot;_self&quot;)'>93</text>
  <line
   x1='339.480' y1='564.960' x2='389.400' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k77&quot;, &quot;_self&quot;)'>77</text>
  <line
   x1='289.560' y1='864.960' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k92&quot;, &quot;_self&quot;)'>92</text>
  <line
   x1='339.480' y1='489.960' x2='389.400' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k76&quot;, &quot;_self&quot;)'>76</text>
  <line
   x1='289.560' y1='864.960' x2='339.480' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k91&quot;, &quot;_self&quot;)'>91</text>
  <line
   x1='339.480' y1='414.960' x2='389.400' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k75&quot;, &quot;_self&quot;)'>75</text>
  <line
   x1='289.560' y1='864.960' x2='339.480' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k68&quot;, &quot;_self&quot;)'>68</text>
  <line
   x1='239.640' y1='789.960' x2='289.560' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k90&quot;, &quot;_self&quot;)'>90</text>
  <line
   x1='339.480' y1='302.460' x2='389.400' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k89&quot;, &quot;_self&quot;)'>89</text>
  <line
   x1='339.480' y1='302.460' x2='389.400' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k74&quot;, &quot;_self&quot;)'>74</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k67&quot;, &quot;_self&quot;)'>67</text>
  <line
   x1='239.640' y1='789.960' x2='289.560' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k62&quot;, &quot;_self&quot;)'>62</text>
  <line
   x1='189.720' y1='789.960' x2='239.640' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k57&quot;, &quot;_self&quot;)'>57</text>
  <line
   x1='139.800' y1='677.460' x2='189.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k73&quot;, &quot;_self&quot;)'>73</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k72&quot;, &quot;_self&quot;)'>72</text>
  <line
   x1='289.560' y1='152.460' x2='339.480' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k66&quot;, &quot;_self&quot;)'>66</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k61&quot;, &quot;_self&quot;)'>61</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k60&quot;, &quot;_self&quot;)'>60</text>
  <line
   x1='189.720' y1='114.960' x2='239.640' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k56&quot;, &quot;_self&quot;)'>56</text>
  <line
   x1='139.800' y1='677.460' x2='189.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='663.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k54&quot;, &quot;_self&quot;)'>54</text>
  <line
   x1='89.880' y1='1427.460' x2='139.800' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='1413.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k53&quot;, &quot;_self&quot;)'>53</text>
  <line
   x1='39.960' y1='1427.460' x2='89.880' y2='1427.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='1413.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k52&quot;, &quot;_self&quot;)'>52</text>
  </svg></div>

<pre>(defprotocol uaf-dualbinding-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr username appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr username appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))</pre>

<p id="k52">Item <a href="#t52">52</a>, Child: <a href="#k53">53</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 52</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid username auth name) (authk spk akey) (y rndx)
    (x expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y)
  (uniq-orig challenge sr)
  (goals
    (forall
      ((sr data) (challenge text) (authk spk akey)
        (server ca appid name) (y rndx) (z strd))
      (implies
        (and (p &quot;server-reg&quot; z 5) (p &quot;server-reg&quot; &quot;sr&quot; z sr)
          (p &quot;server-reg&quot; &quot;challenge&quot; z challenge)
          (p &quot;server-reg&quot; &quot;authk&quot; z authk) (p &quot;server-reg&quot; &quot;spk&quot; z spk)
          (p &quot;server-reg&quot; &quot;server&quot; z server)
          (p &quot;server-reg&quot; &quot;appid&quot; z appid) (p &quot;server-reg&quot; &quot;ca&quot; z ca)
          (p &quot;server-reg&quot; &quot;y&quot; z y) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen y) (uniq-at challenge z 3)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p &quot;client-reg&quot; z-0 5)
            (p &quot;client-reg&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;client-reg&quot; &quot;server&quot; z-0 server)
            (p &quot;client-reg&quot; &quot;appid&quot; z-0 appid))))))
  (label 52)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k53">Item <a href="#t52">53</a>, Parent: <a href="#k52">52</a>, Children: <a href="#k54">54</a> <a href="#k55">55</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y-0)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y-0))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 53</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (y rndx) (x expt) (x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y-0))
  (precedes ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-reg 5)
    (hash &quot;key handle&quot; (invk authk) username) (0 4))
  (label 53)
  (parent 52)
  (unrealized (0 4))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k54">Item <a href="#t52">54</a>, Parent: <a href="#k53">53</a>, Children: <a href="#k56">56</a> <a href="#k57">57</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 54</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-reg 5)
    (enc auth-0 authk
      (hash appid-0 challenge-0
        (hash (hash (exp (gen) (mul x-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot;
          cr-0 sr-0 username appid-0 challenge-0 server-0))
      (invk authk)) (0 4))
  (label 54)
  (parent 53)
  (unrealized (0 2) (1 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k55">Item <a href="#t52">55</a>, Parent: <a href="#k53">53</a>, Children: <a href="#k58">58</a> <a href="#k59">59</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y-0 y-1))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-1)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 y-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 55</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-reg 5)
    (enc auth authk
      (hash appid challenge
        (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)
          &quot;dual-binding&quot; cr sr username appid challenge server))
      (invk authk)) (0 4))
  (label 55)
  (parent 53)
  (unrealized (0 2) (2 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k56">Item <a href="#t52">56</a>, Parent: <a href="#k54">54</a>, Children: <a href="#k60">60</a> <a href="#k61">61</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 56</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server
          spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y-0)) &quot;s hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0))
        (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server
            spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x y-0)) &quot;s hs traffic&quot; cr sr)) (1 1))
  (label 56)
  (parent 54)
  (unrealized (0 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k57">Item <a href="#t52">57</a>, Parent: <a href="#k54">54</a>, Child: <a href="#k62">62</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 57</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
    (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (invk spk-0))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
        (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            server spk-0 (enc (hash server spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (1 1))
  (label 57)
  (parent 54)
  (unrealized (0 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k58">Item <a href="#t52">58</a>, Parent: <a href="#k55">55</a>, Children: <a href="#k63">63</a> <a href="#k64">64</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 58</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 3 0 server-auth 2)
    (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
      (enc
        (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server
          spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-1)) &quot;s hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1))
        (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server
            spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
      (hash (exp (gen) (mul x-0 y-1)) &quot;s hs traffic&quot; cr sr)) (2 1))
  (label 58)
  (parent 55)
  (unrealized (0 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k59">Item <a href="#t52">59</a>, Parent: <a href="#k55">55</a>, Child: <a href="#k65">65</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y-0 y-1))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.340 450.660 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-1)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 y-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 59</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr))
    (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
          (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
        (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
            (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
      (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (2 1))
  (label 59)
  (parent 55)
  (unrealized (0 2) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k60">Item <a href="#t52">60</a>, Parent: <a href="#k56">56</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 60 (realized)</text>
  </svg></div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (0 2))
  (label 60)
  (parent 56)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (username username)
        (auth auth) (cr cr) (x x))))
  (origs (challenge (0 3)) (sr (0 1))))</pre>

<p id="k61">Item <a href="#t52">61</a>, Parent: <a href="#k56">56</a>, Child: <a href="#k66">66</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 61</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (0 2))
  (label 61)
  (parent 56)
  (unrealized (0 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k62">Item <a href="#t52">62</a>, Parent: <a href="#k57">57</a>, Children: <a href="#k67">67</a> <a href="#k68">68</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 62</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr) (2 0))
  (label 62)
  (parent 57)
  (unrealized (0 2) (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k63">Item <a href="#t52">63</a>, Parent: <a href="#k58">58</a>, Seen Child: <a href="#k60">60</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y-0 x-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 63 (realized)</text>
  </svg></div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 3 2 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y-0 x-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) &quot;c hs traffic&quot; cr sr)) (0 2))
  (label 63)
  (parent 58)
  (seen 60)
  (unrealized)
  (comment &quot;1 in cohort - 0 not yet seen&quot;))</pre>

<p id="k64">Item <a href="#t52">64</a>, Parent: <a href="#k58">58</a>, Child: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 192.900 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 136.920 302.460 233.880 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 64</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (0 2))
  (label 64)
  (parent 58)
  (unrealized (0 2) (3 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k65">Item <a href="#t52">65</a>, Parent: <a href="#k59">59</a>, Children: <a href="#k70">70</a> <a href="#k71">71</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y-0 y-1))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-1)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 y-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 65</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr) (3 0))
  (label 65)
  (parent 59)
  (unrealized (0 2) (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k66">Item <a href="#t52">66</a>, Parent: <a href="#k61">61</a>, Children: <a href="#k72">72</a> <a href="#k73">73</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 87.540 225.660 135.121 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 66</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (label 66)
  (parent 61)
  (unrealized (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k67">Item <a href="#t52">67</a>, Parent: <a href="#k62">62</a>, Child: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 67</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 4 0 server-auth 2) (exp (gen) y-0)
    (3 0))
  (label 67)
  (parent 62)
  (unrealized (1 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k68">Item <a href="#t52">68</a>, Parent: <a href="#k62">62</a>, Children: <a href="#k75">75</a> <a href="#k76">76</a> <a href="#k77">77</a> <a href="#k78">78</a> <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y y-0 (rec w))) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y y-0 (rec w))) w)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 68</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (y expt) (y-0 rndx) (w expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0 (rec w))) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x y y-0 (rec w))) w))
    (exp (gen) (mul x y y-0)) (3 0))
  (label 68)
  (parent 62)
  (unrealized (0 2) (4 0))
  (comment &quot;5 in cohort - 5 not yet seen&quot;))</pre>

<p id="k69">Item <a href="#t52">69</a>, Parent: <a href="#k64">64</a>, Children: <a href="#k80">80</a> <a href="#k81">81</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 192.900 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 142.920 452.460 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.340 450.660 44.759 486.359'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 136.920 377.460 233.880 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 137.111 188.906 234.262 262.852'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 69</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr) (3 0))
  (label 69)
  (parent 64)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k70">Item <a href="#t52">70</a>, Parent: <a href="#k65">65</a>, Child: <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 70</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-1)
    (4 0))
  (label 70)
  (parent 65)
  (unrealized (2 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k71">Item <a href="#t52">71</a>, Parent: <a href="#k65">65</a>, Children: <a href="#k83">83</a> <a href="#k84">84</a> <a href="#k85">85</a> <a href="#k86">86</a> <a href="#k87">87</a> <a href="#k88">88</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y-0 y-1))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-1)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 y-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 71</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt) (y-1 rndx) (w expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
    (exp (gen) (mul x-0 y-0 y-1)) (4 0))
  (label 71)
  (parent 65)
  (unrealized (0 2) (5 0))
  (comment &quot;6 in cohort - 6 not yet seen&quot;))</pre>

<p id="k72">Item <a href="#t52">72</a>, Parent: <a href="#k66">66</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 88.276 262.464 136.593 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 72</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (label 72)
  (parent 66)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k73">Item <a href="#t52">73</a>, Parent: <a href="#k66">66</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 88.276 262.464 136.593 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 73</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (label 73)
  (parent 66)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k74">Item <a href="#t52">74</a>, Parent: <a href="#k67">67</a>, Children: <a href="#k89">89</a> <a href="#k90">90</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 292.770 264.232 145.741 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 74</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (3 0)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
        server spk-0 (enc (hash server spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))) (1 1))
  (label 74)
  (parent 67)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k75">Item <a href="#t52">75</a>, Parent: <a href="#k68">68</a>, Child: <a href="#k91">91</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 75</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (contracted (x-0 x) (y-0 (mul (rec x) w)) (y-1 y) (w-0 (mul w y))
      (y-2 y) (w (mul w y))) (gen) (4 0))
  (label 75)
  (parent 68)
  (unrealized (1 1) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k76">Item <a href="#t52">76</a>, Parent: <a href="#k68">68</a>, Child: <a href="#k92">92</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 76</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 1 client-auth 1) (exp (gen) x-0)
    (4 0))
  (label 76)
  (parent 68)
  (unrealized (0 2) (3 0) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k77">Item <a href="#t52">77</a>, Parent: <a href="#k68">68</a>, Child: <a href="#k93">93</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 114.960 Q 292.860 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w x-0 y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (x x-0))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w x-0 y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 77</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (4 0))
  (label 77)
  (parent 68)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k78">Item <a href="#t52">78</a>, Parent: <a href="#k68">68</a>, Children: <a href="#k94">94</a> <a href="#k95">95</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 78</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-0)
    (4 0))
  (label 78)
  (parent 68)
  (unrealized (1 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k79">Item <a href="#t52">79</a>, Parent: <a href="#k68">68</a>, Child: <a href="#k96">96</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 292.860 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server-0) (ca ca-1) (spk spk-1) (x x) (y y))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul (rec x-0) w y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 79</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (ca username auth server ca-0 appid server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (4 0))
  (label 79)
  (parent 68)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k80">Item <a href="#t52">80</a>, Parent: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) y-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 137.520 225.660 235.081 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 80</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (label 80)
  (parent 69)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k81">Item <a href="#t52">81</a>, Parent: <a href="#k69">69</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 192.900 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 137.520 225.660 235.081 336.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 81</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (label 81)
  (parent 69)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k82">Item <a href="#t52">82</a>, Parent: <a href="#k70">70</a>, Children: <a href="#k97">97</a> <a href="#k98">98</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 392.730 264.232 245.701 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 82</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
        (enc (hash server spk-1) (privk ca-1))))
    (hash (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))) (2 1))
  (label 82)
  (parent 70)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k83">Item <a href="#t52">83</a>, Parent: <a href="#k71">71</a>, Child: <a href="#k99">99</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y-0))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y-0))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 83</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (gen) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test
    (contracted (x-1 x-0) (y-1 (mul (rec x-0) w)) (y-2 y-0)
      (w-0 (mul w y-0)) (y-3 y-0) (w (mul w y-0))) (gen) (5 0))
  (label 83)
  (parent 71)
  (unrealized (2 1) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k84">Item <a href="#t52">84</a>, Parent: <a href="#k71">71</a>, Child: <a href="#k100">100</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul y x-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul y x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul y x-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x) (y (mul (rec x) w x-0 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 84</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (y expt) (x rndx) (w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x)
    (y (mul (rec x) w x-0 y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 1 client-auth 1) (exp (gen) x-1)
    (5 0))
  (label 84)
  (parent 71)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k85">Item <a href="#t52">85</a>, Parent: <a href="#k71">71</a>, Child: <a href="#k101">101</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 85</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 2 client-auth 1) (exp (gen) x-1)
    (5 0))
  (label 85)
  (parent 71)
  (unrealized (0 2) (4 0) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k86">Item <a href="#t52">86</a>, Parent: <a href="#k71">71</a>, Child: <a href="#k102">102</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 114.960 Q 342.840 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) (mul w y-0))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) (mul w y-0))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w x-1 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-1 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-1) (x x-1))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) w x-1 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 86</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w x-1 y-0)))
  (deflistener (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 0) (0 0)))
  (absent (y-0 (exp (gen) (mul w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-1)
    (5 0))
  (label 86)
  (parent 71)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k87">Item <a href="#t52">87</a>, Parent: <a href="#k71">71</a>, Children: <a href="#k103">103</a> <a href="#k104">104</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 87</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-1)
    (5 0))
  (label 87)
  (parent 71)
  (unrealized (2 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k88">Item <a href="#t52">88</a>, Parent: <a href="#k71">71</a>, Child: <a href="#k105">105</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 189.960 Q 342.840 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-0)) (enc (cat server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (enc (hash (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) (cat server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (enc (hash (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul w y-1))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul w y-1))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-1))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.888 562.114 41.857 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-1)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w y-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (server server-1) (ca ca-2) (spk spk-2) (x x-0) (y y-0))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul (rec x-1) w y-0 y-1)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 88</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      server-1 ca-2 name) (authk spk spk-0 spk-1 spk-2 akey) (x rndx)
    (y x-0 expt) (x-1 rndx) (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1)
    (y (mul (rec x-1) w y-0 y-1)))
  (deflistener (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-1)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (0 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y-0)
    (5 0))
  (label 88)
  (parent 71)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k89">Item <a href="#t52">89</a>, Parent: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (rec x)) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (rec x)) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 292.860 302.460 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 89</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (rec x)) y))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x)) y))
    (exp (gen) (mul (rec x) y)) (4 0))
  (label 89)
  (parent 74)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k90">Item <a href="#t52">90</a>, Parent: <a href="#k74">74</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 292.860 302.460 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 90</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul (rec x) y)) (4 0))
  (label 90)
  (parent 74)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k91">Item <a href="#t52">91</a>, Parent: <a href="#k75">75</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 91</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (label 91)
  (parent 75)
  (unrealized (1 1) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k92">Item <a href="#t52">92</a>, Parent: <a href="#k76">76</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 92</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (label 92)
  (parent 76)
  (unrealized (0 2) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k93">Item <a href="#t52">93</a>, Parent: <a href="#k77">77</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 542.760 227.460 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 292.860 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w x-0 y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (x x-0))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w x-0 y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 93</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (label 93)
  (parent 77)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k94">Item <a href="#t52">94</a>, Parent: <a href="#k78">78</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 94</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 5 0 server-auth 2)
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server spk-0
      (enc (hash server spk-0) (privk ca-0))) (1 1))
  (label 94)
  (parent 78)
  (unrealized (0 2) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k95">Item <a href="#t52">95</a>, Parent: <a href="#k78">78</a>, Children: <a href="#k106">106</a> <a href="#k107">107</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 342.649 301.406 145.538 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 95</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
        server spk-0 (enc (hash server spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))) (1 1))
  (label 95)
  (parent 78)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k96">Item <a href="#t52">96</a>, Parent: <a href="#k79">79</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 542.760 302.460 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 292.860 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server-0) (ca ca-1) (spk spk-1) (x x) (y y))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul (rec x-0) w y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 96</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (ca username auth server ca-0 appid server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (4 0))
  (label 96)
  (parent 79)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k97">Item <a href="#t52">97</a>, Parent: <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (rec x-0)) y-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (rec x-0)) y-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 392.820 302.460 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 97</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) (rec x-0)) y-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)) ((6 1) (5 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x-0)) y-0))
    (exp (gen) (mul (rec x-0) y-0)) (5 0))
  (label 97)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k98">Item <a href="#t52">98</a>, Parent: <a href="#k82">82</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 392.820 302.460 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 142.920 527.460 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.604 487.464 43.287 559.967'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 136.920 452.460 233.880 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 98</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)) ((6 1) (5 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul (rec x-0) y-0)) (5 0))
  (label 98)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k99">Item <a href="#t52">99</a>, Parent: <a href="#k83">83</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y-0))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.888 562.114 41.857 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 99</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (gen) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (label 99)
  (parent 83)
  (unrealized (2 1) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k100">Item <a href="#t52">100</a>, Parent: <a href="#k84">84</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.888 562.114 41.857 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul y x-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul y x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul y x-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x) (y (mul (rec x) w x-0 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 100</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (y expt) (x rndx) (w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x)
    (y (mul (rec x) w x-0 y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (label 100)
  (parent 84)
  (unrealized (0 2) (2 1) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k101">Item <a href="#t52">101</a>, Parent: <a href="#k85">85</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.888 562.114 41.857 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 101</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (label 101)
  (parent 85)
  (unrealized (0 2) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k102">Item <a href="#t52">102</a>, Parent: <a href="#k86">86</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 642.720 227.460 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 114.960 Q 342.840 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) (mul w y-0))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) (mul w y-0))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w x-1 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.888 562.114 41.857 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-1 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-1)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-1) (x x-1))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) w x-1 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 102</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w x-1 y-0)))
  (deflistener (hash (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-1 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (deflistener y-0)
  (precedes ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 0) (0 0)) ((7 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (label 102)
  (parent 86)
  (unrealized (0 2) (2 1) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k103">Item <a href="#t52">103</a>, Parent: <a href="#k87">87</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 103</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 6 0 server-auth 2)
    (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server spk-1
      (enc (hash server spk-1) (privk ca-1))) (2 1))
  (label 103)
  (parent 87)
  (unrealized (0 2) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k104">Item <a href="#t52">104</a>, Parent: <a href="#k87">87</a>, Children: <a href="#k108">108</a> <a href="#k109">109</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 442.609 301.406 245.498 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 104</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (precedes ((0 1) (5 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
        (enc (hash server spk-1) (privk ca-1))))
    (hash (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))) (2 1))
  (label 104)
  (parent 87)
  (unrealized (6 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k105">Item <a href="#t52">105</a>, Parent: <a href="#k88">88</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='114.960' x2='639.720' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='414.960' x2='439.800' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='489.960' x2='339.840' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 339.960 Q 642.720 302.460 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-1</title><circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>y-1</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 189.960 Q 342.840 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-0)) (enc (cat server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (enc (hash (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) (cat server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (enc (hash (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='639.720' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='114.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 492.780 414.960 445.800 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul w y-1))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul w y-1))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 489.960 Q 392.820 489.960 345.840 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='414.960' r='6.000'/></g>
  <path
   d='M 339.840 564.960 Q 292.860 564.960 245.880 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 789.960 Q 142.920 752.460 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='239.880' cy='564.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-1))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.713 599.561 41.505 784.162'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 136.920 677.460 233.880 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-1)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w y-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (server server-1) (ca ca-2) (spk spk-2) (x x-0) (y y-0))</title>
   <text
    x='639.720' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul (rec x-1) w y-0 y-1)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 105</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      server-1 ca-2 name) (authk spk spk-0 spk-1 spk-2 akey) (x rndx)
    (y x-0 expt) (x-1 rndx) (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1)
    (y (mul (rec x-1) w y-0 y-1)))
  (deflistener (hash (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-1)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (deflistener y-1)
  (precedes ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (0 0)) ((7 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-1) (mul w y-1) (5 0))
  (label 105)
  (parent 88)
  (unrealized (0 2) (2 1) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k106">Item <a href="#t52">106</a>, Parent: <a href="#k95">95</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 342.649 301.406 145.538 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 106</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0
      (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-0)
    (5 0))
  (label 106)
  (parent 95)
  (unrealized (0 2) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k107">Item <a href="#t52">107</a>, Parent: <a href="#k95">95</a>, Children: <a href="#k110">110</a> <a href="#k111">111</a> <a href="#k112">112</a> <a href="#k113">113</a> <a href="#k114">114</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 107</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx) (w-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
    (exp (gen) (mul (rec x) w y)) (5 0))
  (label 107)
  (parent 95)
  (unrealized (6 0))
  (comment &quot;5 in cohort - 5 not yet seen&quot;))</pre>

<p id="k108">Item <a href="#t52">108</a>, Parent: <a href="#k104">104</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 442.609 301.406 245.498 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) x-0)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y y-0))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 108</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (precedes ((0 1) (5 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-1)
    (6 0))
  (label 108)
  (parent 104)
  (unrealized (0 2) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k109">Item <a href="#t52">109</a>, Parent: <a href="#k104">104</a>, Children: <a href="#k115">115</a> <a href="#k116">116</a> <a href="#k117">117</a> <a href="#k118">118</a> <a href="#k119">119</a> <a href="#k120">120</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0)</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0)</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul (rec x-0) w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 109</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx) (w-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener
      (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
    (exp (gen) (mul (rec x-0) w y-0)) (6 0))
  (label 109)
  (parent 104)
  (unrealized (7 0))
  (comment &quot;6 in cohort - 6 not yet seen&quot;))</pre>

<p id="k110">Item <a href="#t52">110</a>, Parent: <a href="#k107">107</a>, Child: <a href="#k121">121</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 110</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-0 x) (w-0 (mul x w)) (y-0 y) (w-1 (mul w y)) (y-1 y)
      (w (mul w y))) (gen) (6 0))
  (label 110)
  (parent 107)
  (unrealized (0 2) (3 0) (4 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k111">Item <a href="#t52">111</a>, Parent: <a href="#k107">107</a>, Child: <a href="#k122">122</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w x x))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w x x))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x x)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 111</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 1 client-auth 1) (exp (gen) x-0)
    (6 0))
  (label 111)
  (parent 107)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k112">Item <a href="#t52">112</a>, Parent: <a href="#k107">107</a>, Child: <a href="#k123">123</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 392.820 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w x-0))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w x-0))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-0 y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w x-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (x x-0))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 112</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (6 0))
  (label 112)
  (parent 107)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k113">Item <a href="#t52">113</a>, Parent: <a href="#k107">107</a>, Children: <a href="#k124">124</a> <a href="#k125">125</a> <a href="#k126">126</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 113</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-0)
    (6 0))
  (label 113)
  (parent 107)
  (unrealized (0 2) (3 0) (4 0))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k114">Item <a href="#t52">114</a>, Parent: <a href="#k107">107</a>, Child: <a href="#k127">127</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 392.820 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 342.789 414.407 145.817 488.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w y))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w y)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server-0) (ca ca-1) (spk spk-1) (x x) (y y))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 114</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (ca username auth server ca-0 appid server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (6 0))
  (label 114)
  (parent 107)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k115">Item <a href="#t52">115</a>, Parent: <a href="#k109">109</a>, Child: <a href="#k128">128</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y-0))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y-0))</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 115</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (gen) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-1 x-0) (w-0 (mul x-0 w)) (y-1 y-0) (w-1 (mul w y-0))
      (y-2 y-0) (w (mul w y-0))) (gen) (7 0))
  (label 115)
  (parent 109)
  (unrealized (0 2) (4 0) (5 0) (7 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k116">Item <a href="#t52">116</a>, Parent: <a href="#k109">109</a>, Child: <a href="#k129">129</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x w x-0))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x w x-0))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-0 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul y x-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul y x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul y x-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w x-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 116</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (y expt) (x rndx) (w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 1 client-auth 1) (exp (gen) x-1)
    (7 0))
  (label 116)
  (parent 109)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k117">Item <a href="#t52">117</a>, Parent: <a href="#k109">109</a>, Child: <a href="#k130">130</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul w x-0 x-0))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul w x-0 x-0))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-0 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0 x-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 117</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w x-0 x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul w x-0 x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 2 client-auth 1) (exp (gen) x-1)
    (7 0))
  (label 117)
  (parent 109)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k118">Item <a href="#t52">118</a>, Parent: <a href="#k109">109</a>, Child: <a href="#k131">131</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 114.960 Q 442.800 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) (mul w y-0))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) (mul w y-0))</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w x-1))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w x-1))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-1 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w x-1)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-1) (x x-1))</title>
   <text
    x='839.640' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 118</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w x-1)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 0) (0 0)))
  (absent (y-0 (exp (gen) (mul x-0 w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-1)
    (7 0))
  (label 118)
  (parent 109)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k119">Item <a href="#t52">119</a>, Parent: <a href="#k109">109</a>, Children: <a href="#k132">132</a> <a href="#k133">133</a> <a href="#k134">134</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 119</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) w))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 0 server-auth 2) (exp (gen) y-1)
    (7 0))
  (label 119)
  (parent 109)
  (unrealized (0 2) (4 0) (5 0))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k120">Item <a href="#t52">120</a>, Parent: <a href="#k109">109</a>, Child: <a href="#k135">135</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 442.800 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-0)) (enc (cat server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (enc (hash (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) (cat server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (enc (hash (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul w y-1))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul w y-1))</title>
   <circle style='fill: red;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 442.749 414.407 245.777 488.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: red;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-1) (mul x-1 w y-0))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-1) (mul x-1 w y-0))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0 y-1))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-1))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.888 562.114 41.857 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 386.820 227.460 733.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-1)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-1 w y-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (server server-1) (ca ca-2) (spk spk-2) (x x-0) (y y-0))</title>
   <text
    x='839.640' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 120</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      server-1 ca-2 name) (authk spk spk-0 spk-1 spk-2 akey) (x rndx)
    (y x-0 expt) (x-1 rndx) (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-1) (mul x-1 w y-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-1)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (0 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul x-1 w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y-0)
    (7 0))
  (label 120)
  (parent 109)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k121">Item <a href="#t52">121</a>, Parent: <a href="#k110">110</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 342.840 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 121</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (label 121)
  (parent 110)
  (unrealized (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k122">Item <a href="#t52">122</a>, Parent: <a href="#k111">111</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 342.840 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w x x))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w x x))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x x)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 122</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (label 122)
  (parent 111)
  (unrealized (0 0) (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k123">Item <a href="#t52">123</a>, Parent: <a href="#k112">112</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 264.960 Q 742.680 227.460 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 114.960 Q 392.820 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 342.840 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w x-0))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w x-0))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-0 y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 436.800 152.460 833.640 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w x-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (x x-0))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 123</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (label 123)
  (parent 112)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k124">Item <a href="#t52">124</a>, Parent: <a href="#k113">113</a>, Child: <a href="#k136">136</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (rec x))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (rec x))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (one))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (one))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y (rec x)))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 124</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-0 x) (w (rec x))) (one) (4 0))
  (label 124)
  (parent 113)
  (unrealized (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k125">Item <a href="#t52">125</a>, Parent: <a href="#k113">113</a>, Child: <a href="#k137">137</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w (rec x)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w (rec x)))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y (rec x)))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 125</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x w) w (4 0))
  (label 125)
  (parent 113)
  (unrealized (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k126">Item <a href="#t52">126</a>, Parent: <a href="#k113">113</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 592.740 152.460 445.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x</title><circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>x</title>
   <circle style='fill: red;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 126</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (4 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul x w) (4 0))
  (label 126)
  (parent 113)
  (unrealized (0 2) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k127">Item <a href="#t52">127</a>, Parent: <a href="#k114">114</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='264.960' x2='839.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 339.960 Q 742.680 302.460 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='839.640' cy='339.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='839.640' cy='264.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 392.820 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 342.840 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w y))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 436.800 227.460 833.640 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w y)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server-0) (ca ca-1) (spk spk-1) (x x) (y y))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 127</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (ca username auth server ca-0 appid server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (6 0))
  (label 127)
  (parent 114)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k128">Item <a href="#t52">128</a>, Parent: <a href="#k115">115</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 264.960 Q 792.660 264.960 745.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y-0))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 442.800 377.460 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 436.800 152.460 833.640 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 128</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (gen) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (label 128)
  (parent 115)
  (unrealized (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k129">Item <a href="#t52">129</a>, Parent: <a href="#k116">116</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 264.960 Q 792.660 264.960 745.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 442.800 377.460 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x w x-0))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x w x-0))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-0 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul y x-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul y x-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul y x-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul y x-0)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul y x-0)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 436.800 152.460 833.640 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w x-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 129</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (y expt) (x rndx) (w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (label 129)
  (parent 116)
  (unrealized (0 0) (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k130">Item <a href="#t52">130</a>, Parent: <a href="#k117">117</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 264.960 Q 792.660 264.960 745.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 442.800 377.460 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul w x-0 x-0))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul w x-0 x-0))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-0 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 436.800 152.460 833.640 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0 x-0))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0 x-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 130</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (exp (gen) (mul w x-0 x-0 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w x-0 x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul w x-0 x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (label 130)
  (parent 117)
  (unrealized (0 0) (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k131">Item <a href="#t52">131</a>, Parent: <a href="#k118">118</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='189.960' x2='939.600' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='264.960' x2='739.680' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 264.960 Q 842.640 227.460 745.680 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='939.600' cy='264.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='939.600' cy='189.960' r='6.000'/></g>
  <path
   d='M 839.640 114.960 Q 442.800 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-1 (exp (gen) x-1))</title>
   <circle cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 339.960 Q 692.700 339.960 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-1) (mul w y-0))</title>
   <circle cx='739.680' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-1) (mul w y-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='264.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 442.800 377.460 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w x-1))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w x-1))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-1 y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 486.780 152.460 933.600 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w x-1))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w x-1)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-1) (x x-1))</title>
   <text
    x='839.640' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 131</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (exp (gen) (mul x-0 w x-1 y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w x-1)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (9 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 0) (0 0))
    ((9 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x-0 w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (label 131)
  (parent 118)
  (unrealized (0 0) (0 2) (4 0) (5 0) (9 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k132">Item <a href="#t52">132</a>, Parent: <a href="#k119">119</a>, Child: <a href="#k138">138</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (rec x-0))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (rec x-0))</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (one))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (one))</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y-0 (rec x-0)))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 (rec x-0))))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 132</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul y-0 (rec x-0))))
  (deflistener (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (rec x-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-1 x-0) (w (rec x-0))) (one)
    (5 0))
  (label 132)
  (parent 119)
  (unrealized (6 0) (7 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k133">Item <a href="#t52">133</a>, Parent: <a href="#k119">119</a>, Child: <a href="#k139">139</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul w (rec x-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul w (rec x-0)))</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0 (rec x-0)))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0 (rec x-0))))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 133</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul w y-0 (rec x-0))))
  (deflistener (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w (rec x-0))))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (x-0 w) (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x-0 w) w (5 0))
  (label 133)
  (parent 119)
  (unrealized (6 0) (7 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k134">Item <a href="#t52">134</a>, Parent: <a href="#k119">119</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 692.700 152.460 545.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x-0</title><circle cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>x-0</title>
   <circle style='fill: red;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w))</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 134</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (5 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (mul x-0 w) (5 0))
  (label 134)
  (parent 119)
  (unrealized (0 2) (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k135">Item <a href="#t52">135</a>, Parent: <a href="#k120">120</a>.</p>

<div>
 <svg
  class='diagram' width='979.560pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 979.560 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='939.600' y1='264.960' x2='939.600' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='339.960' x2='739.680' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='414.960' x2='639.720' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 939.600 339.960 Q 842.640 302.460 745.680 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-1</title><circle cx='939.600' cy='339.960' r='6.000'/></g>
  <g><title>y-1</title>
   <circle style='fill: red;' cx='939.600' cy='264.960' r='6.000'/></g>
  <path
   d='M 839.640 189.960 Q 442.800 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-1 (exp (gen) y-0)) (enc (cat server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (enc (hash (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-1 sr-1)) (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) (cat server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (enc (hash (cat cr-1 (exp (gen) x-0)) (cat sr-1 (exp (gen) y-0)) server-1 spk-2 (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2))) (hash (exp (gen) (mul x-0 y-0)) &quot;s hs traffic&quot; cr-1 sr-1)))</title>
   <circle cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-1 (exp (gen) x-0))</title>
   <circle style='fill: blue;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 414.960 Q 692.700 414.960 645.720 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul w y-1))</title>
   <circle cx='739.680' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul w y-1))</title>
   <circle style='fill: blue;' cx='739.680' cy='339.960' r='6.000'/></g>
  <path
   d='M 639.720 489.960 Q 442.800 452.460 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='414.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 492.780 339.960 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-1) (mul x-1 w y-0))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-1) (mul x-1 w y-0))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 714.960 Q 142.920 677.460 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0 y-1))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 239.880 189.960 Q 142.920 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-1))</title>
   <circle cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 90.888 562.114 41.857 709.268'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 136.920 602.460 233.880 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 286.860 227.460 533.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 486.780 227.460 933.600 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-1)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-1 w y-0))) (cat sr (exp (gen) y-1)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-1 w y-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-1) (sr sr-1) (server server-1) (ca ca-2) (spk spk-2) (x x-0) (y y-0))</title>
   <text
    x='839.640' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='489.780' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 135</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      server-1 ca-2 name) (authk spk spk-0 spk-1 spk-2 akey) (x rndx)
    (y x-0 expt) (x-1 rndx) (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (exp (gen) (mul x-1 w y-0 y-1)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-1) (mul x-1 w y-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-1)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (deflistener y-1)
  (precedes ((0 1) (5 0)) ((0 1) (9 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (0 0))
    ((9 1) (7 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul x-1 w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-1) (mul w y-1) (7 0))
  (label 135)
  (parent 120)
  (unrealized (0 0) (0 2) (4 0) (5 0) (9 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k136">Item <a href="#t52">136</a>, Parent: <a href="#k124">124</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x</title><circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>x</title>
   <circle style='fill: red;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (rec x))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (rec x))</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (one))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (one))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y (rec x)))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 136</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (rec x) (6 0))
  (label 136)
  (parent 124)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k137">Item <a href="#t52">137</a>, Parent: <a href="#k125">125</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x</title><circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>x</title>
   <circle style='fill: red;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w (rec x)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w (rec x)))</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y (rec x)))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 137</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul w (rec x)) (6 0))
  (label 137)
  (parent 125)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k138">Item <a href="#t52">138</a>, Parent: <a href="#k132">132</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x-0</title><circle cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>x-0</title>
   <circle style='fill: red;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (rec x-0))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (rec x-0))</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (one))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (one))</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y-0 (rec x-0)))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) y-0) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y-0) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y-0) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 (rec x-0))))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 138</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul y-0 (rec x-0))))
  (deflistener (hash (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (rec x-0)))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (rec x-0) (7 0))
  (label 138)
  (parent 132)
  (unrealized (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k139">Item <a href="#t52">139</a>, Parent: <a href="#k133">133</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='114.960' x2='839.640' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='114.960' x2='239.880' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 189.960 Q 792.660 189.960 745.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x-0</title><circle cx='839.640' cy='189.960' r='6.000'/></g>
  <g><title>x-0</title>
   <circle style='fill: red;' cx='839.640' cy='114.960' r='6.000'/></g>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul w (rec x-0)))</title>
   <circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul w (rec x-0)))</title>
   <circle style='fill: blue;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 442.749 339.407 245.777 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1)))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) w)</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 639.960 Q 142.920 602.460 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='239.880' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y-0 (rec x-0)))) (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) (cat server spk-1 (enc (hash server spk-1) (privk ca-1))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 114.960 Q 142.920 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 239.880 114.960 Q 536.760 77.460 833.640 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='239.880' cy='114.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 91.158 524.718 42.396 634.477'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0))) (enc auth-0 authk (hash appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0)) (invk authk)) (hash &quot;c ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc username appid-0 challenge-0 (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr-0 sr-0 username appid-0 challenge-0 server-0) (hash &quot;s ap traffic&quot; cr-0 sr-0 (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr-0 sr-0))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (hash &quot;key handle&quot; (invk authk) username) (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 136.920 527.460 233.880 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc username appid challenge (hash (hash (exp (gen) (mul w y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr username appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca-1) (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0 (rec x-0))))</title>
   <text
    x='239.880' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge-0) (cr cr-0) (sr sr-0) (username username) (auth auth-0) (server server-0) (ca ca-0) (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-reg</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (username username) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y-0))</title>
   <text
    x='39.960' y='77.460' style='text-anchor: middle;'>server-reg</text>
   </g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 139</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul w y-0 (rec x-0))))
  (deflistener (hash (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w (rec x-0))))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (x-0 w) (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (mul w (rec x-0)) (7 0))
  (label 139)
  (parent 133)
  (unrealized (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="t140">Tree <a href="#top">140</a>, POV <a href="#k140">140</a>.</p>

<div>
 <svg
  class='diagram' width='579.120pt' height='1354.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.120 1354.920' font-size='12.000'>
  <text
   x='339.480' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k165&quot;, &quot;_self&quot;)'>165</text>
  <line
   x1='289.560' y1='1314.960' x2='339.480' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='1301.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k157&quot;, &quot;_self&quot;)'>157</text>
  <line
   x1='239.640' y1='864.960' x2='289.560' y2='1314.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k179&quot;, &quot;_self&quot;)'>179</text>
  <line
   x1='439.320' y1='1239.960' x2='489.240' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1226.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k172&quot;, &quot;_self&quot;)'>172</text>
  <line
   x1='389.400' y1='1014.960' x2='439.320' y2='1239.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1151.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k178&quot;, &quot;_self&quot;)'>178</text>
  <line
   x1='439.320' y1='1089.960' x2='489.240' y2='1164.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k181&quot;, &quot;_self&quot;)'>181</text>
  <line
   x1='489.240' y1='1089.960' x2='539.160' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k177&quot;, &quot;_self&quot;)'>177</text>
  <line
   x1='439.320' y1='1089.960' x2='489.240' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='539.160' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k180&quot;, &quot;_self&quot;)'>180</text>
  <line
   x1='489.240' y1='1014.960' x2='539.160' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k176&quot;, &quot;_self&quot;)'>176</text>
  <line
   x1='439.320' y1='1089.960' x2='489.240' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='1076.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k171&quot;, &quot;_self&quot;)'>171</text>
  <line
   x1='389.400' y1='1014.960' x2='439.320' y2='1089.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k175&quot;, &quot;_self&quot;)'>175</text>
  <line
   x1='439.320' y1='939.960' x2='489.240' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k170&quot;, &quot;_self&quot;)'>170</text>
  <line
   x1='389.400' y1='1014.960' x2='439.320' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k174&quot;, &quot;_self&quot;)'>174</text>
  <line
   x1='439.320' y1='864.960' x2='489.240' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k169&quot;, &quot;_self&quot;)'>169</text>
  <line
   x1='389.400' y1='1014.960' x2='439.320' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='489.240' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k173&quot;, &quot;_self&quot;)'>173</text>
  <line
   x1='439.320' y1='789.960' x2='489.240' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='439.320' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k168&quot;, &quot;_self&quot;)'>168</text>
  <line
   x1='389.400' y1='1014.960' x2='439.320' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='1001.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k167&quot;, &quot;_self&quot;)'>167</text>
  <line
   x1='339.480' y1='977.460' x2='389.400' y2='1014.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='389.400' y='701.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k166&quot;, &quot;_self&quot;)'>166</text>
  <line
   x1='339.480' y1='977.460' x2='389.400' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='963.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k164&quot;, &quot;_self&quot;)'>164</text>
  <line
   x1='289.560' y1='939.960' x2='339.480' y2='977.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='626.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k163&quot;, &quot;_self&quot;)'>163</text>
  <line
   x1='289.560' y1='939.960' x2='339.480' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='926.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k156&quot;, &quot;_self&quot;)'>156</text>
  <line
   x1='239.640' y1='864.960' x2='289.560' y2='939.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k162&quot;, &quot;_self&quot;)'>162</text>
  <line
   x1='289.560' y1='564.960' x2='339.480' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='551.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k155&quot;, &quot;_self&quot;)'>155</text>
  <line
   x1='239.640' y1='864.960' x2='289.560' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k161&quot;, &quot;_self&quot;)'>161</text>
  <line
   x1='289.560' y1='489.960' x2='339.480' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='476.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k154&quot;, &quot;_self&quot;)'>154</text>
  <line
   x1='239.640' y1='864.960' x2='289.560' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k160&quot;, &quot;_self&quot;)'>160</text>
  <line
   x1='289.560' y1='414.960' x2='339.480' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='401.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k153&quot;, &quot;_self&quot;)'>153</text>
  <line
   x1='239.640' y1='864.960' x2='289.560' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='851.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k149&quot;, &quot;_self&quot;)'>149</text>
  <line
   x1='189.720' y1='789.960' x2='239.640' y2='864.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='326.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k159&quot;, &quot;_self&quot;)'>159</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='339.480' y='251.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k158&quot;, &quot;_self&quot;)'>158</text>
  <line
   x1='289.560' y1='302.460' x2='339.480' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k152&quot;, &quot;_self&quot;)'>152</text>
  <line
   x1='239.640' y1='302.460' x2='289.560' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='288.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k148&quot;, &quot;_self&quot;)'>148</text>
  <line
   x1='189.720' y1='789.960' x2='239.640' y2='302.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k146&quot;, &quot;_self&quot;)'>146</text>
  <line
   x1='139.800' y1='789.960' x2='189.720' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='776.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k143&quot;, &quot;_self&quot;)'>143</text>
  <line
   x1='89.880' y1='677.460' x2='139.800' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='176.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k151&quot;, &quot;_self&quot;)'>151</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='289.560' y='101.040' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k150&quot;, &quot;_self&quot;)'>150</text>
  <line
   x1='239.640' y1='152.460' x2='289.560' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='239.640' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k147&quot;, &quot;_self&quot;)'>147</text>
  <line
   x1='189.720' y1='152.460' x2='239.640' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='138.540' style='text-anchor: middle; fill: red;'
   onclick='window.open(&quot;#k145&quot;, &quot;_self&quot;)'>145</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='152.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='189.720' y='26.040'
   style='font-weight: bold; text-anchor: middle; fill: blue;'
   onclick='window.open(&quot;#k144&quot;, &quot;_self&quot;)'>144</text>
  <line
   x1='139.800' y1='114.960' x2='189.720' y2='39.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='139.800' y='101.040' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k142&quot;, &quot;_self&quot;)'>142</text>
  <line
   x1='89.880' y1='677.460' x2='139.800' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='89.880' y='663.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k141&quot;, &quot;_self&quot;)'>141</text>
  <line
   x1='39.960' y1='677.460' x2='89.880' y2='677.460'
   style='stroke-width: 0.960; stroke: gray;'/>
  <text
   x='39.960' y='663.540' style='text-anchor: middle; fill: black;'
   onclick='window.open(&quot;#k140&quot;, &quot;_self&quot;)'>140</text>
  </svg></div>

<pre>(defprotocol uaf-dualbinding-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr username appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole client-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (send
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr username appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc (hash &quot;key handle&quot; (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr username appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))))
      (recv
        (enc
          (hash
            (hash &quot;finished&quot;
              (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash &quot;finished&quot;
                (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr
            sr appid challenge server)
          (hash &quot;s ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;)
                &quot;dual-binding&quot; cr sr appid challenge server))
            (invk authk))
          (hash &quot;c ap traffic&quot; cr sr
            (hash (exp (gen) (mul x y)) &quot;derived&quot;)))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))</pre>

<p id="k140">Item <a href="#t140">140</a>, Child: <a href="#k141">141</a>.</p>

<div>
 <svg
  class='diagram' width='79.920pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 79.920 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='39.960' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 140</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (y rndx) (x expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y)
  (uniq-orig challenge sr)
  (goals
    (forall
      ((sr data) (challenge text) (authk spk akey)
        (server ca appid name) (y rndx) (z strd))
      (implies
        (and (p &quot;server-auth&quot; z 5) (p &quot;server-auth&quot; &quot;sr&quot; z sr)
          (p &quot;server-auth&quot; &quot;challenge&quot; z challenge)
          (p &quot;server-auth&quot; &quot;authk&quot; z authk)
          (p &quot;server-auth&quot; &quot;spk&quot; z spk)
          (p &quot;server-auth&quot; &quot;server&quot; z server)
          (p &quot;server-auth&quot; &quot;appid&quot; z appid) (p &quot;server-auth&quot; &quot;ca&quot; z ca)
          (p &quot;server-auth&quot; &quot;y&quot; z y) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen y) (uniq-at challenge z 3)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p &quot;client-auth&quot; z-0 5)
            (p &quot;client-auth&quot; &quot;challenge&quot; z-0 challenge)
            (p &quot;client-auth&quot; &quot;server&quot; z-0 server)
            (p &quot;client-auth&quot; &quot;appid&quot; z-0 appid))))))
  (label 140)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k141">Item <a href="#t140">141</a>, Parent: <a href="#k140">140</a>, Children: <a href="#k142">142</a> <a href="#k143">143</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 141</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y y-0)))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-auth 5)
    (enc auth authk
      (hash appid challenge
        (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot;
          cr sr appid challenge server)) (invk authk)) (0 4))
  (label 141)
  (parent 140)
  (unrealized (0 2) (1 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k142">Item <a href="#t140">142</a>, Parent: <a href="#k141">141</a>, Children: <a href="#k144">144</a> <a href="#k145">145</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 142</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server
          spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y-0)) &quot;s hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0))
        (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server
            spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x y-0)) &quot;s hs traffic&quot; cr sr)) (1 1))
  (label 142)
  (parent 141)
  (unrealized (0 2))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k143">Item <a href="#t140">143</a>, Parent: <a href="#k141">141</a>, Child: <a href="#k146">146</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 192.900 264.960 145.920 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 143</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
    (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (invk spk-0))
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
        (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            server spk-0 (enc (hash server spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (1 1))
  (label 143)
  (parent 141)
  (unrealized (0 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k144">Item <a href="#t140">144</a>, Parent: <a href="#k142">142</a>.</p>

<div>
 <svg
  class='diagram' width='179.880pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 179.880 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 264.960 Q 92.940 264.960 45.960 264.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul y x)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul y x)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='89.940' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 144 (realized)</text>
  </svg></div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul y x)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) &quot;c hs traffic&quot; cr sr)) (0 2))
  (label 144)
  (parent 142)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (auth auth) (cr cr)
        (x x))))
  (origs (challenge (0 3)) (sr (0 1))))</pre>

<p id="k145">Item <a href="#t140">145</a>, Parent: <a href="#k142">142</a>, Child: <a href="#k147">147</a>.</p>

<div>
 <svg
  class='diagram' width='279.840pt' height='454.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 279.840 454.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='239.880' y1='189.960' x2='239.880' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 239.880 264.960 Q 142.920 227.460 45.960 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='264.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='239.880' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 414.960 Q 92.940 414.960 45.960 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='189.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 339.960 Q 86.940 339.960 133.920 339.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='339.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='264.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 86.940 189.960 133.920 189.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 136.920 152.460 233.880 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='139.920' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 145</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (enc
      (hash
        (hash &quot;finished&quot;
          (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash &quot;finished&quot;
            (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (0 2))
  (label 145)
  (parent 142)
  (unrealized (0 2) (2 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k146">Item <a href="#t140">146</a>, Parent: <a href="#k143">143</a>, Children: <a href="#k148">148</a> <a href="#k149">149</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 146</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr) (2 0))
  (label 146)
  (parent 143)
  (unrealized (0 2) (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k147">Item <a href="#t140">147</a>, Parent: <a href="#k145">145</a>, Children: <a href="#k150">150</a> <a href="#k151">151</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='529.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 529.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 142.920 302.460 45.960 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 489.960 Q 92.940 489.960 45.960 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 414.960 Q 86.940 414.960 133.920 414.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='414.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='339.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 87.540 225.660 135.121 261.359'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 147</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
    (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr) (2 0))
  (label 147)
  (parent 145)
  (unrealized (3 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k148">Item <a href="#t140">148</a>, Parent: <a href="#k146">146</a>, Child: <a href="#k152">152</a>.</p>

<div>
 <svg
  class='diagram' width='379.800pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 379.800 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='189.900' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 148</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 4 0 server-auth 2) (exp (gen) y-0)
    (3 0))
  (label 148)
  (parent 146)
  (unrealized (1 1))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k149">Item <a href="#t140">149</a>, Parent: <a href="#k146">146</a>, Children: <a href="#k153">153</a> <a href="#k154">154</a> <a href="#k155">155</a> <a href="#k156">156</a> <a href="#k157">157</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul x y y-0 (rec w))) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul x y y-0 (rec w))) w)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 149</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx) (w expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0 (rec w))) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x y y-0 (rec w))) w))
    (exp (gen) (mul x y y-0)) (3 0))
  (label 149)
  (parent 146)
  (unrealized (0 2) (4 0))
  (comment &quot;5 in cohort - 5 not yet seen&quot;))</pre>

<p id="k150">Item <a href="#t140">150</a>, Parent: <a href="#k147">147</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) y)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 88.276 262.464 136.593 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 150</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (label 150)
  (parent 147)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k151">Item <a href="#t140">151</a>, Parent: <a href="#k147">147</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 142.920 377.460 45.960 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 88.276 262.464 136.593 334.967'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 151</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (label 151)
  (parent 147)
  (unrealized (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k152">Item <a href="#t140">152</a>, Parent: <a href="#k148">148</a>, Children: <a href="#k158">158</a> <a href="#k159">159</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 292.770 264.232 145.741 338.504'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 152</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (3 0)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
        server spk-0 (enc (hash server spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))) (1 1))
  (label 152)
  (parent 148)
  (unrealized (4 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k153">Item <a href="#t140">153</a>, Parent: <a href="#k149">149</a>, Child: <a href="#k160">160</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 153</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (contracted (x-0 x) (y-0 (mul (rec x) w)) (y-1 y) (w-0 (mul w y))
      (y-2 y) (w (mul w y))) (gen) (4 0))
  (label 153)
  (parent 149)
  (unrealized (1 1) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k154">Item <a href="#t140">154</a>, Parent: <a href="#k149">149</a>, Child: <a href="#k161">161</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 154</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 1 client-auth 1) (exp (gen) x-0)
    (4 0))
  (label 154)
  (parent 149)
  (unrealized (0 2) (3 0) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k155">Item <a href="#t140">155</a>, Parent: <a href="#k149">149</a>, Child: <a href="#k162">162</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 114.960 Q 292.860 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w x-0 y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (x x-0))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w x-0 y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 155</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid auth ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (4 0))
  (label 155)
  (parent 149)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k156">Item <a href="#t140">156</a>, Parent: <a href="#k149">149</a>, Children: <a href="#k163">163</a> <a href="#k164">164</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 156</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-0)
    (4 0))
  (label 156)
  (parent 149)
  (unrealized (1 1))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k157">Item <a href="#t140">157</a>, Parent: <a href="#k149">149</a>, Child: <a href="#k165">165</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 189.960 Q 292.860 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server-0) (ca ca-1) (spk spk-1) (x x) (y y))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul (rec x-0) w y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 157</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid auth ca-0 server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x-0) (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (4 0))
  (label 157)
  (parent 149)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k158">Item <a href="#t140">158</a>, Parent: <a href="#k152">152</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (rec x)) y)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (rec x)) y)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 292.860 302.460 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 158</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (rec x)) y))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x)) y))
    (exp (gen) (mul (rec x) y)) (4 0))
  (label 158)
  (parent 152)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k159">Item <a href="#t140">159</a>, Parent: <a href="#k152">152</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='604.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 604.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='189.960' x2='339.840' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='264.960' x2='239.880' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 292.860 302.460 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 264.960 Q 292.860 264.960 245.880 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='189.960' r='6.000'/></g>
  <path
   d='M 239.880 339.960 Q 192.900 339.960 145.920 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='339.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='264.960' r='6.000'/></g>
  <path
   d='M 139.920 564.960 Q 92.940 564.960 45.960 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 489.960 Q 86.940 489.960 133.920 489.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='489.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='414.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 186.900 152.460 333.840 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 159</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul (rec x) y)) (4 0))
  (label 159)
  (parent 152)
  (unrealized (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k160">Item <a href="#t140">160</a>, Parent: <a href="#k153">153</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 160</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (label 160)
  (parent 153)
  (unrealized (1 1) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k161">Item <a href="#t140">161</a>, Parent: <a href="#k154">154</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 492.780 264.960 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 161</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (label 161)
  (parent 154)
  (unrealized (0 2) (5 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k162">Item <a href="#t140">162</a>, Parent: <a href="#k155">155</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 542.760 227.460 445.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 114.960 Q 292.860 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle style='fill: blue;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w x-0 y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x-0)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (x x-0))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w x-0 y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 162</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid auth ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (label 162)
  (parent 155)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k163">Item <a href="#t140">163</a>, Parent: <a href="#k156">156</a>.</p>

<div>
 <svg
  class='diagram' width='479.760pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 479.760 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='239.880' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 163</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 5 0 server-auth 2)
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server spk-0
      (enc (hash server spk-0) (privk ca-0))) (1 1))
  (label 163)
  (parent 156)
  (unrealized (0 2) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k164">Item <a href="#t140">164</a>, Parent: <a href="#k156">156</a>, Children: <a href="#k166">166</a> <a href="#k167">167</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 342.649 301.406 145.538 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 164</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
        server spk-0 (enc (hash server spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))) (1 1))
  (label 164)
  (parent 156)
  (unrealized (5 0))
  (comment &quot;2 in cohort - 2 not yet seen&quot;))</pre>

<p id="k165">Item <a href="#t140">165</a>, Parent: <a href="#k157">157</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='829.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 829.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='114.960' x2='539.760' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='339.960' x2='439.800' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='414.960' x2='339.840' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='489.960' x2='239.880' y2='564.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='789.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 339.960 Q 542.760 302.460 445.800 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 189.960 Q 292.860 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='539.760' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='539.760' cy='114.960' r='6.000'/></g>
  <path
   d='M 439.800 414.960 Q 392.820 414.960 345.840 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle cx='439.800' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle style='fill: blue;' cx='439.800' cy='339.960' r='6.000'/></g>
  <path
   d='M 339.840 489.960 Q 292.860 489.960 245.880 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='414.960' r='6.000'/></g>
  <path
   d='M 239.880 564.960 Q 192.900 564.960 145.920 564.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='564.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 789.960 Q 92.940 789.960 45.960 789.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='789.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: red;' cx='139.920' cy='564.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='789.960' r='6.000'/></g>
  <path
   d='M 39.960 714.960 Q 86.940 714.960 133.920 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w y)))</title>
   <circle style='fill: blue;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server-0) (ca ca-1) (spk spk-1) (x x) (y y))</title>
   <text
    x='539.760' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul (rec x-0) w y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 165</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid auth ca-0 server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x-0) (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (4 0))
  (label 165)
  (parent 157)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k166">Item <a href="#t140">166</a>, Parent: <a href="#k164">164</a>.</p>

<div>
 <svg
  class='diagram' width='579.720pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 579.720 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='539.760' y1='189.960' x2='539.760' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 539.760 264.960 Q 342.649 301.406 145.538 412.852'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='264.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='189.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) x)</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 286.860 152.460 533.760 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y y))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='289.860' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 166</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) x))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0
      (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-0)
    (5 0))
  (label 166)
  (parent 164)
  (unrealized (0 2) (4 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k167">Item <a href="#t140">167</a>, Parent: <a href="#k164">164</a>, Children: <a href="#k168">168</a> <a href="#k169">169</a> <a href="#k170">170</a> <a href="#k171">171</a> <a href="#k172">172</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0)</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul (rec x) w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 167</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx) (w-0 expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
    (exp (gen) (mul (rec x) w y)) (5 0))
  (label 167)
  (parent 164)
  (unrealized (6 0))
  (comment &quot;5 in cohort - 5 not yet seen&quot;))</pre>

<p id="k168">Item <a href="#t140">168</a>, Parent: <a href="#k167">167</a>, Child: <a href="#k173">173</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 168</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-0 x) (w-0 (mul x w)) (y-0 y) (w-1 (mul w y)) (y-1 y)
      (w (mul w y))) (gen) (6 0))
  (label 168)
  (parent 167)
  (unrealized (0 2) (3 0) (4 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k169">Item <a href="#t140">169</a>, Parent: <a href="#k167">167</a>, Child: <a href="#k174">174</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w x x))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w x x))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x x)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 169</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 1 client-auth 1) (exp (gen) x-0)
    (6 0))
  (label 169)
  (parent 167)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k170">Item <a href="#t140">170</a>, Parent: <a href="#k167">167</a>, Child: <a href="#k175">175</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 114.960 Q 392.820 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w x-0))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w x-0))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-0 y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w x-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (x x-0))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 170</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid auth ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (6 0))
  (label 170)
  (parent 167)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k171">Item <a href="#t140">171</a>, Parent: <a href="#k167">167</a>, Children: <a href="#k176">176</a> <a href="#k177">177</a> <a href="#k178">178</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 171</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-0)
    (6 0))
  (label 171)
  (parent 167)
  (unrealized (0 2) (3 0) (4 0))
  (comment &quot;3 in cohort - 3 not yet seen&quot;))</pre>

<p id="k172">Item <a href="#t140">172</a>, Parent: <a href="#k167">167</a>, Child: <a href="#k179">179</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 392.820 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle style='fill: red;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 342.789 414.407 145.817 488.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w y))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 336.840 227.460 633.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w y)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server-0) (ca ca-1) (spk spk-1) (x x) (y y))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 172</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid auth ca-0 server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (6 0))
  (label 172)
  (parent 167)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k173">Item <a href="#t140">173</a>, Parent: <a href="#k168">168</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (gen) (mul w y))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (gen) (mul w y))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 342.840 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 173</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (label 173)
  (parent 168)
  (unrealized (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k174">Item <a href="#t140">174</a>, Parent: <a href="#k169">169</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='189.960' x2='739.680' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 264.960 Q 692.700 264.960 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='739.680' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='739.680' cy='189.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x) (mul w y))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 342.840 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w x x))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w x x))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w x x y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w x x y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w x x y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 386.820 152.460 733.680 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul w x x)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 174</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (label 174)
  (parent 169)
  (unrealized (0 0) (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k175">Item <a href="#t140">175</a>, Parent: <a href="#k170">170</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='189.960' x2='839.640' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='114.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='264.960' x2='639.720' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='339.960' x2='539.760' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 264.960 Q 742.680 227.460 645.720 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y</title><circle cx='839.640' cy='264.960' r='6.000'/></g>
  <g><title>y</title>
   <circle style='fill: red;' cx='839.640' cy='189.960' r='6.000'/></g>
  <path
   d='M 739.680 114.960 Q 392.820 77.460 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr-0 (exp (gen) x-0))</title>
   <circle cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 339.960 Q 592.740 339.960 545.760 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle cx='639.720' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) x-0) (mul w y))</title>
   <circle style='fill: blue;' cx='639.720' cy='264.960' r='6.000'/></g>
  <path
   d='M 539.760 414.960 Q 342.840 377.460 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='339.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w x-0))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w x-0))</title>
   <circle style='fill: red;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w x-0 y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w x-0 y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w x-0 y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 436.800 152.460 833.640 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w x-0)))</title>
   <circle style='fill: red;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g><title>((cr cr-0) (x x-0))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 175</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid auth ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (label 175)
  (parent 170)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k176">Item <a href="#t140">176</a>, Parent: <a href="#k171">171</a>, Child: <a href="#k180">180</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (rec x))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (rec x))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (one))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (one))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y (rec x)))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 176</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-0 x) (w (rec x))) (one) (4 0))
  (label 176)
  (parent 171)
  (unrealized (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k177">Item <a href="#t140">177</a>, Parent: <a href="#k171">171</a>, Child: <a href="#k181">181</a>.</p>

<div>
 <svg
  class='diagram' width='679.680pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 679.680 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w (rec x)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w (rec x)))</title>
   <circle style='fill: red;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: red;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y (rec x)))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='339.840' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 177</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x w) w (4 0))
  (label 177)
  (parent 171)
  (unrealized (5 0) (6 0))
  (comment &quot;1 in cohort - 1 not yet seen&quot;))</pre>

<p id="k178">Item <a href="#t140">178</a>, Parent: <a href="#k171">171</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 592.740 152.460 445.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x</title><circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>x</title>
   <circle style='fill: red;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul x w))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x w)))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 178</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (4 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul x w) (4 0))
  (label 178)
  (parent 171)
  (unrealized (0 2) (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k179">Item <a href="#t140">179</a>, Parent: <a href="#k172">172</a>.</p>

<div>
 <svg
  class='diagram' width='879.600pt' height='754.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 879.600 754.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='839.640' y1='264.960' x2='839.640' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='339.960' x2='639.720' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='414.960' x2='539.760' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='264.960' x2='439.800' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='339.960' x2='339.840' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='414.960' x2='239.880' y2='489.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='189.960' x2='139.920' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='189.960' x2='39.960' y2='714.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 839.640 339.960 Q 742.680 302.460 645.720 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>y-0</title><circle cx='839.640' cy='339.960' r='6.000'/></g>
  <g><title>y-0</title>
   <circle style='fill: red;' cx='839.640' cy='264.960' r='6.000'/></g>
  <path
   d='M 739.680 189.960 Q 392.820 152.460 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr-0 (exp (gen) y)) (enc (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)) (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) (cat server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (enc (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y)) server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1))) (invk spk-1))) (hash (exp (gen) (mul x y)) &quot;s hs traffic&quot; cr-0 sr-0)))</title>
   <circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr-0 (exp (gen) x))</title>
   <circle style='fill: blue;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 414.960 Q 592.740 414.960 545.760 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle cx='639.720' cy='414.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w y-0))</title>
   <circle style='fill: blue;' cx='639.720' cy='339.960' r='6.000'/></g>
  <path
   d='M 539.760 489.960 Q 342.840 452.460 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='414.960' r='6.000'/></g>
  <path
   d='M 439.800 339.960 Q 392.820 339.960 345.840 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w y))</title>
   <circle cx='439.800' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y-0) (mul x-0 w y))</title>
   <circle style='fill: red;' cx='439.800' cy='264.960' r='6.000'/></g>
  <path
   d='M 339.840 414.960 Q 292.860 414.960 245.880 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='414.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: red;' cx='339.840' cy='339.960' r='6.000'/></g>
  <path
   d='M 239.880 489.960 Q 192.900 489.960 145.920 489.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='489.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 714.960 Q 92.940 714.960 45.960 714.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='714.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y y-0))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='489.960' r='6.000'/></g>
  <path
   d='M 139.920 189.960 Q 92.940 189.960 45.960 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x-0))</title>
   <circle cx='139.920' cy='189.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='714.960' r='6.000'/></g>
  <path
   d='M 39.960 639.960 Q 86.940 639.960 133.920 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul x-0 w y y-0)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: red;' cx='39.960' cy='564.960' r='6.000'/></g>
  <path
   d='M 39.960 264.960 Q 236.880 227.460 433.800 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 264.960 Q 436.800 227.460 833.640 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y-0)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='264.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) (mul x-0 w y)))</title>
   <circle style='fill: red;' cx='39.960' cy='189.960' r='6.000'/></g>
  <g>
   <title>((cr cr-0) (sr sr-0) (server server-0) (ca ca-1) (spk spk-1) (x x) (y y))</title>
   <text
    x='739.680' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='439.800' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 179</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid auth ca-0 server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (6 0))
  (label 179)
  (parent 172)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k180">Item <a href="#t140">180</a>, Parent: <a href="#k176">176</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x</title><circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>x</title>
   <circle style='fill: red;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (rec x))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (rec x))</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (one))</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (one))</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g><title>(hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul y (rec x)))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) y) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) y) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) y) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)) (cat cr (gen)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (gen))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x (one)) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 180</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (rec x) (6 0))
  (label 180)
  (parent 176)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

<p id="k181">Item <a href="#t140">181</a>, Parent: <a href="#k177">177</a>.</p>

<div>
 <svg
  class='diagram' width='779.640pt' height='679.920pt'
  xmlns='http://www.w3.org/2000/svg' version='1.1'
  viewBox='0 0 779.640 679.920' font-size='12.000'>
  <defs>
   <marker
    id='arrow' orient='auto' markerWidth='5' markerHeight='10' refX='5'
    refY='5'>
    <path
     d='M 0 0 5 5 0 10'
     style='stroke-width: 2; fill: none; stroke: black;'/></marker>
   </defs>
  <line
   x1='739.680' y1='114.960' x2='739.680' y2='189.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='639.720' y1='189.960' x2='639.720' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='539.760' y1='264.960' x2='539.760' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='439.800' y1='189.960' x2='439.800' y2='264.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='339.840' y1='264.960' x2='339.840' y2='339.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='239.880' y1='339.960' x2='239.880' y2='414.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='139.920' y1='114.960' x2='139.920' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <line
   x1='39.960' y1='114.960' x2='39.960' y2='639.960'
   style='stroke-width: 0.960; stroke: gray;'/>
  <path
   d='M 739.680 189.960 Q 692.700 189.960 645.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>x</title><circle cx='739.680' cy='189.960' r='6.000'/></g>
  <g><title>x</title>
   <circle style='fill: red;' cx='739.680' cy='114.960' r='6.000'/></g>
  <path
   d='M 639.720 264.960 Q 592.740 264.960 545.760 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) (mul w (rec x)))</title>
   <circle cx='639.720' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) (mul w (rec x)))</title>
   <circle style='fill: blue;' cx='639.720' cy='189.960' r='6.000'/></g>
  <path
   d='M 539.760 339.960 Q 342.789 339.407 145.817 413.854'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle cx='539.760' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0)))</title>
   <circle style='fill: blue;' cx='539.760' cy='264.960' r='6.000'/></g>
  <path
   d='M 439.800 264.960 Q 392.820 264.960 345.840 264.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle cx='439.800' cy='264.960' r='6.000'/></g>
  <g><title>(cat (exp (gen) y) w)</title>
   <circle style='fill: blue;' cx='439.800' cy='189.960' r='6.000'/></g>
  <path
   d='M 339.840 339.960 Q 292.860 339.960 245.880 339.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='339.840' cy='339.960' r='6.000'/></g>
  <g>
   <title>(cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='339.840' cy='264.960' r='6.000'/></g>
  <path
   d='M 239.880 414.960 Q 192.900 414.960 145.920 414.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle cx='239.880' cy='414.960' r='6.000'/></g>
  <g>
   <title>(hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)</title>
   <circle style='fill: blue;' cx='239.880' cy='339.960' r='6.000'/></g>
  <path
   d='M 139.920 639.960 Q 92.940 639.960 45.960 639.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='139.920' cy='639.960' r='6.000'/></g>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='139.920' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle cx='139.920' cy='489.960' r='6.000'/></g>
  <g>
   <title>(cat (cat sr (exp (gen) (mul w y (rec x)))) (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) (cat server spk-0 (enc (hash server spk-0) (privk ca-0))) (enc (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x)))) server spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle style='fill: blue;' cx='139.920' cy='414.960' r='6.000'/></g>
  <path
   d='M 139.920 114.960 Q 92.940 114.960 45.960 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 139.920 114.960 Q 436.800 77.460 733.680 114.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g><title>(cat cr (exp (gen) x))</title>
   <circle cx='139.920' cy='114.960' r='6.000'/></g>
  <g>
   <title>(enc (cat auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server))) (enc auth authk (hash appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server)) (invk authk)) (hash &quot;c ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle style='fill: blue;' cx='39.960' cy='639.960' r='6.000'/></g>
  <path
   d='M 39.960 564.960 Q 86.940 564.960 133.920 564.960'
   style='stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(enc appid challenge (hash (hash (exp (gen) (mul w y)) &quot;derived&quot;) &quot;dual-binding&quot; cr sr appid challenge server) (hash &quot;s ap traffic&quot; cr sr (hash (exp (gen) (mul w y)) &quot;derived&quot;)))</title>
   <circle cx='39.960' cy='564.960' r='6.000'/></g>
  <g>
   <title>(enc (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)))) (hash (exp (gen) (mul w y)) &quot;c hs traffic&quot; cr sr))</title>
   <circle style='fill: blue;' cx='39.960' cy='489.960' r='6.000'/></g>
  <path
   d='M 39.960 189.960 Q 236.880 152.460 433.800 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <path
   d='M 39.960 189.960 Q 336.840 152.460 633.720 189.960'
   style='stroke-dasharray: 6.000,2.400; stroke-width: 0.960; stroke: black; marker-end: url(#arrow); fill: none;'/>
  <g>
   <title>(cat (cat sr (exp (gen) y)) (enc (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk)) (hash (hash &quot;finished&quot; (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)) (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) (cat server spk (enc (hash server spk) (privk ca))) (enc (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server spk (enc (hash server spk) (privk ca))) (invk spk))) (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr)))</title>
   <circle cx='39.960' cy='189.960' r='6.000'/></g>
  <g><title>(cat cr (exp (gen) w))</title>
   <circle style='fill: blue;' cx='39.960' cy='114.960' r='6.000'/></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca-0) (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))</title>
   <text
    x='139.920' y='77.460'
    style='text-anchor: middle;'>client-auth</text></g>
  <g>
   <title>((challenge challenge) (cr cr) (sr sr) (auth auth) (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w) (y y))</title>
   <text
    x='39.960' y='77.460'
    style='text-anchor: middle;'>server-auth</text></g>
  <text
   x='389.820' y='39.960'
   style='text-anchor: middle;'>uaf-dualbinding-tls13 181</text></svg>
 </div>

<pre>(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) (mul w y)) &quot;s hs traffic&quot; cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul w (rec x)) (6 0))
  (label 181)
  (parent 177)
  (unrealized (7 0))
  (dead)
  (comment &quot;empty cohort&quot;))</pre>

</body>
</html>
