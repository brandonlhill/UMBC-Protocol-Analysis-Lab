(herald "UAF using TLS1.3 with dual (server/client) exporter binding."
  (algebra diffie-hellman))

(comment "CPSA 3.6.11")
(comment "All input read from uaf-dualbinding-tls13.scm")

(defprotocol uaf-dualbinding-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x rndx)
    (y expt))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x)
  (uniq-orig cr)
  (goals
    (forall
      ((cr sr data) (challenge text) (authk spk akey)
        (server ca appid name) (x rndx) (z strd))
      (implies
        (and (p "client-reg" z 5) (p "client-reg" "cr" z cr)
          (p "client-reg" "sr" z sr)
          (p "client-reg" "challenge" z challenge)
          (p "client-reg" "authk" z authk) (p "client-reg" "spk" z spk)
          (p "client-reg" "appid" z appid)
          (p "client-reg" "server" z server) (p "client-reg" "ca" z ca)
          (p "client-reg" "x" z x) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen x) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p "server-reg" z-0 4)
            (p "server-reg" "challenge" z-0 challenge)
            (p "server-reg" "appid" z-0 appid)
            (p "server-reg" "server" z-0 server))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 0)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x rndx)
    (y x-0 expt) (y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 1)
  (parent 0)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 2)
  (parent 1)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 3)
  (parent 1)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 1 2 server-reg 4)
    (enc username appid challenge
      (hash (hash (exp (gen) (mul x y-0)) "derived") "dual-binding" cr
        sr username appid challenge server)
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 4)
  (parent 2)
  (unrealized (1 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc username appid challenge
      (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr sr
        username appid challenge server)
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 5)
  (parent 2)
  (unrealized (0 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 3 server-reg 4)
    (enc username appid challenge
      (hash (hash (exp (gen) (mul x-0 y-1)) "derived") "dual-binding" cr
        sr username appid challenge server)
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 6)
  (parent 3)
  (unrealized (2 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc username appid challenge
      (hash (hash (exp (gen) (mul x-0 y-0)) "derived") "dual-binding" cr
        sr username appid challenge server)
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 7)
  (parent 3)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (y x rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 8)
  (parent 4)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (x x) (username username)
        (auth auth) (y y))))
  (origs (cr (0 0))))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 9)
  (parent 4)
  (unrealized (1 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 10)
  (parent 5)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y y-0 x-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y y-0 x-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 11)
  (parent 6)
  (seen 8)
  (unrealized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 12)
  (parent 6)
  (unrealized (2 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 13)
  (parent 7)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 14)
  (parent 9)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 15)
  (parent 10)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 16)
  (parent 12)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 17)
  (parent 13)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 18)
  (parent 14)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server appid username auth ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 19)
  (parent 14)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 20)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 21)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 22)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid username auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 23)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 24)
  (parent 17)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 25)
  (parent 17)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-dualbinding-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x rndx) (y expt))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x)
  (uniq-orig cr)
  (goals
    (forall
      ((cr sr data) (challenge text) (authk spk akey)
        (server ca appid name) (x rndx) (z strd))
      (implies
        (and (p "client-auth" z 5) (p "client-auth" "cr" z cr)
          (p "client-auth" "sr" z sr)
          (p "client-auth" "challenge" z challenge)
          (p "client-auth" "authk" z authk)
          (p "client-auth" "spk" z spk)
          (p "client-auth" "appid" z appid)
          (p "client-auth" "server" z server)
          (p "client-auth" "ca" z ca) (p "client-auth" "x" z x)
          (non (invk authk)) (non (invk spk)) (non (privk ca)) (ugen x)
          (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p "server-auth" z-0 4)
            (p "server-auth" "challenge" z-0 challenge)
            (p "server-auth" "appid" z-0 appid)
            (p "server-auth" "server" z-0 server))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 26)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x rndx) (y x-0 expt)
    (y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 27)
  (parent 26)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 28)
  (parent 27)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 29)
  (parent 27)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc appid challenge
      (hash (hash (exp (gen) (mul x y-0)) "derived") "dual-binding" cr
        sr appid challenge server)
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 30)
  (parent 28)
  (unrealized (1 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc appid challenge
      (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr sr
        appid challenge server)
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 31)
  (parent 28)
  (unrealized (0 3) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 3 server-auth 4)
    (enc appid challenge
      (hash (hash (exp (gen) (mul x-0 y-1)) "derived") "dual-binding" cr
        sr appid challenge server)
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 32)
  (parent 29)
  (unrealized (2 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc appid challenge
      (hash (hash (exp (gen) (mul x-0 y-0)) "derived") "dual-binding" cr
        sr appid challenge server)
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 33)
  (parent 29)
  (unrealized (0 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (y x rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 34)
  (parent 30)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (x x) (auth auth) (y y))))
  (origs (cr (0 0))))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 35)
  (parent 30)
  (unrealized (1 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 36)
  (parent 31)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y y-0 x-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y y-0 x-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 37)
  (parent 32)
  (seen 34)
  (unrealized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 38)
  (parent 32)
  (unrealized (2 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 39)
  (parent 33)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 40)
  (parent 35)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 41)
  (parent 36)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 42)
  (parent 38)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 43)
  (parent 39)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 44)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server appid auth ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 45)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 46)
  (parent 41)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 47)
  (parent 41)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 48)
  (parent 42)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server appid auth ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 49)
  (parent 42)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 50)
  (parent 43)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 51)
  (parent 43)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-dualbinding-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid username auth name) (authk spk akey) (y rndx)
    (x expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y)
  (uniq-orig challenge sr)
  (goals
    (forall
      ((sr data) (challenge text) (authk spk akey)
        (server ca appid name) (y rndx) (z strd))
      (implies
        (and (p "server-reg" z 5) (p "server-reg" "sr" z sr)
          (p "server-reg" "challenge" z challenge)
          (p "server-reg" "authk" z authk) (p "server-reg" "spk" z spk)
          (p "server-reg" "server" z server)
          (p "server-reg" "appid" z appid) (p "server-reg" "ca" z ca)
          (p "server-reg" "y" z y) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen y) (uniq-at challenge z 3)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p "client-reg" z-0 5)
            (p "client-reg" "challenge" z-0 challenge)
            (p "client-reg" "server" z-0 server)
            (p "client-reg" "appid" z-0 appid))))))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 52)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (y rndx) (x expt) (x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y-0))
  (precedes ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-reg 5)
    (hash "key handle" (invk authk) username) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr-0 sr-0 username appid-0 challenge-0
            server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 53)
  (parent 52)
  (unrealized (0 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-reg 5)
    (enc auth-0 authk
      (hash appid-0 challenge-0
        (hash (hash (exp (gen) (mul x-0 y-1)) "derived") "dual-binding"
          cr-0 sr-0 username appid-0 challenge-0 server-0))
      (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))))
  (label 54)
  (parent 53)
  (unrealized (0 2) (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-reg 5)
    (enc auth authk
      (hash appid challenge
        (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
          "dual-binding" cr sr username appid challenge server))
      (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))))
  (label 55)
  (parent 53)
  (unrealized (0 2) (2 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server
          spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0))
        (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server
            spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 56)
  (parent 54)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
        (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            server spk-0 (enc (hash server spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 57)
  (parent 54)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 3 0 server-auth 2)
    (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
      (enc
        (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server
          spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1))
        (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server
            spk-1 (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
      (hash (exp (gen) (mul x-0 y-1)) "s hs traffic" cr sr)) (2 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 58)
  (parent 55)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
    (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
          (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
        (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
            (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
      (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)) (2 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
  (label 59)
  (parent 55)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 60)
  (parent 56)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (username username)
        (auth auth) (cr cr) (x x))))
  (origs (challenge (0 3)) (sr (0 1))))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 61)
  (parent 56)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 62)
  (parent 57)
  (unrealized (0 2) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 3 2 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 63)
  (parent 58)
  (seen 60)
  (unrealized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 64)
  (parent 58)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
  (label 65)
  (parent 59)
  (unrealized (0 2) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 66)
  (parent 61)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 4 0 server-auth 2) (exp (gen) y-0)
    (3 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr))))
  (label 67)
  (parent 62)
  (unrealized (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (y expt) (y-0 rndx) (w expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0 (rec w))) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x y y-0 (rec w))) w))
    (exp (gen) (mul x y y-0)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0 (rec w))) w))
      (send (cat (exp (gen) (mul x y y-0 (rec w))) w))))
  (label 68)
  (parent 62)
  (unrealized (0 2) (4 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 69)
  (parent 64)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (precedes ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-1)
    (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr))))
  (label 70)
  (parent 65)
  (unrealized (2 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (y-0 expt) (y-1 rndx) (w expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
    (exp (gen) (mul x-0 y-0 y-1)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
      (send (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))))
  (label 71)
  (parent 65)
  (unrealized (0 2) (5 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 72)
  (parent 66)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 73)
  (parent 66)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (3 0)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
        server spk-0 (enc (hash server spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0))))))
  (label 74)
  (parent 67)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (contracted (x-0 x) (y-0 (mul (rec x) w)) (y-1 y) (w-0 (mul w y))
      (y-2 y) (w (mul w y))) (gen) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 75)
  (parent 68)
  (unrealized (1 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 1 client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 76)
  (parent 68)
  (unrealized (0 2) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 77)
  (parent 68)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 78)
  (parent 68)
  (unrealized (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (ca username auth server ca-0 appid server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-1
              (enc (hash server-0 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-1
                (enc (hash server-0 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-1
                  (enc (hash server-0 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 79)
  (parent 68)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 80)
  (parent 69)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 81)
  (parent 69)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
        (enc (hash server spk-1) (privk ca-1))))
    (hash (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1))))))
  (label 82)
  (parent 70)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test
    (contracted (x-1 x-0) (y-1 (mul (rec x-0) w)) (y-2 y-0)
      (w-0 (mul w y-0)) (y-3 y-0) (w (mul w y-0))) (gen) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0)))))
  (label 83)
  (parent 71)
  (unrealized (2 1) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (y expt) (x rndx) (w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x)
    (y (mul (rec x) w x-0 y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 1 client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul y x-0)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 84)
  (parent 71)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 2 client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 85)
  (parent 71)
  (unrealized (0 2) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w x-1 y-0)))
  (deflistener (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 0) (0 0)))
  (absent (y-0 (exp (gen) (mul w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))))
  (label 86)
  (parent 71)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w))))
  (label 87)
  (parent 71)
  (unrealized (2 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      server-1 ca-2 name) (authk spk spk-0 spk-1 spk-2 akey) (x rndx)
    (y x-0 expt) (x-1 rndx) (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1)
    (y (mul (rec x-1) w y-0 y-1)))
  (deflistener (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-1)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (0 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-1 spk-2
              (enc (hash server-1 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-1 spk-2
                (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-1 spk-2
                (enc (hash server-1 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-1 spk-2
                  (enc (hash server-1 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))))
  (label 88)
  (parent 71)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (rec x)) y))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x)) y))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (rec x)) y))
      (send (cat (exp (gen) (rec x)) y))))
  (label 89)
  (parent 74)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 90)
  (parent 74)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 91)
  (parent 75)
  (unrealized (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 92)
  (parent 76)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 93)
  (parent 77)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 5 0 server-auth 2)
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server spk-0
      (enc (hash server spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 94)
  (parent 78)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
        server spk-0 (enc (hash server spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
          (enc (hash server spk-0) (privk ca-0))))))
  (label 95)
  (parent 78)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (ca username auth server ca-0 appid server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-1
              (enc (hash server-0 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-1
                (enc (hash server-0 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-1
                  (enc (hash server-0 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 96)
  (parent 79)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) (rec x-0)) y-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)) ((6 1) (5 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x-0)) y-0))
    (exp (gen) (mul (rec x-0) y-0)) (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) (rec x-0)) y-0))
      (send (cat (exp (gen) (rec x-0)) y-0))))
  (label 97)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)) ((6 1) (5 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul (rec x-0) y-0)) (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 98)
  (parent 82)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0))))
    ((recv y-0) (send y-0)))
  (label 99)
  (parent 83)
  (unrealized (2 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (y expt) (x rndx) (w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x)
    (y (mul (rec x) w x-0 y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul y x-0)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 100)
  (parent 84)
  (unrealized (0 2) (2 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 101)
  (parent 85)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w x-1 y-0)))
  (deflistener (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (deflistener y-0)
  (precedes ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 0) (0 0)) ((7 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))) ((recv y-0) (send y-0)))
  (label 102)
  (parent 86)
  (unrealized (0 2) (2 1) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 6 0 server-auth 2)
    (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server spk-1
      (enc (hash server spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 103)
  (parent 87)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (precedes ((0 1) (5 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
        (enc (hash server spk-1) (privk ca-1))))
    (hash (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1))))))
  (label 104)
  (parent 87)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      server-1 ca-2 name) (authk spk spk-0 spk-1 spk-2 akey) (x rndx)
    (y x-0 expt) (x-1 rndx) (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1)
    (y (mul (rec x-1) w y-0 y-1)))
  (deflistener (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-1)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (deflistener y-1)
  (precedes ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (0 0)) ((7 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-1) (mul w y-1) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server
                spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-1 spk-2
              (enc (hash server-1 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-1 spk-2
                (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-1 spk-2
                (enc (hash server-1 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-1 spk-2
                  (enc (hash server-1 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))) ((recv y-1) (send y-1)))
  (label 105)
  (parent 88)
  (unrealized (0 2) (2 1) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0
      (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0
          (enc (hash server spk-0) (privk ca-0))))))
  (label 106)
  (parent 95)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx) (w-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
    (exp (gen) (mul (rec x) w y)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
          (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))))
  (label 107)
  (parent 95)
  (unrealized (6 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (precedes ((0 1) (5 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-1)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0)))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
         spk-1 (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
          spk-1 (enc (hash server spk-1) (privk ca-1))))))
  (label 108)
  (parent 104)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx) (w-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener
      (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
    (exp (gen) (mul (rec x-0) w y-0)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) w y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))))
  (label 109)
  (parent 104)
  (unrealized (7 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-0 x) (w-0 (mul x w)) (y-0 y) (w-1 (mul w y)) (y-1 y)
      (w (mul w y))) (gen) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
         spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 110)
  (parent 107)
  (unrealized (0 2) (3 0) (4 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 1 client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x x y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x x y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 111)
  (parent 107)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 112)
  (parent 107)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
         spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 113)
  (parent 107)
  (unrealized (0 2) (3 0) (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (ca username auth server ca-0 appid server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-1
              (enc (hash server-0 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-1
                (enc (hash server-0 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-1
                  (enc (hash server-0 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 114)
  (parent 107)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (gen) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-1 x-0) (w-0 (mul x-0 w)) (y-1 y-0) (w-1 (mul w y-0))
      (y-2 y-0) (w (mul w y-0))) (gen) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server spk-1 (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server spk-1 (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0)))))
  (label 115)
  (parent 109)
  (unrealized (0 2) (4 0) (5 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (y expt) (x rndx) (w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 1 client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul y x-0)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x w x-0)))
      (send (cat (exp (gen) y-0) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
         server spk-1 (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
          server spk-1 (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 116)
  (parent 109)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w x-0 x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul w x-0 x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 2 client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0 x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w x-0 x-0)))
      (send (cat (exp (gen) y-0) (mul w x-0 x-0))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 117)
  (parent 109)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w x-1)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 0) (0 0)))
  (absent (y-0 (exp (gen) (mul x-0 w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-1 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-1 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w x-1)))
      (send (cat (exp (gen) y-0) (mul x-0 w x-1))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))))
  (label 118)
  (parent 109)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) w))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 0 server-auth 2) (exp (gen) y-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server spk-1 (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server spk-1 (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w))))
  (label 119)
  (parent 109)
  (unrealized (0 2) (4 0) (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      server-1 ca-2 name) (authk spk spk-0 spk-1 spk-2 akey) (x rndx)
    (y x-0 expt) (x-1 rndx) (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) (mul x-1 w y-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-1)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (0 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul x-1 w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y-0)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-1 w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
            (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 y-1)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul w y-0 y-1)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) (mul x-1 w y-0)))
      (send (cat (exp (gen) y-1) (mul x-1 w y-0))))
    ((recv
       (cat (cat cr (exp (gen) x-1))
         (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-1 spk-2
              (enc (hash server-1 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-1 spk-2
                (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-1 spk-2
                (enc (hash server-1 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-1 spk-2
                  (enc (hash server-1 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))))
  (label 120)
  (parent 109)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
         spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 121)
  (parent 110)
  (unrealized (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x x y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x x y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 122)
  (parent 111)
  (unrealized (0 0) (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 123)
  (parent 112)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-0 x) (w (rec x))) (one) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))))
  (label 124)
  (parent 113)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x w) w (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
          (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))))
  (label 125)
  (parent 113)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (4 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul x w) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
         spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv x) (send x)))
  (label 126)
  (parent 113)
  (unrealized (0 2) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (ca username auth server ca-0 appid server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-1
              (enc (hash server-0 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-1
                (enc (hash server-0 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-1
                  (enc (hash server-0 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 127)
  (parent 114)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (gen) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server spk-1 (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server spk-1 (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0))))
    ((recv y-0) (send y-0)))
  (label 128)
  (parent 115)
  (unrealized (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (y expt) (x rndx) (w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul y x-0)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x w x-0)))
      (send (cat (exp (gen) y-0) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
         server spk-1 (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
          server spk-1 (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 129)
  (parent 116)
  (unrealized (0 0) (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w x-0 x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul w x-0 x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0 x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w x-0 x-0)))
      (send (cat (exp (gen) y-0) (mul w x-0 x-0))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-0 y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 130)
  (parent 117)
  (unrealized (0 0) (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w x-1)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (9 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 0) (0 0))
    ((9 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x-0 w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-1 y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-1 y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w x-1)))
      (send (cat (exp (gen) y-0) (mul x-0 w x-1))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-1 y-0))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))) ((recv y-0) (send y-0)))
  (label 131)
  (parent 118)
  (unrealized (0 0) (0 2) (4 0) (5 0) (9 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul y-0 (rec x-0))))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (rec x-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-1 x-0) (w (rec x-0))) (one)
    (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 (rec x-0))))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 (rec x-0))))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (one)))
      (send (cat (exp (gen) y-0) (one))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (rec x-0)))
      (send (cat (exp (gen) y-0) (rec x-0)))))
  (label 132)
  (parent 119)
  (unrealized (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul w y-0 (rec x-0))))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w (rec x-0))))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (x-0 w) (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x-0 w) w (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 (rec x-0))))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w y-0 (rec x-0))))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w (rec x-0))))
      (send (cat (exp (gen) y-0) (mul w (rec x-0))))))
  (label 133)
  (parent 119)
  (unrealized (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt) (x-0 rndx)
    (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (5 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (mul x-0 w) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server spk-1 (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server spk-1 (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv x-0) (send x-0)))
  (label 134)
  (parent 119)
  (unrealized (0 2) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      server-1 ca-2 name) (authk spk spk-0 spk-1 spk-2 akey) (x rndx)
    (y x-0 expt) (x-1 rndx) (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) (mul x-1 w y-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1)))
      server spk-1 (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-1)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (deflistener y-1)
  (precedes ((0 1) (5 0)) ((0 1) (9 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (0 0))
    ((9 1) (7 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul x-1 w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-1) (mul w y-1) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-1 w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
            (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 y-1)))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul w y-0 y-1)))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
            "dual-binding" cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) (mul x-1 w y-0)))
      (send (cat (exp (gen) y-1) (mul x-1 w y-0))))
    ((recv
       (cat (cat cr (exp (gen) x-1))
         (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul w y-0 y-1))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-1 spk-2
              (enc (hash server-1 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-1 spk-2
                (enc (hash server-1 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-1 spk-2
                (enc (hash server-1 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-1 spk-2
                  (enc (hash server-1 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))) ((recv y-1) (send y-1)))
  (label 135)
  (parent 120)
  (unrealized (0 0) (0 2) (4 0) (5 0) (9 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (rec x) (6 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))) ((recv x) (send x)))
  (label 136)
  (parent 124)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (cr sr data)
    (ca username auth server ca-0 appid name) (authk spk spk-0 akey)
    (w expt) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul w (rec x)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
          (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))) ((recv x) (send x)))
  (label 137)
  (parent 125)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y expt)
    (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul y-0 (rec x-0))))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (rec x-0)))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (rec x-0) (7 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 (rec x-0))))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
                  (enc (hash server spk-1) (privk ca-1))) (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 (rec x-0))))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
                  (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr sr
            username appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived") "dual-binding" cr
                sr username appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (one)))
      (send (cat (exp (gen) y-0) (one))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 (rec x-0)))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (rec x-0)))
      (send (cat (exp (gen) y-0) (rec x-0)))) ((recv x-0) (send x-0)))
  (label 138)
  (parent 132)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 ca-1
      name) (authk spk spk-0 spk-1 akey) (x rndx) (y w expt)
    (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul w y-0 (rec x-0))))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
      (enc (hash server spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w (rec x-0))))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (x-0 w) (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (mul w (rec x-0)) (7 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding"
            cr-0 sr-0 username appid-0 challenge-0 server-0)
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr-0 sr-0 username appid-0 challenge-0
                server-0)) (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 (rec x-0))))
          (enc (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w y-0 (rec x-0))))
            (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
                (enc (hash server spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server spk-1 (enc (hash server spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server
                  spk-1 (enc (hash server spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul w y-0)) "derived") "dual-binding"
            cr sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
         (enc (hash server spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server spk-1
          (enc (hash server spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w (rec x-0))))
      (send (cat (exp (gen) y-0) (mul w (rec x-0)))))
    ((recv x-0) (send x-0)))
  (label 139)
  (parent 133)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-dualbinding-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr username appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr username appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (auth server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (y rndx) (x expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y)
  (uniq-orig challenge sr)
  (goals
    (forall
      ((sr data) (challenge text) (authk spk akey)
        (server ca appid name) (y rndx) (z strd))
      (implies
        (and (p "server-auth" z 5) (p "server-auth" "sr" z sr)
          (p "server-auth" "challenge" z challenge)
          (p "server-auth" "authk" z authk)
          (p "server-auth" "spk" z spk)
          (p "server-auth" "server" z server)
          (p "server-auth" "appid" z appid) (p "server-auth" "ca" z ca)
          (p "server-auth" "y" z y) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen y) (uniq-at challenge z 3)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p "client-auth" z-0 5)
            (p "client-auth" "challenge" z-0 challenge)
            (p "client-auth" "server" z-0 server)
            (p "client-auth" "appid" z-0 appid))))))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 140)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y y-0)))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-auth 5)
    (enc auth authk
      (hash appid challenge
        (hash (hash (exp (gen) (mul x y y-0)) "derived") "dual-binding"
          cr sr appid challenge server)) (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))))
  (label 141)
  (parent 140)
  (unrealized (0 2) (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server
          spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0))
        (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server
            spk-0 (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 142)
  (parent 141)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
        (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            server spk-0 (enc (hash server spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 143)
  (parent 141)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 144)
  (parent 142)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (auth auth) (cr cr)
        (x x))))
  (origs (challenge (0 3)) (sr (0 1))))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 145)
  (parent 142)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 146)
  (parent 143)
  (unrealized (0 2) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 147)
  (parent 145)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 4 0 server-auth 2) (exp (gen) y-0)
    (3 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr))))
  (label 148)
  (parent 146)
  (unrealized (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx) (w expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0 (rec w))) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x y y-0 (rec w))) w))
    (exp (gen) (mul x y y-0)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0 (rec w))) w))
      (send (cat (exp (gen) (mul x y y-0 (rec w))) w))))
  (label 149)
  (parent 146)
  (unrealized (0 2) (4 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 150)
  (parent 147)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 151)
  (parent 147)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (3 0)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
        server spk-0 (enc (hash server spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0))))))
  (label 152)
  (parent 148)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (contracted (x-0 x) (y-0 (mul (rec x) w)) (y-1 y) (w-0 (mul w y))
      (y-2 y) (w (mul w y))) (gen) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 153)
  (parent 149)
  (unrealized (1 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 1 client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 154)
  (parent 149)
  (unrealized (0 2) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid auth ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x-0 y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x-0 y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 155)
  (parent 149)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 156)
  (parent 149)
  (unrealized (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid auth ca-0 server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x-0) (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-1
              (enc (hash server-0 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-1
                (enc (hash server-0 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-1
                  (enc (hash server-0 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 157)
  (parent 149)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (rec x)) y))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x)) y))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (rec x)) y))
      (send (cat (exp (gen) (rec x)) y))))
  (label 158)
  (parent 152)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 159)
  (parent 152)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 160)
  (parent 153)
  (unrealized (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 161)
  (parent 154)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid auth ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x-0 y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x-0 y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 162)
  (parent 155)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 5 0 server-auth 2)
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server spk-0
      (enc (hash server spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 163)
  (parent 156)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
        server spk-0 (enc (hash server spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
          (enc (hash server spk-0) (privk ca-0))))))
  (label 164)
  (parent 156)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid auth ca-0 server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x-0) (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server
                  spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-1
              (enc (hash server-0 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-1
                (enc (hash server-0 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-1
                  (enc (hash server-0 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 165)
  (parent 157)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x x) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0
      (enc (hash server spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk-0 (enc (hash server spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk-0 (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk-0
          (enc (hash server spk-0) (privk ca-0))))))
  (label 166)
  (parent 164)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx) (w-0 expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
    (exp (gen) (mul (rec x) w y)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server spk-0
          (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))))
  (label 167)
  (parent 164)
  (unrealized (6 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-0 x) (w-0 (mul x w)) (y-0 y) (w-1 (mul w y)) (y-1 y)
      (w (mul w y))) (gen) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
         spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 168)
  (parent 167)
  (unrealized (0 2) (3 0) (4 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 1 client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x x y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x x y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 169)
  (parent 167)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid auth ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 170)
  (parent 167)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
         spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 171)
  (parent 167)
  (unrealized (0 2) (3 0) (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid auth ca-0 server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-1
              (enc (hash server-0 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-1
                (enc (hash server-0 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-1
                  (enc (hash server-0 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 172)
  (parent 167)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
         spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 173)
  (parent 168)
  (unrealized (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul w x x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x x y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w x x y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 174)
  (parent 169)
  (unrealized (0 0) (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid auth ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 175)
  (parent 170)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-0 x) (w (rec x))) (one) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))))
  (label 176)
  (parent 171)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x w) w (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
          (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))))
  (label 177)
  (parent 171)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
      spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (4 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul x w) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x w y)) "derived") "dual-binding"
            cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server
         spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv x) (send x)))
  (label 178)
  (parent 171)
  (unrealized (0 2) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid auth ca-0 server-0 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-0)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
            "dual-binding" cr sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-1
              (enc (hash server-0 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-1 (enc (hash server-0 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-1
                (enc (hash server-0 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-1
                  (enc (hash server-0 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 179)
  (parent 172)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (rec x) (6 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
            appid challenge server)
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived") "dual-binding" cr sr
                appid challenge server)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server spk-0 (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server spk-0 (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))) ((recv x) (send x)))
  (label 180)
  (parent 176)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-dualbinding-tls13
  (vars (challenge text) (sr cr data) (server ca appid auth ca-0 name)
    (authk spk spk-0 akey) (w expt) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca) (appid appid) (authk authk)
    (spk spk) (x w) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (auth auth) (server server) (ca ca-0) (appid appid) (authk authk)
    (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server spk-0 (enc (hash server spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul w (rec x)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0))) (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                (enc (hash server spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server spk-0 (enc (hash server spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
                  (enc (hash server spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash (hash (exp (gen) (mul w y)) "derived") "dual-binding" cr
            sr appid challenge server)
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "dual-binding" cr sr appid challenge server))
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
         (enc (hash server spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server spk-0
          (enc (hash server spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))) ((recv x) (send x)))
  (label 181)
  (parent 177)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")
