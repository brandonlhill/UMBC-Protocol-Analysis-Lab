(herald "UAF using TLS1.3 with exporter channel binding."
  (algebra diffie-hellman))

(comment "CPSA 3.6.11")
(comment "All input read from uaf-exporter-tls13.scm")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x rndx)
    (y expt))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x)
  (uniq-orig cr)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 0)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth appid name) (authk spk akey) (x rndx)
    (y x-0 expt) (y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 1)
  (parent 0)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 2)
  (parent 1)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth appid name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 3)
  (parent 1)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username auth appid server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 1 2 server-reg 4)
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 4)
  (parent 2)
  (unrealized (1 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 5)
  (parent 2)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username auth appid server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 3 server-reg 4)
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 6)
  (parent 3)
  (unrealized (2 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth appid name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 7)
  (parent 3)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username auth appid server ca name) (authk spk akey) (y x rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 8)
  (parent 4)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (cr cr) (sr sr) (authk authk) (spk spk)
        (username username) (auth auth) (appid appid)
        (challenge challenge) (x x) (y y))))
  (origs (cr (0 0))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username auth appid server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 9)
  (parent 4)
  (unrealized (1 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 10)
  (parent 5)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username auth appid server ca name) (authk spk akey) (x expt)
    (y y-0 x-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y y-0 x-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 11)
  (parent 6)
  (seen 8)
  (unrealized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username auth appid server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 12)
  (parent 6)
  (unrealized (2 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth appid name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 13)
  (parent 7)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username auth appid server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 14)
  (parent 9)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 15)
  (parent 10)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username auth appid server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 16)
  (parent 12)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth appid name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 17)
  (parent 13)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username auth appid server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 18)
  (parent 14)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username auth appid server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 19)
  (parent 14)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 20)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 21)
  (parent 15)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username auth appid server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 22)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username auth appid server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 23)
  (parent 16)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth appid name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 24)
  (parent 17)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth appid name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 25)
  (parent 17)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x rndx) (y expt))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x)
  (uniq-orig cr)
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 26)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x rndx) (y x-0 expt) (y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 27)
  (parent 26)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 28)
  (parent 27)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 29)
  (parent 27)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 30)
  (parent 28)
  (unrealized (1 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 31)
  (parent 28)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 3 server-auth 4)
    (enc appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 32)
  (parent 29)
  (unrealized (2 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 33)
  (parent 29)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (y x rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 34)
  (parent 30)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (cr cr) (sr sr) (authk authk) (spk spk)
        (appid appid) (challenge challenge) (x x) (y y))))
  (origs (cr (0 0))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 35)
  (parent 30)
  (unrealized (1 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 36)
  (parent 31)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y y-0 x-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y y-0 x-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 37)
  (parent 32)
  (seen 34)
  (unrealized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 38)
  (parent 32)
  (unrealized (2 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 39)
  (parent 33)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 40)
  (parent 35)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 41)
  (parent 36)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 42)
  (parent 38)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 43)
  (parent 39)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 44)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 45)
  (parent 40)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 46)
  (parent 41)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 47)
  (parent 41)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 48)
  (parent 42)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 49)
  (parent 42)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 50)
  (parent 43)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 51)
  (parent 43)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid name) (authk spk akey) (x expt)
    (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y)
  (uniq-orig challenge sr username)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 52)
  (unrealized (0 4))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x expt) (y x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y-0))
  (precedes ((0 3) (1 3)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0)
  (uniq-orig challenge sr username)
  (operation encryption-test (added-strand client-reg 5)
    (hash "key handle" (invk authk) username) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 53)
  (parent 52)
  (unrealized (0 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 2 1 client-reg 5)
    (enc auth-0 authk
      (hash appid-0 challenge-0
        (hash (hash (exp (gen) (mul x-0 y-1)) "derived")
          "uaf-exporter-binding" cr-0 sr-0 challenge-0)) (invk authk))
    (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))))
  (label 54)
  (parent 53)
  (unrealized (0 2) (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (precedes ((0 1) (2 1)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr username)
  (operation encryption-test (added-strand client-reg 5)
    (enc auth authk
      (hash appid challenge
        (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
          "uaf-exporter-binding" cr sr challenge)) (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))))
  (label 55)
  (parent 53)
  (unrealized (0 2) (0 4) (1 3) (2 1) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0
          spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0
            spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 56)
  (parent 54)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 57)
  (parent 54)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 3 0 server-auth 2)
    (enc (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
      (enc
        (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server-1
          spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1))
        (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1))
            server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
          (invk spk-1)))
      (hash (exp (gen) (mul x-0 y-1)) "s hs traffic" cr sr)) (2 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 58)
  (parent 55)
  (unrealized (0 2) (0 4) (1 3) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
    (enc (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
        (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
            (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1)))
      (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)) (2 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
  (label 59)
  (parent 55)
  (unrealized (0 2) (0 4) (1 3) (2 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth appid name) (authk spk akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 60)
  (parent 56)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((username username) (server server) (ca ca) (sr sr)
        (challenge challenge) (authk authk) (spk spk) (auth auth)
        (appid appid) (cr cr) (x x) (y y))))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 61)
  (parent 56)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 62)
  (parent 57)
  (unrealized (0 2) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 3 0 server-reg 4)
    (enc username-0 appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (2 3))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 63)
  (parent 58)
  (unrealized (0 2) (1 3))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc username-0 appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (2 3))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 64)
  (parent 58)
  (unrealized (0 2) (0 4) (1 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
  (label 65)
  (parent 59)
  (unrealized (0 2) (1 3) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 66)
  (parent 61)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 4 0 server-auth 2) (exp (gen) y-0)
    (3 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr))))
  (label 67)
  (parent 62)
  (unrealized (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx) (w expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0 (rec w))) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr username)
  (precur (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x y y-0 (rec w))) w))
    (exp (gen) (mul x y y-0)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0 (rec w))) w))
      (send (cat (exp (gen) (mul x y y-0 (rec w))) w))))
  (label 68)
  (parent 62)
  (unrealized (0 2) (4 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation nonce-test
    (contracted (appid-0 appid) (challenge-0 challenge) (cr-0 cr)
      (sr-0 sr) (x-1 x) (y-0 (mul (rec x) x-0 y)) (x-2 x-0) (y-1 y))
    username (1 3)
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))))
  (label 69)
  (parent 63)
  (unrealized (0 2) (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (1 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation nonce-test (displaced 3 2 client-reg 5) username (1 3)
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-1)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 70)
  (parent 63)
  (unrealized (0 2) (1 3))
  (comment "4 in cohort - 4 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test (displaced 3 0 server-reg 4) username (1 3)
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-1)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 71)
  (parent 63)
  (seen 86)
  (unrealized (0 2) (1 3))
  (comment "3 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) username (1 3)
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 72)
  (parent 63)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3))
    ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 73)
  (parent 64)
  (unrealized (0 2) (1 3) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-1)
    (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr))))
  (label 74)
  (parent 65)
  (unrealized (2 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (y-0 expt) (y-1 rndx) (w expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr username)
  (precur (5 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
    (exp (gen) (mul x-0 y-0 y-1)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
      (send (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))))
  (label 75)
  (parent 65)
  (unrealized (0 2) (1 3) (5 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 76)
  (parent 66)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 77)
  (parent 66)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (3 0)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
        server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 78)
  (parent 67)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (precur (4 0))
  (operation nonce-test
    (contracted (x-0 x) (y-0 (mul (rec x) w)) (y-1 y) (w-0 (mul w y))
      (y-2 y) (w (mul w y))) (gen) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 79)
  (parent 68)
  (unrealized (1 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 5 1 client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 80)
  (parent 68)
  (unrealized (0 2) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 81)
  (parent 68)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 82)
  (parent 68)
  (unrealized (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username server ca auth server-0 ca-0 appid server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 83)
  (parent 68)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 1)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) x-0 y)))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
            (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
  (label 84)
  (parent 69)
  (unrealized (0 2) (1 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr auth)
  (operation nonce-test
    (contracted (appid-0 appid) (challenge-0 challenge) (cr-0 cr)
      (sr-0 sr) (x-1 x) (y-0 (mul (rec x) x-0 y)) (x-2 x-0) (y-1 y))
    auth (1 3)
    (enc auth appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived")))
    (enc (hash "key handle" (invk authk) auth)
      (cat auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))))
  (label 85)
  (parent 70)
  (unrealized (0 2) (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (1 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test (displaced 3 0 server-reg 4) auth-0 (1 3)
    (enc auth-0 appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-1)) "derived")))
    (enc (hash "key handle" (invk authk) auth-0)
      (cat auth-0 authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc auth-0 authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-1 y-1)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-1 y-1)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 86)
  (parent 70)
  (unrealized (0 2) (1 3))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation nonce-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) auth (1 3)
    (enc auth appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc (hash "key handle" (invk authk) auth)
      (cat auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 87)
  (parent 70)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation nonce-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) auth (1 3)
    (enc auth appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc (hash "key handle" (invk authk) auth)
      (cat auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 88)
  (parent 70)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation nonce-test
    (contracted (appid-0 appid) (challenge-0 challenge) (cr-0 cr)
      (sr-0 sr) (x-1 x) (y-0 (mul (rec x) x-0 y)) (x-2 x-0) (y-1 y))
    appid (1 3)
    (enc appid appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))))
  (label 89)
  (parent 71)
  (unrealized (0 2) (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) appid (1 3)
    (enc appid appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 90)
  (parent 71)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3))
    ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 91)
  (parent 72)
  (unrealized (0 2) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 92)
  (parent 73)
  (unrealized (0 2) (1 3) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (2 1)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
        (enc (hash server-1 spk-1) (privk ca-1))))
    (hash (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1))))))
  (label 93)
  (parent 74)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (precur (5 0))
  (operation nonce-test
    (contracted (x-1 x-0) (y-1 (mul (rec x-0) w)) (y-2 y-0)
      (w-0 (mul w y-0)) (y-3 y-0) (w (mul w y-0))) (gen) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0)))))
  (label 94)
  (parent 75)
  (unrealized (2 1) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (y expt) (x rndx) (w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x)
    (y (mul (rec x) w x-0 y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 6 1 client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 95)
  (parent 75)
  (unrealized (0 2) (1 3) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 6 2 client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 96)
  (parent 75)
  (unrealized (0 2) (1 3) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w x-1 y-0)))
  (deflistener (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (0 0)))
  (absent (y-0 (exp (gen) (mul w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))))
  (label 97)
  (parent 75)
  (unrealized (0 2) (1 3) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w))))
  (label 98)
  (parent 75)
  (unrealized (2 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 server-2 ca-2 name)
    (authk spk spk-0 spk-1 spk-2 akey) (x rndx) (y x-0 expt) (x-1 rndx)
    (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1)
    (y (mul (rec x-1) w y-0 y-1)))
  (deflistener (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-2)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (0 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-2 spk-2
              (enc (hash server-2 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                  (enc (hash server-2 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))))
  (label 99)
  (parent 75)
  (unrealized (0 2) (1 3) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (rec x)) y))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x)) y))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (rec x)) y))
      (send (cat (exp (gen) (rec x)) y))))
  (label 100)
  (parent 78)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 101)
  (parent 78)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (precur (4 0))
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 102)
  (parent 79)
  (unrealized (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 103)
  (parent 80)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 104)
  (parent 81)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 5 0 server-auth 2)
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0 spk-0
      (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 105)
  (parent 82)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
        server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 106)
  (parent 82)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username server ca auth server-0 ca-0 appid server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 107)
  (parent 83)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 1))
    ((4 1) (3 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
  (label 108)
  (parent 84)
  (unrealized (0 2) (1 1) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 1)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr auth)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) x-0 y)))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
            (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
  (label 109)
  (parent 85)
  (unrealized (0 2) (1 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid auth server-0 ca-0 name) (authk spk spk-0 akey)
    (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation nonce-test
    (contracted (appid-0 appid) (challenge-0 challenge) (cr-0 cr)
      (sr-0 sr) (x-1 x) (y-0 (mul (rec x) x-0 y)) (x-2 x-0) (y-1 y))
    appid (1 3)
    (enc appid appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived")))
    (enc (hash "key handle" (invk authk) appid)
      (cat appid authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc appid authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))))
  (label 110)
  (parent 86)
  (unrealized (0 2) (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) appid (1 3)
    (enc appid appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc (hash "key handle" (invk authk) appid)
      (cat appid authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc appid authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 111)
  (parent 86)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) appid (1 3)
    (enc appid appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc (hash "key handle" (invk authk) appid)
      (cat appid authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc appid authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 112)
  (parent 86)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 113)
  (parent 87)
  (unrealized (0 2) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 114)
  (parent 88)
  (unrealized (0 2) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 1)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) x-0 y)))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
            (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
  (label 115)
  (parent 89)
  (unrealized (0 2) (1 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3))
    ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 116)
  (parent 90)
  (unrealized (0 2) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 117)
  (parent 91)
  (unrealized (0 2) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 118)
  (parent 92)
  (unrealized (0 2) (1 3) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 119)
  (parent 92)
  (unrealized (0 2) (1 3) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) (rec x-0)) y-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (2 1)) ((6 1) (5 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x-0)) y-0))
    (exp (gen) (mul (rec x-0) y-0)) (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) (rec x-0)) y-0))
      (send (cat (exp (gen) (rec x-0)) y-0))))
  (label 120)
  (parent 93)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (2 1)) ((6 1) (5 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul (rec x-0) y-0)) (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 121)
  (parent 93)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (precur (5 0))
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0))))
    ((recv y-0) (send y-0)))
  (label 122)
  (parent 94)
  (unrealized (2 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (y expt) (x rndx) (w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x)
    (y (mul (rec x) w x-0 y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 123)
  (parent 95)
  (unrealized (0 2) (1 3) (2 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 124)
  (parent 96)
  (unrealized (0 2) (1 3) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w x-1 y-0)))
  (deflistener (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (deflistener y-0)
  (precedes ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 0) (0 0)) ((7 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))) ((recv y-0) (send y-0)))
  (label 125)
  (parent 97)
  (unrealized (0 2) (1 3) (2 1) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 6 0 server-auth 2)
    (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server-1
      spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 126)
  (parent 98)
  (unrealized (0 2) (1 3) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (precedes ((0 1) (5 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
        (enc (hash server-1 spk-1) (privk ca-1))))
    (hash (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1))))))
  (label 127)
  (parent 98)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 server-2 ca-2 name)
    (authk spk spk-0 spk-1 spk-2 akey) (x rndx) (y x-0 expt) (x-1 rndx)
    (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1)
    (y (mul (rec x-1) w y-0 y-1)))
  (deflistener (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-2)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (deflistener y-1)
  (precedes ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (0 0)) ((7 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-1) (mul w y-1) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-2 spk-2
              (enc (hash server-2 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                  (enc (hash server-2 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))) ((recv y-1) (send y-1)))
  (label 128)
  (parent 99)
  (unrealized (0 2) (1 3) (2 1) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0 spk-0
      (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0
          spk-0 (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 129)
  (parent 106)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx) (w-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
    (exp (gen) (mul (rec x) w y)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))))
  (label 130)
  (parent 106)
  (unrealized (6 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 131)
  (parent 108)
  (unrealized (0 2) (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 132)
  (parent 108)
  (unrealized (0 2) (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 1)) ((4 1) (3 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr auth)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
  (label 133)
  (parent 109)
  (unrealized (0 2) (1 1) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid auth server-0 ca-0 name) (authk spk spk-0 akey)
    (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 1)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) x-0 y)))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
            (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
  (label 134)
  (parent 110)
  (unrealized (0 2) (1 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 135)
  (parent 111)
  (unrealized (0 2) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 136)
  (parent 112)
  (unrealized (0 2) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 137)
  (parent 113)
  (unrealized (0 2) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 138)
  (parent 114)
  (unrealized (0 2) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 1))
    ((4 1) (3 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
  (label 139)
  (parent 115)
  (unrealized (0 2) (1 1) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 140)
  (parent 116)
  (unrealized (0 2) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 141)
  (parent 117)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 142)
  (parent 117)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server-1
      spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (precedes ((0 1) (5 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-1)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0)))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server-1
         spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server-1
          spk-1 (enc (hash server-1 spk-1) (privk ca-1))))))
  (label 143)
  (parent 127)
  (unrealized (0 2) (1 3) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx) (w-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test
    (added-listener
      (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
    (exp (gen) (mul (rec x-0) w y-0)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))))
  (label 144)
  (parent 127)
  (unrealized (7 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test
    (contracted (x-0 x) (w-0 (mul x w)) (y-0 y) (w-1 (mul w y)) (y-1 y)
      (w (mul w y))) (gen) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 145)
  (parent 130)
  (unrealized (0 2) (3 0) (4 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 7 1 client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 146)
  (parent 130)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 147)
  (parent 130)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 148)
  (parent 130)
  (unrealized (0 2) (3 0) (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username server ca auth server-0 ca-0 appid server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 149)
  (parent 130)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr auth)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 150)
  (parent 133)
  (unrealized (0 2) (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr auth)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 151)
  (parent 133)
  (unrealized (0 2) (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid auth server-0 ca-0 name) (authk spk spk-0 akey)
    (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 1)) ((4 1) (3 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
  (label 152)
  (parent 134)
  (unrealized (0 2) (1 1) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 153)
  (parent 135)
  (unrealized (0 2) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 154)
  (parent 136)
  (unrealized (0 2) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 155)
  (parent 137)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 156)
  (parent 137)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 157)
  (parent 138)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username auth) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username auth) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr auth)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc auth appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc auth appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) auth)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 158)
  (parent 138)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 159)
  (parent 139)
  (unrealized (0 2) (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 160)
  (parent 139)
  (unrealized (0 2) (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 161)
  (parent 140)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca auth appid auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (1 3))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 162)
  (parent 140)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (gen) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test
    (contracted (x-1 x-0) (w-0 (mul x-0 w)) (y-1 y-0) (w-1 (mul w y-0))
      (y-2 y-0) (w (mul w y-0))) (gen) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0)))))
  (label 163)
  (parent 144)
  (unrealized (0 2) (1 3) (4 0) (5 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (y expt) (x rndx) (w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4))
    ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1))
    ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 8 1 client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x w x-0)))
      (send (cat (exp (gen) y-0) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 164)
  (parent 144)
  (unrealized (0 0) (0 2) (1 3) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w x-0 x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul w x-0 x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 8 2 client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0 x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w x-0 x-0)))
      (send (cat (exp (gen) y-0) (mul w x-0 x-0))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 165)
  (parent 144)
  (unrealized (0 0) (0 2) (1 3) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w x-1)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 0) (0 0)))
  (absent (y-0 (exp (gen) (mul x-0 w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-1 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-1 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w x-1)))
      (send (cat (exp (gen) y-0) (mul x-0 w x-1))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))))
  (label 166)
  (parent 144)
  (unrealized (0 0) (0 2) (1 3) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) w))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (displaced 8 0 server-auth 2) (exp (gen) y-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w))))
  (label 167)
  (parent 144)
  (unrealized (0 2) (1 3) (4 0) (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 server-2 ca-2 name)
    (authk spk spk-0 spk-1 spk-2 akey) (x rndx) (y x-0 expt) (x-1 rndx)
    (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) (mul x-1 w y-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-2)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (0 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul x-1 w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y-0)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-1 w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
            (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul w y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) (mul x-1 w y-0)))
      (send (cat (exp (gen) y-1) (mul x-1 w y-0))))
    ((recv
       (cat (cat cr (exp (gen) x-1))
         (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-2 spk-2
              (enc (hash server-2 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                  (enc (hash server-2 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))))
  (label 168)
  (parent 144)
  (unrealized (0 0) (0 2) (1 3) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 169)
  (parent 145)
  (unrealized (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 170)
  (parent 146)
  (unrealized (0 0) (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 171)
  (parent 147)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation nonce-test (contracted (x-0 x) (w (rec x))) (one) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))))
  (label 172)
  (parent 148)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-absence x w) w (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))))
  (label 173)
  (parent 148)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (4 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener x) (mul x w) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv x) (send x)))
  (label 174)
  (parent 148)
  (unrealized (0 2) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (username server ca auth server-0 ca-0 appid server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 175)
  (parent 149)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid auth server-0 ca-0 name) (authk spk spk-0 akey)
    (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y))
    (exp (gen) (mul x-0 y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y)) (send (cat (exp (gen) x-0) y))))
  (label 176)
  (parent 152)
  (unrealized (0 2) (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid auth server-0 ca-0 name) (authk spk spk-0 akey)
    (x x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) x-0 y)))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y))
  (deflistener (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) y) x-0))
    (exp (gen) (mul x-0 y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x-0)) (send (cat (exp (gen) y) x-0))))
  (label 177)
  (parent 152)
  (unrealized (0 2) (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 178)
  (parent 153)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 179)
  (parent 153)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 180)
  (parent 154)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid auth server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username appid) (auth auth) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username appid) (auth appid) (server server) (ca ca) (appid appid)
    (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (1 3)) ((3 1) (1 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr appid)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc appid appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) appid)
          (cat appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc appid authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 181)
  (parent 154)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (gen) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0))))
    ((recv y-0) (send y-0)))
  (label 182)
  (parent 163)
  (unrealized (0 2) (1 3) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (y expt) (x rndx) (w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4))
    ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1))
    ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x w x-0)))
      (send (cat (exp (gen) y-0) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 183)
  (parent 164)
  (unrealized (0 0) (0 2) (1 3) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w x-0 x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul w x-0 x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0 x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w x-0 x-0)))
      (send (cat (exp (gen) y-0) (mul w x-0 x-0))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 184)
  (parent 165)
  (unrealized (0 0) (0 2) (1 3) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w x-1)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (9 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 0) (0 0)) ((9 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x-0 w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-1 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-1 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w x-1)))
      (send (cat (exp (gen) y-0) (mul x-0 w x-1))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))) ((recv y-0) (send y-0)))
  (label 185)
  (parent 166)
  (unrealized (0 0) (0 2) (1 3) (4 0) (5 0) (9 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul y-0 (rec x-0))))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (rec x-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (contracted (x-1 x-0) (w (rec x-0))) (one)
    (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 (rec x-0))))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 (rec x-0))))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (one)))
      (send (cat (exp (gen) y-0) (one))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (rec x-0)))
      (send (cat (exp (gen) y-0) (rec x-0)))))
  (label 186)
  (parent 167)
  (unrealized (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul w y-0 (rec x-0))))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w (rec x-0))))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (x-0 w) (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-absence x-0 w) w (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 (rec x-0))))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w y-0 (rec x-0))))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w (rec x-0))))
      (send (cat (exp (gen) y-0) (mul w (rec x-0))))))
  (label 187)
  (parent 167)
  (unrealized (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4))
    ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1))
    ((7 1) (6 0)) ((8 1) (5 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener x-0) (mul x-0 w) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv x-0) (send x-0)))
  (label 188)
  (parent 167)
  (unrealized (0 2) (1 3) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 server-2 ca-2 name)
    (authk spk spk-0 spk-1 spk-2 akey) (x rndx) (y x-0 expt) (x-1 rndx)
    (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) (mul x-1 w y-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-2)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (deflistener y-1)
  (precedes ((0 1) (5 0)) ((0 1) (9 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (0 0)) ((9 1) (7 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul x-1 w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener y-1) (mul w y-1) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-1 w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
            (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul w y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) (mul x-1 w y-0)))
      (send (cat (exp (gen) y-1) (mul x-1 w y-0))))
    ((recv
       (cat (cat cr (exp (gen) x-1))
         (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-2 spk-2
              (enc (hash server-2 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                  (enc (hash server-2 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))) ((recv y-1) (send y-1)))
  (label 189)
  (parent 168)
  (unrealized (0 0) (0 2) (1 3) (4 0) (5 0) (9 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener x) (rec x) (6 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))) ((recv x) (send x)))
  (label 190)
  (parent 172)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (username server ca auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener x) (mul w (rec x)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))) ((recv x) (send x)))
  (label 191)
  (parent 173)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul y-0 (rec x-0))))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (rec x-0)))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4))
    ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1))
    ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener x-0) (rec x-0) (7 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 (rec x-0))))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 (rec x-0))))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (one)))
      (send (cat (exp (gen) y-0) (one))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (rec x-0)))
      (send (cat (exp (gen) y-0) (rec x-0)))) ((recv x-0) (send x-0)))
  (label 192)
  (parent 186)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (username server ca auth appid auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul w y-0 (rec x-0))))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w (rec x-0))))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4))
    ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1))
    ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (x-0 w) (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener x-0) (mul w (rec x-0)) (7 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 (rec x-0))))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w y-0 (rec x-0))))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w (rec x-0))))
      (send (cat (exp (gen) y-0) (mul w (rec x-0)))))
    ((recv x-0) (send x-0)))
  (label 193)
  (parent 187)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y)
  (uniq-orig challenge sr)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 194)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y y-0)))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-auth 5)
    (enc
      (hash appid
        (hash (hash (exp (gen) (mul x y y-0)) "derived")
          "uaf-exporter-binding" cr sr challenge) challenge)
      (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))))
  (label 195)
  (parent 194)
  (unrealized (0 2) (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0
          spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0
            spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 196)
  (parent 195)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 197)
  (parent 195)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 198)
  (parent 196)
  (unrealized)
  (shape)
  (maps
    ((0)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (spk spk) (appid appid) (cr cr) (x x) (y y))))
  (origs (challenge (0 3)) (sr (0 1))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 199)
  (parent 196)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 200)
  (parent 197)
  (unrealized (0 2) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 201)
  (parent 199)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 4 0 server-auth 2) (exp (gen) y-0)
    (3 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr))))
  (label 202)
  (parent 200)
  (unrealized (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (y expt) (y-0 rndx) (w expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0 (rec w))) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x y y-0 (rec w))) w))
    (exp (gen) (mul x y y-0)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0 (rec w))) w))
      (send (cat (exp (gen) (mul x y y-0 (rec w))) w))))
  (label 203)
  (parent 200)
  (unrealized (0 2) (4 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 204)
  (parent 201)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 205)
  (parent 201)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (3 0)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
        server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 206)
  (parent 202)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (contracted (x-0 x) (y-0 (mul (rec x) w)) (y-1 y) (w-0 (mul w y))
      (y-2 y) (w (mul w y))) (gen) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 207)
  (parent 203)
  (unrealized (1 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 1 client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 208)
  (parent 203)
  (unrealized (0 2) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 209)
  (parent 203)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 210)
  (parent 203)
  (unrealized (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid server-0 ca-0 server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 211)
  (parent 203)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (rec x)) y))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x)) y))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (rec x)) y))
      (send (cat (exp (gen) (rec x)) y))))
  (label 212)
  (parent 206)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 213)
  (parent 206)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 214)
  (parent 207)
  (unrealized (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 215)
  (parent 208)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 216)
  (parent 209)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 5 0 server-auth 2)
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0 spk-0
      (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 217)
  (parent 210)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
        server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 218)
  (parent 210)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid server-0 ca-0 server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 219)
  (parent 211)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0 spk-0
      (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0
          spk-0 (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 220)
  (parent 218)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx) (w-0 expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
    (exp (gen) (mul (rec x) w y)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))))
  (label 221)
  (parent 218)
  (unrealized (6 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-0 x) (w-0 (mul x w)) (y-0 y) (w-1 (mul w y)) (y-1 y)
      (w (mul w y))) (gen) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 222)
  (parent 221)
  (unrealized (0 2) (3 0) (4 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 1 client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 223)
  (parent 221)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 224)
  (parent 221)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 225)
  (parent 221)
  (unrealized (0 2) (3 0) (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid server-0 ca-0 server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x-0 w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 226)
  (parent 221)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 227)
  (parent 222)
  (unrealized (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 228)
  (parent 223)
  (unrealized (0 0) (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 229)
  (parent 224)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-0 x) (w (rec x))) (one) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))))
  (label 230)
  (parent 225)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x w) w (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))))
  (label 231)
  (parent 225)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (4 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul x w) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv x) (send x)))
  (label 232)
  (parent 225)
  (unrealized (0 2) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid server-0 ca-0 server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x-0 w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 233)
  (parent 226)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (rec x) (6 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))) ((recv x) (send x)))
  (label 234)
  (parent 230)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul w (rec x)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))) ((recv x) (send x)))
  (label 235)
  (parent 231)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (username server ca auth appid auth-0 appid-0 name) (authk spk akey)
    (x expt) (y x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr-0) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid-0) (authk authk) (spk spk) (x x-0) (y y-0))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0)
  (uniq-orig challenge sr username)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))
              (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr))
            (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))
              (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr)))
      (recv
        (enc username appid-0 challenge
          (hash "s ap traffic" cr-0 sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr challenge)))
          (enc auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr challenge)) (invk authk))
          (hash "c ap traffic" cr-0 sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 236)
  (unrealized (0 4) (1 1) (1 3))
  (preskeleton)
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1)))
  (comment "Not a skeleton"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (username server ca auth appid auth-0 appid-0 name) (authk spk akey)
    (x expt) (y x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr-0) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid-0) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0)
  (uniq-orig challenge sr username)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))
              (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr))
            (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))
              (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr)))
      (recv
        (enc username appid-0 challenge
          (hash "s ap traffic" cr-0 sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr challenge)))
          (enc auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr challenge)) (invk authk))
          (hash "c ap traffic" cr-0 sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 237)
  (parent 236)
  (unrealized (0 4) (1 1))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 appid-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid-0) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 238)
  (parent 237)
  (unrealized (0 2) (0 4) (1 3))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1)))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 2 0 server-reg 4)
    (enc username appid-0 challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (1 3))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 239)
  (parent 238)
  (unrealized (0 2) (0 4))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1)))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 appid-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid-0) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc username appid-0 challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (1 3))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 240)
  (parent 238)
  (unrealized (0 2) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 241)
  (parent 239)
  (unrealized (0 4))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1)))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 242)
  (parent 239)
  (unrealized (0 2) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 appid-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid-0) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 243)
  (parent 240)
  (unrealized (0 2) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca appid auth name) (authk spk akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation encryption-test (displaced 2 1 client-reg 5)
    (enc (hash "key handle" (invk authk) username)
      (cat auth-0 authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul y x-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc auth-0 authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul y x-0)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x-0)) "derived"))) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 244)
  (parent 241)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((username username) (server server) (ca ca) (sr sr)
        (challenge challenge) (authk authk) (spk spk) (auth auth)
        (appid appid) (cr cr) (x x) (y y) (auth-0 auth) (appid-0 appid)
        (cr-0 cr) (x-0 x) (y-0 y))))
  (origs (username (0 3)) (challenge (0 3)) (sr (0 1))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (y x x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul y x (rec x-0))))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr username)
  (operation encryption-test (added-strand client-reg 5)
    (enc (hash "key handle" (invk authk) username)
      (cat auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 245)
  (parent 241)
  (unrealized (2 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc (hash "key handle" (invk authk) username)
      (cat auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived")
            "uaf-exporter-binding" cr sr challenge)))
      (enc auth authk
        (hash appid challenge
          (hash (hash (exp (gen) (mul y x)) "derived")
            "uaf-exporter-binding" cr sr challenge)) (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 246)
  (parent 241)
  (unrealized (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 247)
  (parent 242)
  (unrealized (0 4) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 appid-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid-0) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 248)
  (parent 243)
  (unrealized (0 2) (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (y x x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)) ((3 1) (2 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul y x (rec x-0))))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
            (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)) (2 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
  (label 249)
  (parent 245)
  (unrealized (2 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 250)
  (parent 246)
  (unrealized (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 251)
  (parent 247)
  (unrealized (0 4) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 252)
  (parent 247)
  (unrealized (0 4) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 appid-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid-0) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 253)
  (parent 248)
  (unrealized (0 2) (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 appid-0 name) (authk spk akey)
    (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid-0) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid-0 challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 254)
  (parent 248)
  (unrealized (0 2) (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (y x x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))))
  (label 255)
  (parent 249)
  (unrealized (2 1) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 256)
  (parent 250)
  (unrealized (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (y x x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 257)
  (parent 255)
  (unrealized (2 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 server-0 ca-0 name)
    (authk spk spk-0 akey) (y x x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 258)
  (parent 255)
  (unrealized (2 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 259)
  (parent 256)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (username server ca auth appid auth-0 name) (authk spk akey)
    (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth-0) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr username)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth-0 authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 260)
  (parent 256)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid appid-0 name) (authk spk akey) (x expt)
    (y x-0 rndx) (y-0 expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr-0) (sr sr)
    (server server) (ca ca) (appid appid-0) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0)
  (uniq-orig challenge sr)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))
              (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr))
            (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))
              (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr)))
      (recv
        (enc appid-0 challenge
          (hash "s ap traffic" cr-0 sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid-0
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr-0 sr challenge) challenge)
          (enc
            (hash appid-0
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr-0 sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 261)
  (unrealized (0 4) (1 1) (1 3))
  (preskeleton)
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "Not a skeleton"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid appid-0 name) (authk spk akey) (x expt)
    (y x-0 rndx) (y-0 expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr-0) (sr sr)
    (server server) (ca ca) (appid appid-0) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0)
  (uniq-orig challenge sr)
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))
              (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr))
            (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr))
              (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr)))
      (recv
        (enc appid-0 challenge
          (hash "s ap traffic" cr-0 sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid-0
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr-0 sr challenge) challenge)
          (enc
            (hash appid-0
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr-0 sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 262)
  (parent 261)
  (unrealized (0 4) (1 1))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid appid-0 name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid-0) (authk authk) (spk spk)
    (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid-0
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 263)
  (parent 262)
  (unrealized (0 2) (0 4) (1 3))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 4)
    (enc appid-0 challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (1 3))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 264)
  (parent 263)
  (unrealized (0 2) (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid appid-0 name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid-0) (authk authk) (spk spk)
    (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc appid-0 challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (1 3))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid-0
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 265)
  (parent 263)
  (unrealized (0 2) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 266)
  (parent 264)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 267)
  (parent 264)
  (unrealized (0 2) (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid appid-0 name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid-0) (authk authk) (spk spk)
    (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid-0
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 268)
  (parent 265)
  (unrealized (0 2) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 5)
    (enc
      (hash appid
        (hash (hash (exp (gen) (mul y x-0)) "derived")
          "uaf-exporter-binding" cr sr challenge) challenge)
      (enc
        (hash appid
          (hash (hash (exp (gen) (mul y x-0)) "derived")
            "uaf-exporter-binding" cr sr challenge) challenge)
        (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x-0)) "derived"))) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 269)
  (parent 266)
  (unrealized)
  (shape)
  (maps
    ((0 1)
      ((server server) (ca ca) (sr sr) (challenge challenge)
        (authk authk) (spk spk) (appid appid) (cr cr) (x x) (y y)
        (appid-0 appid) (cr-0 cr) (x-0 x) (y-0 y))))
  (origs (challenge (0 3)) (sr (0 1))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x x-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul y x (rec x-0))))
  (precedes ((0 1) (1 1)) ((0 1) (2 1)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-auth 5)
    (enc
      (hash appid
        (hash (hash (exp (gen) (mul y x)) "derived")
          "uaf-exporter-binding" cr sr challenge) challenge)
      (enc
        (hash appid
          (hash (hash (exp (gen) (mul y x)) "derived")
            "uaf-exporter-binding" cr sr challenge) challenge)
        (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 270)
  (parent 266)
  (unrealized (2 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived")))
    (enc
      (hash appid
        (hash (hash (exp (gen) (mul y x)) "derived")
          "uaf-exporter-binding" cr sr challenge) challenge)
      (enc
        (hash appid
          (hash (hash (exp (gen) (mul y x)) "derived")
            "uaf-exporter-binding" cr sr challenge) challenge)
        (invk authk))
      (hash "c ap traffic" cr sr
        (hash (exp (gen) (mul y x)) "derived"))) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 271)
  (parent 266)
  (unrealized (0 4) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 272)
  (parent 267)
  (unrealized (0 4) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid appid-0 name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid-0) (authk authk) (spk spk)
    (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid-0
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 273)
  (parent 268)
  (unrealized (0 2) (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x x-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)) ((3 1) (2 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul y x (rec x-0))))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
            (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0)))
      (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)) (2 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
  (label 274)
  (parent 270)
  (unrealized (2 1) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived"))
    (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived")))))
  (label 275)
  (parent 271)
  (unrealized (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 276)
  (parent 272)
  (unrealized (0 4) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 277)
  (parent 272)
  (unrealized (0 4) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid appid-0 name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid-0) (authk authk) (spk spk)
    (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid-0
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 278)
  (parent 273)
  (unrealized (0 2) (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid appid-0 name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid-0) (authk authk) (spk spk)
    (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((2 1) (1 3)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid-0 challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid-0
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 279)
  (parent 273)
  (unrealized (0 2) (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x x-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul y x)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))))
  (label 280)
  (parent 274)
  (unrealized (2 1) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul y x)) "derived"))
    (hash (exp (gen) (mul y x)) "derived") (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived"))))
  (label 281)
  (parent 275)
  (unrealized (0 4) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x x-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 282)
  (parent 280)
  (unrealized (2 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x x-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul y x (rec x-0))))
  (deflistener (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((0 3) (2 3))
    ((1 0) (0 0)) ((1 2) (0 2)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y x (rec x-0))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y x (rec x-0))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y x (rec x-0)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y x (rec x-0))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y x (rec x-0)))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul y x)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul y x)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 283)
  (parent 280)
  (unrealized (2 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 284)
  (parent 281)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener
    (hash "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener
    (cat "c ap traffic" cr sr (hash (exp (gen) (mul y x)) "derived")))
  (deflistener (cat (exp (gen) (mul y x)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 2) (0 2)) ((2 1) (0 4)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul y x)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv
       (hash "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (hash "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv
       (cat "c ap traffic" cr sr
         (hash (exp (gen) (mul y x)) "derived")))
      (send
        (cat "c ap traffic" cr sr
          (hash (exp (gen) (mul y x)) "derived"))))
    ((recv (cat (exp (gen) (mul y x)) "derived"))
      (send (cat (exp (gen) (mul y x)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 285)
  (parent 281)
  (unrealized (0 4) (5 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x rndx)
    (y expt))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x)
  (uniq-orig cr)
  (goals
    (forall
      ((cr sr data) (challenge text) (authk spk akey)
        (server ca appid name) (x rndx) (z strd))
      (implies
        (and (p "client-reg" z 5) (p "client-reg" "cr" z cr)
          (p "client-reg" "sr" z sr)
          (p "client-reg" "challenge" z challenge)
          (p "client-reg" "authk" z authk) (p "client-reg" "spk" z spk)
          (p "client-reg" "appid" z appid)
          (p "client-reg" "server" z server) (p "client-reg" "ca" z ca)
          (p "client-reg" "x" z x) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen x) (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p "server-reg" z-0 4)
            (p "server-reg" "challenge" z-0 challenge)
            (p "server-reg" "appid" z-0 appid)
            (p "server-reg" "server" z-0 server))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 286)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x rndx)
    (y x-0 expt) (y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 287)
  (parent 286)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 288)
  (parent 287)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 289)
  (parent 287)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (appid username auth server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 1 2 server-reg 4)
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 290)
  (parent 288)
  (unrealized (1 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 291)
  (parent 288)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (appid username auth server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 3 server-reg 4)
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 292)
  (parent 289)
  (unrealized (2 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc username appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 293)
  (parent 289)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (appid username auth server ca name) (authk spk akey) (y x rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 294)
  (parent 290)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (x x) (username username)
        (auth auth) (y y))))
  (origs (cr (0 0))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (appid username auth server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 295)
  (parent 290)
  (unrealized (1 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 296)
  (parent 291)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (appid username auth server ca name) (authk spk akey) (x expt)
    (y y-0 x-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y y-0 x-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 297)
  (parent 292)
  (seen 294)
  (unrealized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (appid username auth server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 298)
  (parent 292)
  (unrealized (2 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 299)
  (parent 293)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (appid username auth server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 300)
  (parent 295)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 301)
  (parent 296)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (appid username auth server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 302)
  (parent 298)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 303)
  (parent 299)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (appid username auth server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 304)
  (parent 300)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (appid username auth server ca name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 305)
  (parent 300)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 306)
  (parent 301)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca appid username auth name) (authk spk akey) (x y rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 307)
  (parent 301)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (appid username auth server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 308)
  (parent 302)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (appid username auth server ca name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-reg 4 (challenge challenge) (cr cr) (sr sr)
    (username username) (server server) (ca ca) (appid appid) (spk spk)
    (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 309)
  (parent 302)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 310)
  (parent 303)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca appid username auth name) (authk spk akey) (x expt)
    (y x-0 y-0 rndx))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 311)
  (parent 303)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x rndx) (y expt))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x)
  (uniq-orig cr)
  (goals
    (forall
      ((cr sr data) (challenge text) (authk spk akey)
        (server ca appid name) (x rndx) (z strd))
      (implies
        (and (p "client-auth" z 5) (p "client-auth" "cr" z cr)
          (p "client-auth" "sr" z sr)
          (p "client-auth" "challenge" z challenge)
          (p "client-auth" "authk" z authk)
          (p "client-auth" "spk" z spk)
          (p "client-auth" "appid" z appid)
          (p "client-auth" "server" z server)
          (p "client-auth" "ca" z ca) (p "client-auth" "x" z x)
          (non (invk authk)) (non (invk spk)) (non (privk ca)) (ugen x)
          (uniq-at cr z 0))
        (exists ((z-0 strd))
          (and (p "server-auth" z-0 4)
            (p "server-auth" "challenge" z-0 challenge)
            (p "server-auth" "appid" z-0 appid)
            (p "server-auth" "server" z-0 server))))))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 312)
  (unrealized (0 1))
  (origs (cr (0 0)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x rndx) (y x-0 expt) (y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((1 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc (hash server spk) (privk ca)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x-0)))
      (send
        (cat (cat sr-0 (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
              sr-0))))))
  (label 313)
  (parent 312)
  (unrealized (0 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 1 server-auth 2)
    (enc
      (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0)) server
        spk (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))))
  (label 314)
  (parent 313)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (added-strand server-auth 2)
    (enc
      (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server spk
        (enc (hash server spk) (privk ca))) (invk spk)) (0 1))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))))
  (label 315)
  (parent 313)
  (unrealized (0 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test (displaced 1 2 server-auth 4)
    (enc appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 316)
  (parent 314)
  (unrealized (1 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((2 1) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived")))
    (enc appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x y)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 317)
  (parent 314)
  (unrealized (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 3 server-auth 4)
    (enc appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 318)
  (parent 315)
  (unrealized (2 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((3 1) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (0 3))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 319)
  (parent 315)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (y x rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (precedes ((0 0) (1 0)) ((0 2) (1 2)) ((1 1) (0 1)) ((1 3) (0 3)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig cr)
  (operation encryption-test (displaced 2 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 320)
  (parent 316)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((cr cr) (sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (x x) (y y))))
  (origs (cr (0 0))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (2 0)) ((1 3) (0 3))
    ((2 1) (1 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (1 2))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 321)
  (parent 316)
  (unrealized (1 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((2 1) (0 3))
    ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived"))
    (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived")))))
  (label 322)
  (parent 317)
  (unrealized (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y y-0 x-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (precedes ((0 0) (2 0)) ((0 2) (2 2)) ((1 1) (0 1)) ((2 1) (0 1))
    ((2 3) (0 3)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y y-0 x-0)
  (uniq-orig cr)
  (operation encryption-test (displaced 3 0 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 323)
  (parent 318)
  (seen 320)
  (unrealized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (3 0))
    ((2 3) (0 3)) ((3 1) (2 2)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (2 2))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 324)
  (parent 318)
  (unrealized (2 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((3 1) (0 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 325)
  (parent 319)
  (unrealized (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (3 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 326)
  (parent 321)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "derived"))
    (hash (exp (gen) (mul x y)) "derived") (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived"))))
  (label 327)
  (parent 322)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (4 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 328)
  (parent 324)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 329)
  (parent 325)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 330)
  (parent 326)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (appid server ca name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (4 0)) ((1 3) (0 3))
    ((2 1) (1 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 331)
  (parent 326)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 332)
  (parent 327)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (deflistener
    (hash "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr (hash (exp (gen) (mul x y)) "derived")))
  (deflistener (cat (exp (gen) (mul x y)) "derived"))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 0) (1 0)) ((1 1) (0 1)) ((1 1) (5 0)) ((2 1) (0 3))
    ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x y)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x y)) "derived"))))
    ((recv (cat (exp (gen) (mul x y)) "derived"))
      (send (cat (exp (gen) (mul x y)) "derived")))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 333)
  (parent 327)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 334)
  (parent 328)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (appid server ca name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 4 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (5 0))
    ((2 3) (0 3)) ((3 1) (2 2)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 335)
  (parent 328)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 336)
  (parent 329)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data) (server ca appid name)
    (authk spk akey) (x expt) (y x-0 y-0 rndx))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x x-0) (y y-0))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server) (ca ca)
    (spk spk) (x x) (y y))
  (defstrand server-auth 2 (cr cr) (sr sr) (server server) (ca ca)
    (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 0) (2 0)) ((1 1) (0 1)) ((2 1) (0 1)) ((2 1) (6 0))
    ((3 1) (0 3)) ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0 y-0)
  (uniq-orig cr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 337)
  (parent 329)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid username auth name) (authk spk akey) (y rndx)
    (x expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y)
  (uniq-orig challenge sr)
  (goals
    (forall
      ((sr data) (challenge text) (authk spk akey)
        (server ca appid name) (y rndx) (z strd))
      (implies
        (and (p "server-reg" z 5) (p "server-reg" "sr" z sr)
          (p "server-reg" "challenge" z challenge)
          (p "server-reg" "authk" z authk) (p "server-reg" "spk" z spk)
          (p "server-reg" "server" z server)
          (p "server-reg" "appid" z appid) (p "server-reg" "ca" z ca)
          (p "server-reg" "y" z y) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen y) (uniq-at challenge z 3)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p "client-reg" z-0 5)
            (p "client-reg" "challenge" z-0 challenge)
            (p "client-reg" "server" z-0 server)
            (p "client-reg" "appid" z-0 appid))))))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 338)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (y rndx) (x expt) (x-0 rndx) (y-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y-0))
  (precedes ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x-0)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-reg 5)
    (hash "key handle" (invk authk) username) (0 4))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y-0))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y-0))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0))
                (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-0
                  sr-0)) (cat cr-0 (exp (gen) x-0))
              (cat sr-0 (exp (gen) y-0))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y-0)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 339)
  (parent 338)
  (unrealized (0 4))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-reg 5)
    (enc auth-0 authk
      (hash appid-0 challenge-0
        (hash (hash (exp (gen) (mul x-0 y-1)) "derived")
          "uaf-exporter-binding" cr-0 sr-0 challenge-0)) (invk authk))
    (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))))
  (label 340)
  (parent 339)
  (unrealized (0 2) (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-reg 5)
    (enc auth authk
      (hash appid challenge
        (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
          "uaf-exporter-binding" cr sr challenge)) (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))))
  (label 341)
  (parent 339)
  (unrealized (0 2) (0 4) (2 1) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0
          spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0
            spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 342)
  (parent 340)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 343)
  (parent 340)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 3 0 server-auth 2)
    (enc (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
      (enc
        (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server-1
          spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1))
        (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1))
            server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
          (invk spk-1)))
      (hash (exp (gen) (mul x-0 y-1)) "s hs traffic" cr sr)) (2 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 344)
  (parent 341)
  (unrealized (0 2) (0 4) (2 3))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
    (enc (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
      (enc
        (hash (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
        (cat server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
        (enc
          (hash (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
            (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1)))
      (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)) (2 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
  (label 345)
  (parent 341)
  (unrealized (0 2) (0 4) (2 3) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 346)
  (parent 342)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (username username)
        (auth auth) (cr cr) (x x))))
  (origs (challenge (0 3)) (sr (0 1))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 347)
  (parent 342)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 348)
  (parent 343)
  (unrealized (0 2) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 3 0 server-reg 4)
    (enc username-0 appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-1)) "derived"))) (2 3))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))))
  (label 349)
  (parent 344)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (enc username-0 appid challenge
      (hash "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived"))) (2 3))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 350)
  (parent 344)
  (unrealized (0 2) (0 4) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (y-0 expt) (y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (precedes ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
  (label 351)
  (parent 345)
  (unrealized (0 2) (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 352)
  (parent 347)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 4 0 server-auth 2) (exp (gen) y-0)
    (3 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr))))
  (label 353)
  (parent 348)
  (unrealized (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 rndx) (w expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0 (rec w))) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x y y-0 (rec w))) w))
    (exp (gen) (mul x y y-0)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0 (rec w))) w))
      (send (cat (exp (gen) (mul x y y-0 (rec w))) w))))
  (label 354)
  (parent 348)
  (unrealized (0 2) (4 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (precedes ((0 1) (2 1)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 2) (0 2)) ((2 4) (0 4)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 3 2 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y-0 x-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y-0 x-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul y-0 x-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y-0 x-0)) "derived"))))))
  (label 355)
  (parent 349)
  (seen 346)
  (unrealized)
  (comment "1 in cohort - 0 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (3 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server
            spk (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              server spk (enc (hash server spk) (privk ca)))
            (invk spk))))
      (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 356)
  (parent 349)
  (unrealized (0 2) (3 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat "s ap traffic" cr sr
        (hash (exp (gen) (mul x-0 y-0)) "derived")))
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived")))))
  (label 357)
  (parent 350)
  (unrealized (0 2) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (precedes ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-1)
    (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr))))
  (label 358)
  (parent 351)
  (unrealized (2 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (y-0 expt) (y-1 rndx) (w expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-1 (exp (gen) (mul x-0 y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-1)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
    (exp (gen) (mul x-0 y-0 y-1)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))
      (send (cat (exp (gen) (mul x-0 y-0 y-1 (rec w))) w))))
  (label 359)
  (parent 351)
  (unrealized (0 2) (5 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 360)
  (parent 352)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 361)
  (parent 352)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (3 0)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
        server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 362)
  (parent 353)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (contracted (x-0 x) (y-0 (mul (rec x) w)) (y-1 y) (w-0 (mul w y))
      (y-2 y) (w (mul w y))) (gen) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 363)
  (parent 354)
  (unrealized (1 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 1 client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 364)
  (parent 354)
  (unrealized (0 2) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 365)
  (parent 354)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 366)
  (parent 354)
  (unrealized (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth server-0 ca-0 appid server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 367)
  (parent 354)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (precedes ((0 1) (2 1)) ((0 1) (4 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))))
  (label 368)
  (parent 356)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x-0 y-0)) "derived"))
    (hash (exp (gen) (mul x-0 y-0)) "derived") (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived"))))
  (label 369)
  (parent 357)
  (unrealized (0 2) (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
        (enc (hash server-1 spk-1) (privk ca-1))))
    (hash (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1))))))
  (label 370)
  (parent 358)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test
    (contracted (x-1 x-0) (y-1 (mul (rec x-0) w)) (y-2 y-0)
      (w-0 (mul w y-0)) (y-3 y-0) (w (mul w y-0))) (gen) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0)))))
  (label 371)
  (parent 359)
  (unrealized (2 1) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (y expt) (x rndx) (w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x)
    (y (mul (rec x) w x-0 y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 1 client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 372)
  (parent 359)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 2 client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 373)
  (parent 359)
  (unrealized (0 2) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w x-1 y-0)))
  (deflistener (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 0) (0 0)))
  (absent (y-0 (exp (gen) (mul w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))))
  (label 374)
  (parent 359)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-1)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w))))
  (label 375)
  (parent 359)
  (unrealized (2 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 server-2 ca-2 name)
    (authk spk spk-0 spk-1 spk-2 akey) (x rndx) (y x-0 expt) (x-1 rndx)
    (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1)
    (y (mul (rec x-1) w y-0 y-1)))
  (deflistener (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-2)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (0 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-2 spk-2
              (enc (hash server-2 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                  (enc (hash server-2 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))))
  (label 376)
  (parent 359)
  (unrealized (0 2) (2 1) (4 0) (5 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (rec x)) y))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x)) y))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (rec x)) y))
      (send (cat (exp (gen) (rec x)) y))))
  (label 377)
  (parent 362)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 378)
  (parent 362)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 379)
  (parent 363)
  (unrealized (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 380)
  (parent 364)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x)
    (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 381)
  (parent 365)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth appid name) (authk spk akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 5 0 server-auth 2)
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0 spk-0
      (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 382)
  (parent 366)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
        server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 383)
  (parent 366)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth server-0 ca-0 appid server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0)
    (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 384)
  (parent 367)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 385)
  (parent 368)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0 name)
    (authk spk spk-0 akey) (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (0 2)) ((4 1) (3 0))
    ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (4 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 386)
  (parent 368)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) x-0) y-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x-0) y-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) x-0) y-0)) (send (cat (exp (gen) x-0) y-0))))
  (label 387)
  (parent 369)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener
    (hash "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener
    (cat "s ap traffic" cr sr
      (hash (exp (gen) (mul x-0 y-0)) "derived")))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "derived"))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (2 1)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 3)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul x-0 y-0)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv
       (hash "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (hash "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv
       (cat "s ap traffic" cr sr
         (hash (exp (gen) (mul x-0 y-0)) "derived")))
      (send
        (cat "s ap traffic" cr sr
          (hash (exp (gen) (mul x-0 y-0)) "derived"))))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "derived"))
      (send (cat (exp (gen) (mul x-0 y-0)) "derived")))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 388)
  (parent 369)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) (rec x-0)) y-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)) ((6 1) (5 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x-0)) y-0))
    (exp (gen) (mul (rec x-0) y-0)) (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) (rec x-0)) y-0))
      (send (cat (exp (gen) (rec x-0)) y-0))))
  (label 389)
  (parent 370)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) y-0)))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (2 1)) ((6 1) (5 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y-0) x-0))
    (exp (gen) (mul (rec x-0) y-0)) (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 390)
  (parent 370)
  (unrealized (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (precur (5 0))
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0))))
    ((recv y-0) (send y-0)))
  (label 391)
  (parent 371)
  (unrealized (2 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (y expt) (x rndx) (w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x)
    (y (mul (rec x) w x-0 y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 392)
  (parent 372)
  (unrealized (0 2) (2 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 393)
  (parent 373)
  (unrealized (0 2) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w x-1 y-0)))
  (deflistener (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (deflistener y-0)
  (precedes ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 0) (0 0)) ((7 1) (5 0)))
  (absent (y-0 (exp (gen) (mul w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-1))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w x-1 y-0)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))) ((recv y-0) (send y-0)))
  (label 394)
  (parent 374)
  (unrealized (0 2) (2 1) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 name) (authk spk spk-0 akey) (x rndx) (y expt)
    (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (precedes ((0 1) (5 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 6 0 server-auth 2)
    (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-1)) server-1
      spk-1 (enc (hash server-1 spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0))))
  (label 395)
  (parent 375)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (precedes ((0 1) (5 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x-0))
        (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
        (enc (hash server-1 spk-1) (privk ca-1))))
    (hash (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))) (2 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1))))))
  (label 396)
  (parent 375)
  (unrealized (6 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 server-2 ca-2 name)
    (authk spk spk-0 spk-1 spk-2 akey) (x rndx) (y x-0 expt) (x-1 rndx)
    (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1)
    (y (mul (rec x-1) w y-0 y-1)))
  (deflistener (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-2)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (deflistener y-1)
  (precedes ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4)) ((2 0) (0 0))
    ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0)) ((5 1) (4 0))
    ((6 1) (0 0)) ((7 1) (5 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-1) (mul w y-1) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y-0))) (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul (rec x-1) w y-0 y-1)))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-2 spk-2
              (enc (hash server-2 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                  (enc (hash server-2 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))) ((recv y-1) (send y-1)))
  (label 397)
  (parent 376)
  (unrealized (0 2) (2 1) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0 spk-0
      (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0
          spk-0 (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 398)
  (parent 383)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx) (w-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
    (exp (gen) (mul (rec x) w y)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))))
  (label 399)
  (parent 383)
  (unrealized (6 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x x-0) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y y-0))
  (deflistener (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) x-0))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server-1
      spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (precedes ((0 1) (5 0)) ((0 1) (6 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)))
  (absent (y-0 (exp (gen) x-0)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-1)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) x-0)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) y-0))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) x-0)) (send (cat (exp (gen) y-0) x-0)))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server-1
         spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) y-0)) server-1
          spk-1 (enc (hash server-1 spk-1) (privk ca-1))))))
  (label 400)
  (parent 396)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx) (w-0 expt))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul (rec x-0) w y-0)))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener
      (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
    (exp (gen) (mul (rec x-0) w y-0)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul (rec x-0) w y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x-0) w y-0 (rec w-0))) w-0))))
  (label 401)
  (parent 396)
  (unrealized (7 0))
  (comment "6 in cohort - 6 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-0 x) (w-0 (mul x w)) (y-0 y) (w-1 (mul w y)) (y-1 y)
      (w (mul w y))) (gen) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 402)
  (parent 399)
  (unrealized (0 2) (3 0) (4 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 1 client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 403)
  (parent 399)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 404)
  (parent 399)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 405)
  (parent 399)
  (unrealized (0 2) (3 0) (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth server-0 ca-0 appid server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 406)
  (parent 399)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (gen) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-1 x-0) (w-0 (mul x-0 w)) (y-1 y-0) (w-1 (mul w y-0))
      (y-2 y-0) (w (mul w y-0))) (gen) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0)))))
  (label 407)
  (parent 401)
  (unrealized (0 2) (4 0) (5 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (y expt) (x rndx) (w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 1 client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x w x-0)))
      (send (cat (exp (gen) y-0) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 408)
  (parent 401)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w x-0 x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul w x-0 x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 2 client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0 x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w x-0 x-0)))
      (send (cat (exp (gen) y-0) (mul w x-0 x-0))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))))
  (label 409)
  (parent 401)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w x-1)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 0) (0 0)))
  (absent (y-0 (exp (gen) (mul x-0 w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-1 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-1 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w x-1)))
      (send (cat (exp (gen) y-0) (mul x-0 w x-1))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))))
  (label 410)
  (parent 401)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) w))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 8 0 server-auth 2) (exp (gen) y-1)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w))))
  (label 411)
  (parent 401)
  (unrealized (0 2) (4 0) (5 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 server-2 ca-2 name)
    (authk spk spk-0 spk-1 spk-2 akey) (x rndx) (y x-0 expt) (x-1 rndx)
    (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) (mul x-1 w y-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-2)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (0 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul x-1 w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y-0)
    (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-1 w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
            (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul w y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) (mul x-1 w y-0)))
      (send (cat (exp (gen) y-1) (mul x-1 w y-0))))
    ((recv
       (cat (cat cr (exp (gen) x-1))
         (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-2 spk-2
              (enc (hash server-2 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                  (enc (hash server-2 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))))
  (label 412)
  (parent 401)
  (unrealized (0 0) (0 2) (4 0) (5 0) (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 413)
  (parent 402)
  (unrealized (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (x y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x x)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 414)
  (parent 403)
  (unrealized (0 0) (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (x-0 y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 415)
  (parent 404)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-0 x) (w (rec x))) (one) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))))
  (label 416)
  (parent 405)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x w) w (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))))
  (label 417)
  (parent 405)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (x rndx) (w expt) (y rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (4 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul x w) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv x) (send x)))
  (label 418)
  (parent 405)
  (unrealized (0 2) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr cr-0 sr-0 data)
    (server ca username auth server-0 ca-0 appid server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w y)) (y y-0))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 419)
  (parent 406)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (gen) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (gen) (mul w y-0))) (send (cat (gen) (mul w y-0))))
    ((recv y-0) (send y-0)))
  (label 420)
  (parent 407)
  (unrealized (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (y expt) (x rndx) (w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x w x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x-0) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x w x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x-0)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x-0)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x-0)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x-0))
                  (cat sr-0 (exp (gen) y)) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul y x-0)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul y x-0)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul y x-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x w x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x w x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x w x-0)))
      (send (cat (exp (gen) y-0) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 421)
  (parent 408)
  (unrealized (0 0) (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (x-0 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul w x-0 x-0)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-0 y-0)))
  (deflistener
    (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul w x-0 x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-0 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-0) (mul w y-0)))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (8 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (7 0)))
  (absent (y-0 (exp (gen) (mul w x-0 x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0 x-0))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul w x-0 x-0)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0 x-0)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-0 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-0 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w x-0 x-0 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 x-0 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 x-0 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul w x-0 x-0)))
      (send (cat (exp (gen) y-0) (mul w x-0 x-0))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-0 y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-0) (mul w y-0)))
      (send (cat (exp (gen) x-0) (mul w y-0)))) ((recv y-0) (send y-0)))
  (label 422)
  (parent 409)
  (unrealized (0 0) (0 2) (4 0) (5 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (x-1 y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w x-1)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w x-1 y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w x-1)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w x-1 y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) x-1) (mul w y-0)))
  (defstrand client-auth 1 (cr cr-1) (x x-1))
  (deflistener y-0)
  (precedes ((0 1) (5 0)) ((0 1) (9 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 0) (0 0))
    ((9 1) (7 0)))
  (absent (y-0 (exp (gen) (mul x-0 w x-1))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 x-1 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w x-1))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
            (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w x-1)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w x-1)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-1 y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w x-1 y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w x-1 y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w x-1 y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w x-1 y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w x-1 y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w x-1)))
      (send (cat (exp (gen) y-0) (mul x-0 w x-1))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w x-1 y-0))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) x-1) (mul w y-0)))
      (send (cat (exp (gen) x-1) (mul w y-0))))
    ((send (cat cr-1 (exp (gen) x-1)))) ((recv y-0) (send y-0)))
  (label 423)
  (parent 410)
  (unrealized (0 0) (0 2) (4 0) (5 0) (9 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul y-0 (rec x-0))))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (rec x-0)))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-1 x-0) (w (rec x-0))) (one)
    (5 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 (rec x-0))))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 (rec x-0))))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (one)))
      (send (cat (exp (gen) y-0) (one))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (rec x-0)))
      (send (cat (exp (gen) y-0) (rec x-0)))))
  (label 424)
  (parent 411)
  (unrealized (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul w y-0 (rec x-0))))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w (rec x-0))))
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)))
  (absent (x-0 w) (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x-0 w) w (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 (rec x-0))))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w y-0 (rec x-0))))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w (rec x-0))))
      (send (cat (exp (gen) y-0) (mul w (rec x-0))))))
  (label 425)
  (parent 411)
  (unrealized (6 0) (7 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (x-0 rndx) (w expt) (y-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-0 w)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0) (y (mul w y-0)))
  (deflistener (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (5 0)))
  (absent (y-0 (exp (gen) (mul x-0 w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-0 y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (mul x-0 w) (5 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x-0 w))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-0 w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-0 w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w)))
      (send (cat (exp (gen) y-0) (mul x-0 w))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
         server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y-0)))
          server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv x-0) (send x-0)))
  (label 426)
  (parent 411)
  (unrealized (0 2) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 cr-1 sr-1 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 server-2 ca-2 name)
    (authk spk spk-0 spk-1 spk-2 akey) (x rndx) (y x-0 expt) (x-1 rndx)
    (w expt) (y-0 y-1 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (mul x-1 w y-0)) (y y-1))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-1) (y (mul w y-0 y-1)))
  (deflistener
    (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener
    (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-1) (mul x-1 w y-0)))
  (deflistener
    (cat (cat cr (exp (gen) x-1)) (cat sr (exp (gen) (mul w y-0 y-1)))
      server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w y-1)))
  (defstrand server-auth 2 (cr cr-1) (sr sr-1) (server server-2)
    (ca ca-2) (spk spk-2) (x x-0) (y y-0))
  (deflistener y-1)
  (precedes ((0 1) (5 0)) ((0 1) (9 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 4) (0 4)) ((3 1) (2 1)) ((4 1) (3 0))
    ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0)) ((8 1) (0 0))
    ((9 1) (7 0)))
  (absent (y-0 (exp (gen) x-0)) (y-1 (exp (gen) (mul x-1 w y-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x x-1 y-0 y-1)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-1) (mul w y-1) (7 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-1 w y-0))))
      (send
        (cat (cat sr (exp (gen) y-1))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
            (cat sr (exp (gen) y-1))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                (cat sr (exp (gen) y-1)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-1 w y-0)))
              (cat sr (exp (gen) y-1))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-1 w y-0)))
                  (cat sr (exp (gen) y-1)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-1)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 y-1)))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
              sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr
                sr)) (cat cr (exp (gen) x-1))
            (cat sr (exp (gen) (mul w y-0 y-1)))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-1))
                (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-1))
              (cat sr (exp (gen) (mul w y-0 y-1)))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-1))
                  (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul x-1 w y-0 y-1)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-1 w y-0 y-1)) "derived")))))
    ((recv (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send
        (hash (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-1 w y-0 y-1)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-1) (mul x-1 w y-0)))
      (send (cat (exp (gen) y-1) (mul x-1 w y-0))))
    ((recv
       (cat (cat cr (exp (gen) x-1))
         (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-1))
          (cat sr (exp (gen) (mul w y-0 y-1))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w y-1)))
      (send (cat (exp (gen) y-0) (mul w y-1))))
    ((recv (cat cr-1 (exp (gen) x-0)))
      (send
        (cat (cat sr-1 (exp (gen) y-0))
          (enc
            (cat server-2 spk-2
              (enc (hash server-2 spk-2) (privk ca-2)))
            (enc
              (hash (cat cr-1 (exp (gen) x-0))
                (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2))) (invk spk-2))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
                  sr-1)) (cat cr-1 (exp (gen) x-0))
              (cat sr-1 (exp (gen) y-0))
              (cat server-2 spk-2
                (enc (hash server-2 spk-2) (privk ca-2)))
              (enc
                (hash (cat cr-1 (exp (gen) x-0))
                  (cat sr-1 (exp (gen) y-0)) server-2 spk-2
                  (enc (hash server-2 spk-2) (privk ca-2)))
                (invk spk-2)))
            (hash (exp (gen) (mul x-0 y-0)) "s hs traffic" cr-1
              sr-1))))) ((recv y-1) (send y-1)))
  (label 427)
  (parent 412)
  (unrealized (0 0) (0 2) (4 0) (5 0) (9 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (rec x) (6 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))) ((recv x) (send x)))
  (label 428)
  (parent 416)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (cr sr data)
    (server ca username auth server-0 ca-0 appid name)
    (authk spk spk-0 akey) (w expt) (y x rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server-0) (ca ca-0)
    (appid appid) (authk authk) (spk spk-0) (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul w (rec x)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))) ((recv x) (send x)))
  (label 429)
  (parent 417)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x (one)) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul y-0 (rec x-0))))
  (deflistener (hash (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (rec x-0)))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (y-0 (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (rec x-0) (7 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul y-0 (rec x-0))))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) y-0) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) y-0) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul y-0 (rec x-0))))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1))) (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) y-0) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) y-0) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y-0) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) y-0) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) y-0) "derived")))))
    ((recv (hash (exp (gen) y-0) "s hs traffic" cr sr))
      (send (hash (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) "s hs traffic" cr sr))
      (send (cat (exp (gen) y-0) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (one)))
      (send (cat (exp (gen) y-0) (one))))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul y-0 (rec x-0)))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (rec x-0)))
      (send (cat (exp (gen) y-0) (rec x-0)))) ((recv x-0) (send x-0)))
  (label 430)
  (parent 424)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge challenge-0 text) (sr cr cr-0 sr-0 data)
    (server ca appid username auth auth-0 server-0 ca-0 appid-0
      username-0 server-1 ca-1 name) (authk spk spk-0 spk-1 akey)
    (x rndx) (y w expt) (y-0 x-0 rndx))
  (defstrand server-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username) (auth auth) (server server) (ca ca)
    (appid appid) (authk authk) (spk spk) (x w) (y y-0))
  (defstrand client-reg 5 (challenge challenge-0) (cr cr-0) (sr sr-0)
    (username username) (auth auth-0) (server server-0) (ca ca-0)
    (appid appid-0) (authk authk) (spk spk-0) (x x) (y y))
  (defstrand client-reg 5 (challenge challenge) (cr cr) (sr sr)
    (username username-0) (auth auth) (server server-1) (ca ca-1)
    (appid appid) (authk authk) (spk spk-1) (x x-0)
    (y (mul w y-0 (rec x-0))))
  (deflistener (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) w))
  (deflistener
    (cat (cat cr (exp (gen) x-0))
      (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
      (enc (hash server-1 spk-1) (privk ca-1))))
  (deflistener (cat (exp (gen) y-0) (mul w (rec x-0))))
  (deflistener x-0)
  (precedes ((0 1) (5 0)) ((0 1) (7 0)) ((0 3) (2 3)) ((1 4) (0 4))
    ((2 0) (0 0)) ((2 0) (8 0)) ((2 4) (0 4)) ((3 1) (2 1))
    ((4 1) (3 0)) ((5 1) (4 0)) ((6 1) (2 1)) ((7 1) (6 0))
    ((8 1) (7 0)))
  (absent (x-0 w) (y-0 (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (7 0) (5 0))
  (uniq-gen x y-0 x-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x-0) (mul w (rec x-0)) (7 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                server spk (enc (hash server spk) (privk ca)))
              (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y-0))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((send (cat cr-0 (exp (gen) x)))
      (recv
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0))
            (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr-0 sr-0)))
      (recv
        (enc username appid-0 challenge-0
          (hash "s ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0)))
          (enc auth-0 authk
            (hash appid-0 challenge-0
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr-0 sr-0 challenge-0))
            (invk authk))
          (hash "c ap traffic" cr-0 sr-0
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y-0 (rec x-0))))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul w y-0 (rec x-0))))
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y-0 (rec x-0))))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1
                  spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1))))
          (hash (exp (gen) (mul w y-0)) "c hs traffic" cr sr)))
      (recv
        (enc username-0 appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username-0)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul w y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) w)) (send (cat (exp (gen) y-0) w)))
    ((recv
       (cat (cat cr (exp (gen) x-0))
         (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
         (enc (hash server-1 spk-1) (privk ca-1))))
      (send
        (cat (cat cr (exp (gen) x-0))
          (cat sr (exp (gen) (mul w y-0 (rec x-0)))) server-1 spk-1
          (enc (hash server-1 spk-1) (privk ca-1)))))
    ((recv (cat (exp (gen) y-0) (mul w (rec x-0))))
      (send (cat (exp (gen) y-0) (mul w (rec x-0)))))
    ((recv x-0) (send x-0)))
  (label 431)
  (parent 425)
  (unrealized (8 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")

(defprotocol uaf-exporter-tls13 diffie-hellman
  (defrole client-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole client-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x rndx) (y expt))
    (trace (send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen x))
  (defrole server-reg
    (vars (username auth server ca appid name) (challenge text)
      (cr sr data) (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc username appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc (hash "key handle" (invk authk) username)
          (cat auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)))
          (enc auth authk
            (hash appid challenge
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge)) (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x))))
  (defrole server-auth
    (vars (server ca appid name) (challenge text) (cr sr data)
      (authk spk akey) (x expt) (y rndx))
    (trace (recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    (uniq-gen y)
    (absent (y (exp (gen) x)))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y rndx) (x expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y)
  (uniq-orig challenge sr)
  (goals
    (forall
      ((sr data) (challenge text) (authk spk akey)
        (server ca appid name) (y rndx) (z strd))
      (implies
        (and (p "server-auth" z 5) (p "server-auth" "sr" z sr)
          (p "server-auth" "challenge" z challenge)
          (p "server-auth" "authk" z authk)
          (p "server-auth" "spk" z spk)
          (p "server-auth" "server" z server)
          (p "server-auth" "appid" z appid) (p "server-auth" "ca" z ca)
          (p "server-auth" "y" z y) (non (invk authk)) (non (invk spk))
          (non (privk ca)) (ugen y) (uniq-at challenge z 3)
          (uniq-at sr z 1))
        (exists ((z-0 strd))
          (and (p "client-auth" z-0 5)
            (p "client-auth" "challenge" z-0 challenge)
            (p "client-auth" "server" z-0 server)
            (p "client-auth" "appid" z-0 appid))))))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 432)
  (unrealized (0 4))
  (origs (challenge (0 3)) (sr (0 1)))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y y-0)))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test (added-strand client-auth 5)
    (enc
      (hash appid
        (hash (hash (exp (gen) (mul x y y-0)) "derived")
          "uaf-exporter-binding" cr sr challenge) challenge)
      (invk authk)) (0 4))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))))
  (label 433)
  (parent 432)
  (unrealized (0 2) (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 0 server-auth 2)
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0
          spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0
            spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))))
  (label 434)
  (parent 433)
  (unrealized (0 2))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (enc (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
      (enc
        (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (invk spk-0))
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
        (cat server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
          (invk spk-0)))
      (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)) (1 1))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 435)
  (parent 433)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (precedes ((0 1) (1 1)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 2) (0 2))
    ((1 4) (0 4)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 2 1 client-auth 3)
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul y x)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul y x)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul y x)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul y x)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul y x)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul y x)) "derived"))))))
  (label 436)
  (parent 434)
  (unrealized)
  (shape)
  (satisfies yes)
  (maps
    ((0)
      ((sr sr) (challenge challenge) (authk authk) (spk spk)
        (server server) (ca ca) (appid appid) (y y) (cr cr) (x x))))
  (origs (challenge (0 3)) (sr (0 1))))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (2 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (enc
      (hash
        (hash "finished"
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
        (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
        (cat server spk (enc (hash server spk) (privk ca)))
        (enc
          (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server spk
            (enc (hash server spk) (privk ca))) (invk spk))
        (hash
          (hash "finished"
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
          (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
          (cat server spk (enc (hash server spk) (privk ca)))
          (enc
            (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
              spk (enc (hash server spk) (privk ca))) (invk spk))))
      (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)) (0 2))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 437)
  (parent 434)
  (unrealized (0 2) (2 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (y expt) (y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
    (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
  (label 438)
  (parent 435)
  (unrealized (0 2) (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (precedes ((0 1) (1 1)) ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
    (hash (exp (gen) (mul x y)) "c hs traffic" cr sr) (2 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))))
  (label 439)
  (parent 437)
  (unrealized (3 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (precedes ((0 1) (3 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 4 0 server-auth 2) (exp (gen) y-0)
    (3 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr))))
  (label 440)
  (parent 438)
  (unrealized (1 1))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (y expt) (y-0 rndx) (w expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y y-0)))
  (deflistener (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y y-0 (rec w))) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y-0 (exp (gen) (mul x y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y-0)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul x y y-0 (rec w))) w))
    (exp (gen) (mul x y y-0)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y y-0 (rec w))) w))
      (send (cat (exp (gen) (mul x y y-0 (rec w))) w))))
  (label 441)
  (parent 438)
  (unrealized (0 2) (4 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) y))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) x) y))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) y)) (send (cat (exp (gen) x) y))))
  (label 442)
  (parent 439)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (1 1)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (0 2)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul x y)) (3 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "c hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "c hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 443)
  (parent 439)
  (unrealized (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (3 0)) ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
        server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 444)
  (parent 440)
  (unrealized (4 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test
    (contracted (x-0 x) (y-0 (mul (rec x) w)) (y-1 y) (w-0 (mul w y))
      (y-2 y) (w (mul w y))) (gen) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 445)
  (parent 441)
  (unrealized (1 1) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 1 client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 446)
  (parent 441)
  (unrealized (0 2) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 447)
  (parent 441)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 5 0 server-auth 2) (exp (gen) y-0)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 448)
  (parent 441)
  (unrealized (1 1))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid server-0 ca-0 server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 449)
  (parent 441)
  (unrealized (0 2) (1 1) (3 0) (4 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (rec x)) y))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) (rec x)) y))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (rec x)) y))
      (send (cat (exp (gen) (rec x)) y))))
  (label 450)
  (parent 444)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) y)))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (3 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (1 1))
    ((5 1) (4 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener (cat (exp (gen) y) x))
    (exp (gen) (mul (rec x) y)) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 451)
  (parent 444)
  (unrealized (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (precur (4 0))
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 452)
  (parent 445)
  (unrealized (1 1) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (4 0)))
  (absent (y (exp (gen) (mul w x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 453)
  (parent 446)
  (unrealized (0 2) (5 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w x-0 y)))
  (deflistener (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 0) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) (mul w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w x-0 y))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 454)
  (parent 447)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data) (server ca appid name)
    (authk spk akey) (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (precedes ((0 1) (4 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test (displaced 5 0 server-auth 2)
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y-0)) server-0 spk-0
      (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x))))
  (label 455)
  (parent 448)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation encryption-test
    (added-listener
      (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
        server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
    (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))) (1 1))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 456)
  (parent 448)
  (unrealized (5 0))
  (comment "2 in cohort - 2 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid server-0 ca-0 server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul (rec x-0) w y y-0)))
  (deflistener (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0)) ((1 4) (0 4))
    ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0)) ((5 1) (0 0))
    ((6 1) (4 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w y))) (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0))
            (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul (rec x-0) w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul (rec x-0) w y y-0))) server-0
                  spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 457)
  (parent 449)
  (unrealized (0 2) (1 1) (6 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x x)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y y))
  (deflistener (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) x))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0 spk-0
      (enc (hash server-0 spk-0) (privk ca-0))))
  (precedes ((0 1) (4 0)) ((0 1) (5 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)))
  (absent (y (exp (gen) x)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 6 0 server-auth 2) (exp (gen) y-0)
    (5 0))
  (traces
    ((recv (cat cr (exp (gen) x)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) y))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))
              (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x)) (cat sr (exp (gen) y))
                  server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x y)) "derived")))))
    ((recv (hash (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) x)) (send (cat (exp (gen) y) x)))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) y)) server-0
          spk-0 (enc (hash server-0 spk-0) (privk ca-0))))))
  (label 458)
  (parent 456)
  (unrealized (0 2) (4 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx) (w-0 expt))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul (rec x) w y)))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul (rec x) w y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (added-listener (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
    (exp (gen) (mul (rec x) w y)) (5 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul (rec x) w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul (rec x) w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul (rec x) w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul (rec x) w y))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))
      (send (cat (exp (gen) (mul (rec x) w y (rec w-0))) w-0))))
  (label 459)
  (parent 456)
  (unrealized (6 0))
  (comment "5 in cohort - 5 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test
    (contracted (x-0 x) (w-0 (mul x w)) (y-0 y) (w-1 (mul w y)) (y-1 y)
      (w (mul w y))) (gen) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y)))))
  (label 460)
  (parent 459)
  (unrealized (0 2) (3 0) (4 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 1 client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))))
  (label 461)
  (parent 459)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand client-auth 1) (exp (gen) x-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))))
  (label 462)
  (parent 459)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (displaced 7 0 server-auth 2) (exp (gen) y-0)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w))))
  (label 463)
  (parent 459)
  (unrealized (0 2) (3 0) (4 0))
  (comment "3 in cohort - 3 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid server-0 ca-0 server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x-0 w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-strand server-auth 2) (exp (gen) y)
    (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))))))
  (label 464)
  (parent 459)
  (unrealized (0 0) (0 2) (3 0) (4 0) (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (gen) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (gen) (mul w y))) (send (cat (gen) (mul w y))))
    ((recv y) (send y)))
  (label 465)
  (parent 460)
  (unrealized (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (x y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul w x x)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w x y)))
  (deflistener (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul w x x)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x) (mul w y)))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (7 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (exp (gen) (mul w x x))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul w x x))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul w x x)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul w x x))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul w x x)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w x x y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w x x y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w x x y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w x x y)) "derived")))))
    ((recv (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w x x y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul w x x)))
      (send (cat (exp (gen) y) (mul w x x))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x) (mul w y)))
      (send (cat (exp (gen) x) (mul w y)))) ((recv y) (send y)))
  (label 466)
  (parent 461)
  (unrealized (0 0) (0 2) (3 0) (4 0) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (x-0 y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w x-0)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w x-0 y)))
  (deflistener (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w x-0)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) x-0) (mul w y)))
  (defstrand client-auth 1 (cr cr-0) (x x-0))
  (deflistener y)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 0) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) (mul x w x-0))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x x-0 y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y) (mul w y) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w x-0))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w x-0)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w x-0))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w x-0)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w x-0 y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w x-0 y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w x-0 y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w x-0 y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w x-0 y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w x-0 y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w x-0)))
      (send (cat (exp (gen) y) (mul x w x-0))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w x-0 y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) x-0) (mul w y)))
      (send (cat (exp (gen) x-0) (mul w y))))
    ((send (cat cr-0 (exp (gen) x-0)))) ((recv y) (send y)))
  (label 467)
  (parent 462)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (contracted (x-0 x) (w (rec x))) (one) (4 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))))
  (label 468)
  (parent 463)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-absence x w) w (4 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))))
  (label 469)
  (parent 463)
  (unrealized (5 0) (6 0))
  (comment "1 in cohort - 1 not yet seen"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (x rndx)
    (w expt) (y rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x w)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y)))
  (deflistener (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (mul x w)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y))) server-0
      spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) w))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (4 0)))
  (absent (y (exp (gen) (mul x w))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x y)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul x w) (4 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x w))))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x w)))
                (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) (mul x w))) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x w)))
                  (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x w y)) "derived")))))
    ((recv (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (mul x w)))
      (send (cat (exp (gen) y) (mul x w))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv x) (send x)))
  (label 470)
  (parent 463)
  (unrealized (0 2) (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr cr-0 sr-0 data)
    (server ca appid server-0 ca-0 server-1 ca-1 name)
    (authk spk spk-0 spk-1 akey) (x expt) (x-0 rndx) (w expt)
    (y y-0 rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (mul x-0 w y)) (y y-0))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x-0) (y (mul w y y-0)))
  (deflistener
    (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y-0) (mul x-0 w y)))
  (deflistener
    (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w y-0)))
  (defstrand server-auth 2 (cr cr-0) (sr sr-0) (server server-1)
    (ca ca-1) (spk spk-1) (x x) (y y))
  (deflistener y-0)
  (precedes ((0 1) (4 0)) ((0 1) (8 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0)) ((4 1) (3 0))
    ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (0 0)) ((8 1) (6 0)))
  (absent (y (exp (gen) x)) (y-0 (exp (gen) (mul x-0 w y))))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen x-0 y y-0)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener y-0) (mul w y-0) (6 0))
  (traces
    ((recv (cat cr (exp (gen) (mul x-0 w y))))
      (send
        (cat (cat sr (exp (gen) y-0))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) (mul x-0 w y))) (cat sr (exp (gen) y-0))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) (mul x-0 w y)))
                (cat sr (exp (gen) y-0)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) (mul x-0 w y)))
              (cat sr (exp (gen) y-0))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) (mul x-0 w y)))
                  (cat sr (exp (gen) y-0)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((send (cat cr (exp (gen) x-0)))
      (recv
        (cat (cat sr (exp (gen) (mul w y y-0)))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x-0))
                (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr
                  sr)) (cat cr (exp (gen) x-0))
              (cat sr (exp (gen) (mul w y y-0)))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x-0))
                  (cat sr (exp (gen) (mul w y y-0))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul x-0 w y y-0)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul x-0 w y y-0)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul x-0 w y y-0)) "derived")))))
    ((recv (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul x-0 w y y-0)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y-0) (mul x-0 w y)))
      (send (cat (exp (gen) y-0) (mul x-0 w y))))
    ((recv
       (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x-0)) (cat sr (exp (gen) (mul w y y-0)))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w y-0)))
      (send (cat (exp (gen) y) (mul w y-0))))
    ((recv (cat cr-0 (exp (gen) x)))
      (send
        (cat (cat sr-0 (exp (gen) y))
          (enc
            (cat server-1 spk-1
              (enc (hash server-1 spk-1) (privk ca-1)))
            (enc
              (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                server-1 spk-1 (enc (hash server-1 spk-1) (privk ca-1)))
              (invk spk-1))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0))
              (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
              (cat server-1 spk-1
                (enc (hash server-1 spk-1) (privk ca-1)))
              (enc
                (hash (cat cr-0 (exp (gen) x)) (cat sr-0 (exp (gen) y))
                  server-1 spk-1
                  (enc (hash server-1 spk-1) (privk ca-1)))
                (invk spk-1)))
            (hash (exp (gen) (mul x y)) "s hs traffic" cr-0 sr-0)))))
    ((recv y-0) (send y-0)))
  (label 471)
  (parent 464)
  (unrealized (0 0) (0 2) (3 0) (4 0) (8 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey)
    (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk)
    (x (one)) (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul y (rec x))))
  (deflistener (hash (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) (one)))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (rec x)))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (y (gen)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (rec x) (6 0))
  (traces
    ((recv (cat cr (gen)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (gen)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (gen)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (gen)) (cat sr (exp (gen) y)) server spk
                  (enc (hash server spk) (privk ca))) (invk spk))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) y) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished" (hash (exp (gen) y) "c hs traffic" cr sr))
            (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) y) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) y) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr (hash (exp (gen) y) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) y) "derived") "uaf-exporter-binding"
              cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) y) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr (hash (exp (gen) y) "derived")))))
    ((recv (hash (exp (gen) y) "s hs traffic" cr sr))
      (send (hash (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) "s hs traffic" cr sr))
      (send (cat (exp (gen) y) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) (one))) (send (cat (exp (gen) y) (one))))
    ((recv
       (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
         server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul y (rec x))))
          server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (rec x)))
      (send (cat (exp (gen) y) (rec x)))) ((recv x) (send x)))
  (label 472)
  (parent 468)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(defskeleton uaf-exporter-tls13
  (vars (challenge text) (sr cr data)
    (server ca appid server-0 ca-0 name) (authk spk spk-0 akey) (w expt)
    (y x rndx))
  (defstrand server-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server) (ca ca) (appid appid) (authk authk) (spk spk) (x w)
    (y y))
  (defstrand client-auth 5 (challenge challenge) (cr cr) (sr sr)
    (server server-0) (ca ca-0) (appid appid) (authk authk) (spk spk-0)
    (x x) (y (mul w y (rec x))))
  (deflistener (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
  (deflistener (cat (exp (gen) y) w))
  (deflistener
    (cat (cat cr (exp (gen) x)) (cat sr (exp (gen) (mul w y (rec x))))
      server-0 spk-0 (enc (hash server-0 spk-0) (privk ca-0))))
  (deflistener (cat (exp (gen) y) (mul w (rec x))))
  (deflistener x)
  (precedes ((0 1) (4 0)) ((0 1) (6 0)) ((0 3) (1 3)) ((1 0) (0 0))
    ((1 0) (7 0)) ((1 4) (0 4)) ((2 1) (1 1)) ((3 1) (2 0))
    ((4 1) (3 0)) ((5 1) (1 1)) ((6 1) (5 0)) ((7 1) (6 0)))
  (absent (x w) (y (exp (gen) w)))
  (non-orig (invk authk) (invk spk) (privk ca))
  (precur (6 0) (4 0))
  (uniq-gen y x)
  (uniq-orig challenge sr)
  (operation nonce-test (added-listener x) (mul w (rec x)) (6 0))
  (traces
    ((recv (cat cr (exp (gen) w)))
      (send
        (cat (cat sr (exp (gen) y))
          (enc (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (recv
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
            (cat server spk (enc (hash server spk) (privk ca)))
            (enc
              (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y)) server
                spk (enc (hash server spk) (privk ca))) (invk spk))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
              (cat server spk (enc (hash server spk) (privk ca)))
              (enc
                (hash (cat cr (exp (gen) w)) (cat sr (exp (gen) y))
                  server spk (enc (hash server spk) (privk ca)))
                (invk spk))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (send
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (recv
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((send (cat cr (exp (gen) x)))
      (recv
        (cat (cat sr (exp (gen) (mul w y (rec x))))
          (enc
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0)))
            (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))))
      (send
        (enc
          (hash
            (hash "finished"
              (hash (exp (gen) (mul w y)) "c hs traffic" cr sr))
            (cat cr (exp (gen) x))
            (cat sr (exp (gen) (mul w y (rec x))))
            (cat server-0 spk-0
              (enc (hash server-0 spk-0) (privk ca-0)))
            (enc
              (hash (cat cr (exp (gen) x))
                (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0))) (invk spk-0))
            (hash
              (hash "finished"
                (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
              (cat cr (exp (gen) x))
              (cat sr (exp (gen) (mul w y (rec x))))
              (cat server-0 spk-0
                (enc (hash server-0 spk-0) (privk ca-0)))
              (enc
                (hash (cat cr (exp (gen) x))
                  (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
                  (enc (hash server-0 spk-0) (privk ca-0)))
                (invk spk-0))))
          (hash (exp (gen) (mul w y)) "c hs traffic" cr sr)))
      (recv
        (enc appid challenge
          (hash "s ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived"))))
      (send
        (enc
          (hash appid
            (hash (hash (exp (gen) (mul w y)) "derived")
              "uaf-exporter-binding" cr sr challenge) challenge)
          (enc
            (hash appid
              (hash (hash (exp (gen) (mul w y)) "derived")
                "uaf-exporter-binding" cr sr challenge) challenge)
            (invk authk))
          (hash "c ap traffic" cr sr
            (hash (exp (gen) (mul w y)) "derived")))))
    ((recv (hash (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (hash (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) (mul w y)) "s hs traffic" cr sr))
      (send (cat (exp (gen) (mul w y)) "s hs traffic" cr sr)))
    ((recv (cat (exp (gen) y) w)) (send (cat (exp (gen) y) w)))
    ((recv
       (cat (cat cr (exp (gen) x))
         (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
         (enc (hash server-0 spk-0) (privk ca-0))))
      (send
        (cat (cat cr (exp (gen) x))
          (cat sr (exp (gen) (mul w y (rec x)))) server-0 spk-0
          (enc (hash server-0 spk-0) (privk ca-0)))))
    ((recv (cat (exp (gen) y) (mul w (rec x))))
      (send (cat (exp (gen) y) (mul w (rec x))))) ((recv x) (send x)))
  (label 473)
  (parent 469)
  (unrealized (7 0))
  (dead)
  (comment "empty cohort"))

(comment "Nothing left to do")
